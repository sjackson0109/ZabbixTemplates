zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
  templates:
    - uuid: 6ed1c8323a3c41448917d13593aa6581
      template: 'Domain Health'
      name: 'Domain Health'
      description: |
        Domain Health & Compliance Monitoring for Zabbix.
        Performs DNS record checks, DNSSEC validation, DANE/TLSA verification,
        email authentication (SPF/DKIM/DMARC), registrar/WHOIS/RDAP data retrieval,
        ASN lookup, NS server monitoring, and RFC compliance checks.
        
        Features:
        - Query and validate A, AAAA, MX, NS, CNAME, SOA, PTR, TXT, SRV, CAA, DNSSEC records
        - Validate SPF, DKIM, DMARC records for email authentication
        - Check DNSSEC presence, trust chain, key types (KSK/ZSK), algorithms, RRSIG expiry
        - DANE/TLSA record discovery and certificate validation (RFC 6698)
        - Retrieve registrar/WHOIS/RDAP data (expiry, status, lock)
        - ASN lookup for hosting provider identification
        - NS server discovery with availability and latency monitoring
        - Detect RFC non-conformity, syntax errors, and common misconfigurations
        - Health score calculation (0-100) based on compliance checks
        
        RFC Compliance:
        - RFC 1034, 1035: Core DNS protocol and record types
        - RFC 1912: Common DNS operational errors
        - RFC 2181: DNS specification clarifications
        - RFC 2606: Reserved Example Domains
        - RFC 4033-4035: DNSSEC
        - RFC 5732-5735: Special-Use and Reserved Domain Names
        - RFC 6698: DANE/TLSA
        - RFC 6761: Special-Use Top Level Domains
        - RFC 7208: SPF
        - RFC 7489: DMARC
        - RFC 6844: CAA
        - RFC 2782: SRV records
        - RFC 3596: IPv6 (AAAA)
        - RFC 7480-7484: RDAP
        - RFC 8624: DNSSEC Algorithm Status
        
        Author: 'Simon Jackson / @sjackson0109'
      vendor:
        name: 'Simon Jackson'
        version: '1.0'
      groups:
        - name: Templates
      items:
        - uuid: 00ea54302e0043f3ac754b32de6322fc
          name: 'DNS A Records Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[a.valid,{$DNS_DOMAIN}]'
          delay: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.a.valid
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
            - type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: a
            - tag: rfc
              value: RFC1035
          triggers:
            - uuid: 45fc6a9324b34f90afad43797c9b4292
              expression: 'last(/Domain Health/get_domain_health.py[a.valid,{$DNS_DOMAIN}])=0'
              name: 'DNS A Records Missing on {$DNS_DOMAIN}'
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: a
                - tag: rfc
                  value: RFC1035
        - uuid: f0ceec12fd9f400b94a47bfb2883b18c
          name: 'DNS AAAA Records Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[aaaa.valid,{$DNS_DOMAIN}]'
          delay: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.aaaa.valid
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
            - type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: aaaa
            - tag: rfc
              value: RFC3596
        - uuid: af6bb2f3b8bc4a5f8f1b7a8e6ceec9ef
          name: 'ASN Full Data'
          type: EXTERNAL
          key: 'get_domain_health.py[asn,{$DNS_DOMAIN}]'
          delay: 1d
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Autonomous System Number information for domain IP addresses. Identifies hosting provider and network.'
          tags:
            - tag: dns_check
              value: asn
            - tag: integration
              value: dns_health
        - uuid: b07cc3a4c9cd4b6a802c8b9f7dffd0fa
          name: 'ASN Count'
          type: DEPENDENT
          key: 'get_domain_health.py[asn.count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Number of unique ASNs hosting this domain. Multiple ASNs may indicate CDN or multi-homed hosting.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.unique_asns.length()
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[asn,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: asn
            - tag: integration
              value: dns_health
        - uuid: c18dd4b5dad04c7ba13d9ca08eaae1ab
          name: 'ASN Primary'
          type: DEPENDENT
          key: 'get_domain_health.py[asn.primary,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'Primary ASN for this domain (first unique ASN found).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.unique_asns[0].asn'
              error_handler: CUSTOM_VALUE
              error_handler_params: Unknown
          master_item:
            key: 'get_domain_health.py[asn,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: asn
            - tag: integration
              value: dns_health
        - uuid: d29ee5c6ebe14d8cb24eadb19fbba2bc
          name: 'ASN Primary Name'
          type: DEPENDENT
          key: 'get_domain_health.py[asn.primary_name,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'Name of primary AS (network provider).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.unique_asns[0].as_name'
              error_handler: CUSTOM_VALUE
              error_handler_params: Unknown
          master_item:
            key: 'get_domain_health.py[asn,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: asn
            - tag: integration
              value: dns_health
        - uuid: 11801fbf73184048b8b3de167d841ea1
          name: 'BIMI Full Data'
          type: EXTERNAL
          key: 'get_domain_health.py[bimi,{$DNS_DOMAIN}]'
          delay: 1h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'BIMI (Brand Indicators for Message Identification) record check. Enables brand logo display in email clients.'
          tags:
            - tag: dns_check
              value: bimi
            - tag: email_security
              value: bimi
            - tag: integration
              value: dns_health
        - uuid: ae5354c4b0d14ac092bb7bd6671ea59f
          name: 'BIMI Configured'
          type: DEPENDENT
          key: 'get_domain_health.py[bimi.configured,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if BIMI is configured (1=Yes, 0=No).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.configured
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[bimi,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: bimi
            - tag: integration
              value: dns_health
        - uuid: d966d18663074214a0d25b2921d95fa4
          name: 'BIMI Logo URL'
          type: DEPENDENT
          key: 'get_domain_health.py[bimi.logo_url,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'BIMI logo URL (SVG image location).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.logo_url
              error_handler: CUSTOM_VALUE
          master_item:
            key: 'get_domain_health.py[bimi,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: bimi
            - tag: integration
              value: dns_health
        - uuid: 945657f252274c1c85d1cb05f5f9c5e7
          name: 'DNS CAA Records Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[caa.valid,{$DNS_DOMAIN}]'
          delay: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.caa.valid
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: caa
            - tag: rfc
              value: RFC6844
          triggers:
            - uuid: 61ef758b54a5431bb7dd2e7aa85622e8
              expression: 'last(/Domain Health/get_domain_health.py[caa.valid,{$DNS_DOMAIN}])=0'
              name: 'DNS CAA Records Missing on {$DNS_DOMAIN}'
              priority: INFO
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: caa
                - tag: rfc
                  value: RFC6844
        - uuid: ca6c33237a6b4c7f900fa3d9219a6d75
          name: 'Comprehensive Domain Analysis'
          type: EXTERNAL
          key: 'get_domain_health.py[comprehensive,{$DNS_DOMAIN}]'
          delay: 1h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Comprehensive 7-phase domain analysis: DNS/Email Auth, Port Discovery, Service ID, SSL/TLS, Web Apps, Network Analysis, and Threat Intelligence & Risk Assessment'
          timeout: 120s
          tags:
            - tag: component
              value: master_analysis
            - tag: dns_check
              value: comprehensive
        - uuid: bce88ff085ab41a29ce2b7fcec3c7c5a
          name: 'DANE Full Data'
          type: EXTERNAL
          key: 'get_domain_health.py[dane,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'DANE (DNS-based Authentication of Named Entities) check for HTTPS port 443. Includes TLSA records and certificate validation.'
          tags:
            - tag: dns_check
              value: dane
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC6698
        - uuid: efbbbc3b8de44d58afb5ea2bfd6faf8d
          name: 'DANE Library Status'
          type: DEPENDENT
          key: 'get_domain_health.py[dane.library_status,{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Status of crypto libraries for DANE validation: dnspython, cryptography, pyopenssl.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.library_status
              error_handler: CUSTOM_VALUE
              error_handler_params: '{}'
            - type: JAVASCRIPT
              parameters:
                - 'var s = JSON.parse(value); var out = []; if(s.dnspython) out.push("dnspython:OK"); else out.push("dnspython:MISSING"); if(s.cryptography) out.push("cryptography:OK"); else out.push("cryptography:MISSING"); if(s.pyopenssl) out.push("pyopenssl:OK"); else out.push("pyopenssl:MISSING"); return out.join(", ");'
          master_item:
            key: 'get_domain_health.py[dane,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dane
            - tag: integration
              value: dns_health
        - uuid: cdf99aa196bc42b3adf3c80fdb4d8d6b
          name: 'DANE TLSA Record Count'
          type: DEPENDENT
          key: 'get_domain_health.py[dane.record_count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Number of TLSA records for _443._tcp.domain. Zero means DANE is not configured.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.record_count
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[dane,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dane
            - tag: rfc
              value: RFC6698
        - uuid: deaaabb2a7cd43c4bea4d91aec5e9e7c
          name: 'DANE Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[dane.valid,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if DANE/TLSA validation passed (1=Valid, 0=Invalid or not configured). Full validation requires cryptography and pyOpenSSL.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.valid
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[dane,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dane
            - tag: rfc
              value: RFC6698
        - uuid: c3f4568ecfc24f40be83c73935f21009
          name: 'DANE MX Data'
          type: EXTERNAL
          key: 'get_domain_health.py[dane_mx,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'DANE TLSA records for MX servers (RFC 7673). Validates SMTP TLS using TLSA records on port 25.'
          tags:
            - tag: dns_check
              value: dane_mx
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC7673
        - uuid: 00ccc0148674449797f1e2dc64a1ef13
          name: 'DANE MX Coverage Percent'
          type: DEPENDENT
          key: 'get_domain_health.py[dane_mx.coverage,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Percentage of MX servers with DANE TLSA records (0-100%).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.dane_coverage
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[dane_mx,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dane_mx
            - tag: rfc
              value: RFC7673
        - uuid: 7e0f057690b849d48d83685da75a78f1
          name: 'Domain Services Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_services.master,{$DNS_DOMAIN}]'
          delay: 12h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Discover all services associated with domain for comprehensive monitoring'
          timeout: 60s
          tags:
            - tag: component
              value: integration
            - tag: dns_check
              value: service_discovery
        - uuid: 9f1e2d3c4b5a4e7f8a9b8c1d2e3f4a5b
          name: 'Subdomain Infrastructure Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_subdomains.master,{$DNS_DOMAIN}]'
          delay: 12h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Phase 1: Enhanced subdomain discovery with comprehensive categorization and infrastructure mapping'
          timeout: 120s
          tags:
            - tag: component
              value: infrastructure
            - tag: dns_check
              value: subdomain_discovery
            - tag: phase
              value: '1'
        - uuid: 8e2f1d4c5b6a4e8f9a0c1d2e3f4a5b6c
          name: 'Port Infrastructure Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_ports.master,{$DNS_DOMAIN}]'
          delay: 6h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Phase 2: Comprehensive port scanning with service categorization and security analysis'
          timeout: 180s
          tags:
            - tag: component
              value: infrastructure
            - tag: dns_check
              value: port_discovery
            - tag: phase
              value: '2'
        - uuid: 7f3e2d5c6b9a4e7f8a1c2d3e4f5a6b7c
          name: 'Total Open Ports Count'
          type: DEPENDENT
          key: 'ports.total_open[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Total number of open ports discovered'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.port_discovery.total_open'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[discover_ports.master,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: infrastructure
            - tag: metric_type
              value: port_count
          triggers:
            - uuid: 6e4d3c2b1a9f4e7d8c5b4a3f2e1d0c9b
              expression: 'last(/Domain Health/ports.total_open[{$DNS_DOMAIN}])>{$PORT_COUNT_WARNING:20}'
              name: 'High Number of Open Ports on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'More than {$PORT_COUNT_WARNING} ports are open, which may indicate excessive service exposure'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: excessive_exposure
        - uuid: 5d2c1b0a9e8f4d6c9b4a3f2e1d0c9b8a
          name: 'Port Security Score'
          type: DEPENDENT
          key: 'ports.security_score[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Security score based on discovered ports (0-100)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.port_discovery.security_analysis.security_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[discover_ports.master,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: security
            - tag: metric_type
              value: security_score
          triggers:
            - uuid: 4c3b2a1f9e8d4c6b9a4f3e2d1c0b9a8f
              expression: 'last(/Domain Health/ports.security_score[{$DNS_DOMAIN}])<{$PORT_SECURITY_CRITICAL:40}'
              name: 'Critical Port Security Issues on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Port security score below {$PORT_SECURITY_CRITICAL}, indicating serious security concerns'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: critical_ports
            - uuid: 3b2a1f0e9d8c4b6a9f4e3d2c1b0a9f8e
              expression: 'last(/Domain Health/ports.security_score[{$DNS_DOMAIN}])<{$PORT_SECURITY_WARNING:70}'
              name: 'Port Security Warning on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Port security score below {$PORT_SECURITY_WARNING}, review exposed services'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: port_security
        - uuid: 2a1f0e9d8c7b4a5f8e3d2c1b0a9f8e7d
          name: 'Web Services Port Count'
          type: DEPENDENT
          key: 'ports.web_services[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of open web service ports (HTTP/HTTPS)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.port_discovery.by_service_type.web_services.service_count'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[discover_ports.master,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: web_services
            - tag: metric_type
              value: service_count
        - uuid: 1f0e9d8c7b6a4f4e8d2c1b0a9f8e7d6c
          name: 'Database Services Port Count'
          type: DEPENDENT
          key: 'ports.database_services[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of open database service ports'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.port_discovery.by_service_type.database_services.service_count'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[discover_ports.master,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: database_services
            - tag: metric_type
              value: service_count
          triggers:
            - uuid: 0e9d8c7b6a5f4e3d8c1b0a9f8e7d6c5b
              expression: 'last(/Domain Health/ports.database_services[{$DNS_DOMAIN}])>0'
              name: 'Database Services Exposed on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Database services are directly accessible from the internet, which may pose security risks'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: database_exposure
        
        # Phase 3: Service Identification and Fingerprinting
        
        - uuid: c80e182b3693485d89401d5a41ccb051
          name: 'Service Identification Master'
          type: EXTERNAL
          key: 'get_domain_health.py[identify_services,{$DNS_DOMAIN}]'
          delay: 2h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Comprehensive service identification and fingerprinting for all discovered open ports'
          timeout: 120s
          tags:
            - tag: component
              value: service_identification
            - tag: phase
              value: '3'
        
        - uuid: 4cc4af5081a5411c868a5adf0d4f9817
          name: 'Total Identified Services'
          type: DEPENDENT
          key: 'services.identified_total[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Total number of successfully identified services'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.service_summary.identified_services'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[identify_services,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: service_identification
            - tag: metric_type
              value: service_count
        
        - uuid: e6a6cf333f084e298833913176583a65
          name: 'Encrypted Services Count'
          type: DEPENDENT
          key: 'services.encrypted_count[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of services using encrypted protocols'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.service_summary.encrypted_services'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[identify_services,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: service_identification
            - tag: metric_type
              value: encrypted_services
        
        - uuid: 377cf0ceda4141fcb12d0cd4c71a99a3
          name: 'Vulnerable Services Count'
          type: DEPENDENT
          key: 'services.vulnerable_count[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of services with identified security issues'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.service_summary.vulnerable_services'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[identify_services,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: service_identification
            - tag: metric_type
              value: vulnerable_services
          triggers:
            - uuid: 56f4cf4f2988484a894c09dacdac1f4a
              expression: 'last(/Domain Health/services.vulnerable_count[{$DNS_DOMAIN}])>0'
              name: 'Vulnerable Services Detected on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'One or more services have been identified as having security vulnerabilities'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: vulnerable_services
        
        - uuid: adf489233d144b5da94ef43a71751cb3
          name: 'Web Services Count'
          type: DEPENDENT
          key: 'services.web_count[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of web services (HTTP/HTTPS)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.service_summary.web_services'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[identify_services,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: service_identification
            - tag: metric_type
              value: web_services
        
        - uuid: e5d9d39c943b48f58d068444dd1703bc
          name: 'Database Services Count'
          type: DEPENDENT
          key: 'services.database_count[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of exposed database services'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.service_summary.database_services'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[identify_services,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: service_identification
            - tag: metric_type
              value: database_services
          triggers:
            - uuid: febbb83aaa6d42619d560a410759cbe0
              expression: 'last(/Domain Health/services.database_count[{$DNS_DOMAIN}])>0'
              name: 'Database Services Publicly Exposed on {$DNS_DOMAIN}'
              priority: AVERAGE
              description: 'Database services are accessible from the internet'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: database_exposure
        
        - uuid: 14db5bc553544bec95e9754ca21f2ea1
          name: 'Overall Security Score'
          type: DEPENDENT
          key: 'services.security_score[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          value_type: FLOAT
          description: 'Overall security score based on service analysis (0-100)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.security_overview.overall_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '50'
          master_item:
            key: 'get_domain_health.py[identify_services,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: service_identification
            - tag: metric_type
              value: security_score
          triggers:
            - uuid: 0c8e76244c4e42a9a0625612811347b4
              expression: 'last(/Domain Health/services.security_score[{$DNS_DOMAIN}])<50'
              name: 'Low Security Score for {$DNS_DOMAIN}'
              priority: WARNING
              description: 'The overall security score is below 50, indicating security concerns'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: low_security_score
        
        - uuid: 5e6eb858f0fe4489b03f75227d6f0149
          name: 'Service Identification Results'
          type: DEPENDENT
          key: 'services.identification_results[{$DNS_DOMAIN}]'
          delay: '0'
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Detailed service identification results with banners and fingerprints'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.fingerprinting_results'
              error_handler: CUSTOM_VALUE
              error_handler_params: '{}'
          master_item:
            key: 'get_domain_health.py[identify_services,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: service_identification
            - tag: metric_type
              value: detailed_results
        
        - uuid: e06fbee048934fdf82489d0fe8b319bc
          name: 'Critical Security Issues'
          type: DEPENDENT
          key: 'services.critical_issues[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'List of critical security issues discovered during service identification'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.security_overview.critical_issues'
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
          master_item:
            key: 'get_domain_health.py[identify_services,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: service_identification
            - tag: metric_type
              value: critical_issues
          triggers:
            - uuid: 52ae09afd145458dae9a4c20b7628aec
              expression: 'length(last(/Domain Health/services.critical_issues[{$DNS_DOMAIN}]))>2'
              name: 'Critical Security Issues Found on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Critical security issues have been identified in the services'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: critical_issues
        
        # Service-Specific Identification Items
        
        - uuid: 16b569599f3d48878097bf9709111ae5
          name: 'HTTP Service Fingerprinting'
          type: EXTERNAL
          key: 'get_domain_health.py[fingerprint_web,{$DNS_DOMAIN},80]'
          delay: 4h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Detailed HTTP service fingerprinting and banner analysis'
          timeout: 30s
          tags:
            - tag: component
              value: service_identification
            - tag: service_type
              value: web
        
        - uuid: ea30ebd39b4a4924a587bf7f24cbc3b6
          name: 'HTTPS Service Fingerprinting'
          type: EXTERNAL
          key: 'get_domain_health.py[fingerprint_web,{$DNS_DOMAIN},443]'
          delay: 4h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Detailed HTTPS service fingerprinting with SSL certificate analysis'
          timeout: 30s
          tags:
            - tag: component
              value: service_identification
            - tag: service_type
              value: web_secure
        
        # Phase 4: SSL/TLS Security Analysis
        
        - uuid: c1b10cc24b02460c83f7cdd1d904ec4d
          name: 'SSL Analysis Master'
          type: EXTERNAL
          key: 'get_domain_health.py[ssl_analysis,{$DNS_DOMAIN}]'
          delay: 4h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Comprehensive SSL/TLS security analysis including certificate validation, protocol analysis, and vulnerability scanning'
          timeout: 180s
          tags:
            - tag: component
              value: ssl_analysis
            - tag: phase
              value: '4'
        
        - uuid: 6b5768ba497d4e9f9e905311568f8e9f
          name: 'SSL Security Grade'
          type: DEPENDENT
          key: 'ssl.security_grade[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          value_type: CHAR
          trends: '0'
          description: 'Overall SSL security grade (A+ to F)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.ssl_analysis.security_assessment.overall_grade'
              error_handler: CUSTOM_VALUE
              error_handler_params: 'F'
          master_item:
            key: 'get_domain_health.py[ssl_analysis,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: ssl_analysis
            - tag: metric_type
              value: security_grade
          triggers:
            - uuid: 60b60f6a69c345628c334cf4254698d8
              expression: 'last(/Domain Health/ssl.security_grade[{$DNS_DOMAIN}])="F"'
              name: 'SSL Security Grade F for {$DNS_DOMAIN}'
              priority: HIGH
              description: 'SSL configuration has critical security issues requiring immediate attention'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: ssl_critical
            - uuid: 0997f0c2f8c0437ea6140ee3f520e77e
              expression: 'last(/Domain Health/ssl.security_grade[{$DNS_DOMAIN}])="D"'
              name: 'SSL Security Grade D for {$DNS_DOMAIN}'
              priority: AVERAGE
              description: 'SSL configuration has significant security issues'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: ssl_poor
        
        - uuid: 0d2ff253187c457d92c160f6990e6584
          name: 'SSL Security Score'
          type: DEPENDENT
          key: 'ssl.security_score[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          value_type: FLOAT
          description: 'SSL security score (0-100)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.ssl_analysis.security_assessment.security_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[ssl_analysis,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: ssl_analysis
            - tag: metric_type
              value: security_score
          triggers:
            - uuid: 3eb8bf29751c4b55a780f92e9f2eb66d
              expression: 'last(/Domain Health/ssl.security_score[{$DNS_DOMAIN}])<40'
              name: 'Critical SSL Security Score for {$DNS_DOMAIN}'
              priority: HIGH
              description: 'SSL security score is critically low, indicating severe vulnerabilities'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: ssl_critical_score
        
        - uuid: 7de7d238687746a3a92040f6abb64edb
          name: 'SSL Certificates Found'
          type: DEPENDENT
          key: 'ssl.certificates_count[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of SSL certificates discovered'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.analysis_stats.certificates_found'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[ssl_analysis,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: ssl_analysis
            - tag: metric_type
              value: certificate_count
        
        - uuid: cd901df6082c4f858f2bc026b3476fde
          name: 'SSL Vulnerabilities Count'
          type: DEPENDENT
          key: 'ssl.vulnerabilities_count[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of SSL vulnerabilities detected'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.analysis_stats.vulnerabilities_detected'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[ssl_analysis,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: ssl_analysis
            - tag: metric_type
              value: vulnerability_count
          triggers:
            - uuid: 83631e7844644f1e955615f43a718d2d
              expression: 'last(/Domain Health/ssl.vulnerabilities_count[{$DNS_DOMAIN}])>0'
              name: 'SSL Vulnerabilities Detected on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'SSL/TLS vulnerabilities have been identified and should be addressed'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: ssl_vulnerabilities
        
        - uuid: fce5e2dd44dd437aa6dfa56e8627a926
          name: 'SSL Configuration Analysis'
          type: DEPENDENT
          key: 'ssl.configuration_analysis[{$DNS_DOMAIN}]'
          delay: '0'
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Detailed SSL configuration analysis including protocols, ciphers, and security assessment'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.ssl_analysis.configuration_analysis'
              error_handler: CUSTOM_VALUE
              error_handler_params: '{}'
          master_item:
            key: 'get_domain_health.py[ssl_analysis,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: ssl_analysis
            - tag: metric_type
              value: detailed_analysis
        
        - uuid: 806e013918ce4abe9a68d5c3e0b28492
          name: 'SSL Vulnerability Details'
          type: DEPENDENT
          key: 'ssl.vulnerability_details[{$DNS_DOMAIN}]'
          delay: '0'
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Detailed information about discovered SSL vulnerabilities'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.ssl_analysis.vulnerability_scan'
              error_handler: CUSTOM_VALUE
              error_handler_params: '{}'
          master_item:
            key: 'get_domain_health.py[ssl_analysis,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: ssl_analysis
            - tag: metric_type
              value: vulnerability_details
        
        - uuid: 298a903dac9e4efc85092dd78e2eb0ec
          name: 'SSL Best Practices Check'
          type: EXTERNAL
          key: 'get_domain_health.py[ssl_best_practices,{$DNS_DOMAIN}]'
          delay: 6h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'SSL/TLS best practices compliance assessment'
          timeout: 60s
          tags:
            - tag: component
              value: ssl_analysis
            - tag: metric_type
              value: best_practices
        
        - uuid: a948643569cd4236ba3021b14d1b7cb7
          name: 'SSL Compliance Score'
          type: DEPENDENT
          key: 'ssl.compliance_score[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          value_type: FLOAT
          description: 'SSL best practices compliance score (0-100%)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.best_practices_assessment.overall_compliance'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[ssl_best_practices,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: ssl_analysis
            - tag: metric_type
              value: compliance_score
          triggers:
            - uuid: 287f68377a9a4b6ab19d6d8d781cba2a
              expression: 'last(/Domain Health/ssl.compliance_score[{$DNS_DOMAIN}])<60'
              name: 'Low SSL Compliance Score for {$DNS_DOMAIN}'
              priority: WARNING
              description: 'SSL configuration does not meet security best practices'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: ssl_compliance
        
        - uuid: 2fc89fe042014881a790b80e6783fdf8
          name: 'SSL Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[ssl_discover,{$DNS_DOMAIN}]'
          delay: 8h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Discover SSL-enabled services and ports'
          timeout: 90s
          tags:
            - tag: component
              value: ssl_analysis
            - tag: metric_type
              value: discovery
        - uuid: 4b54bdcbbae54c81a940a37afe232a4e
          name: 'DNS DKIM Error'
          type: DEPENDENT
          key: 'get_domain_health.py[dkim.error,{$DNS_DOMAIN}]'
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.dkim.error
              error_handler: CUSTOM_VALUE
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dkim
        - uuid: 7670c5aa3f754a288382f83bb2da9891
          name: 'DNS DKIM Record Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[dkim.valid,{$DNS_DOMAIN}]'
          delay: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.dkim.valid
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dkim
          triggers:
            - uuid: 5373acf2edf24ed1a9bf8cc3f9253c74
              expression: 'last(/Domain Health/get_domain_health.py[dkim.valid,{$DNS_DOMAIN}])=0'
              name: 'DNS DKIM Record Invalid on {$DNS_DOMAIN}'
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: dkim
        - uuid: f50d9aa216004552974090575609b7ed
          name: 'DNS DMARC Error'
          type: DEPENDENT
          key: 'get_domain_health.py[dmarc.error,{$DNS_DOMAIN}]'
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.dmarc.error
              error_handler: CUSTOM_VALUE
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dmarc
            - tag: rfc
              value: RFC7489
        - uuid: 4f288debe99a4aeeb7ba6cd7d582dfd9
          name: 'DNS DMARC Record Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[dmarc.valid,{$DNS_DOMAIN}]'
          delay: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.dmarc.valid
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dmarc
            - tag: rfc
              value: RFC7489
          triggers:
            - uuid: 9024aeef0fad4cc8a38fe1cc217b7fad
              expression: 'last(/Domain Health/get_domain_health.py[dmarc.valid,{$DNS_DOMAIN}])=0'
              name: 'DNS DMARC Record Invalid on {$DNS_DOMAIN}'
              priority: AVERAGE
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: dmarc
                - tag: rfc
                  value: RFC7489
        - uuid: a1b2c3d4e5f64a7b8c9d0e1f2a3b4c5d
          name: 'DNSBL Status Data'
          type: EXTERNAL
          key: 'get_domain_health.py[dnsbl,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'DNS-based Blackhole List (DNSBL) check for domain IP addresses (RFC 5782). Checks major blacklists: Spamhaus, SpamCop, Barracuda, SORBS, etc.'
          tags:
            - tag: dns_check
              value: dnsbl
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC5782
        - uuid: b2c3d4e5f6a74b8c9d0e1f2a3b4c5d6e
          name: 'DNSBL Clean Status'
          type: DEPENDENT
          key: 'get_domain_health.py[dnsbl.clean,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if domain IPs are clean (not listed on any DNSBL). 1=Clean, 0=Listed on one or more blacklists.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.clean
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[dnsbl,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnsbl
            - tag: rfc
              value: RFC5782
          triggers:
            - uuid: 1a70b13d6c8f42f1954224fd11a9642f
              expression: 'last(/Domain Health/get_domain_health.py[dnsbl.clean,{$DNS_DOMAIN}])=0'
              name: 'Domain IP Listed on DNSBL/Blacklist on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'One or more of the domain IP addresses is listed on a DNSBL (RFC 5782). This can severely impact email deliverability and domain reputation. Check DNSBL listings and request removal.'
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: dnsbl
                - tag: rfc
                  value: RFC5782
                - tag: security
                  value: reputation
        - uuid: b23a700c6f86404cb5caf4fa04c721f6
          name: 'DNSBL Total Listings'
          type: DEPENDENT
          key: 'get_domain_health.py[dnsbl.listings,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Total number of blacklist listings across all checked DNSBLs.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.total_listings
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[dnsbl,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnsbl
            - tag: rfc
              value: RFC5782
        - uuid: c7e33abb30b64bcd879d2ba7f4ed270b
          name: 'DNSSEC Algorithms'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.algorithms,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'DNSSEC algorithms in use (e.g., RSASHA256, ECDSAP256SHA256, ED25519).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.dnskey.algorithms
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
            - type: JAVASCRIPT
              parameters:
                - 'return JSON.parse(value).join(", ");'
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: rfc
              value: RFC8624
        - uuid: 50ce5292ca20416987ea2be1071cd767
          name: 'DNSSEC Algorithm Compliant'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.algorithm_compliant,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if DNSSEC algorithms in use are compliant with RFC 8624 recommendations (1=Compliant, 0=Deprecated/weak algorithms in use).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.algorithm_compliance.compliant
              error_handler: CUSTOM_VALUE
              error_handler_params: '1'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: rfc
              value: RFC8624
          triggers:
            - uuid: f01c06808ad446928095670d120993b5
              expression: 'last(/Domain Health/get_domain_health.py[dnssec.algorithm_compliant,{$DNS_DOMAIN}])=0'
              name: 'DNSSEC Deprecated Algorithm in use on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'DNSSEC is using deprecated or weak algorithms per RFC 8624. Algorithms like RSASHA1 (algorithm 5) use SHA-1 which is considered weak. Consider migrating to ECDSAP256SHA256 (algorithm 13) or ED25519 (algorithm 15).'
              tags:
                - tag: dns_check
                  value: dnssec
                - tag: failure
                  value: deprecated_algorithm
                - tag: rfc
                  value: RFC8624
        - uuid: abd77eef74fa40f18bd1a6ebdb2b6b4f
          name: 'DNSSEC Chain Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.chain_valid,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if DNSSEC chain of trust from root is valid (1=Valid, 0=Invalid). Requires dnspython for full validation.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.chain_validation.chain_valid
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: rfc
              value: RFC4035
        - uuid: 857f57944f8b47f7b027f580b5c8c868
          name: 'DNSSEC Deprecated Algorithms'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.deprecated_algorithms,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'List of deprecated DNSSEC algorithms in use, per RFC 8624. Empty if all algorithms are compliant.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.algorithm_compliance.deprecated_algorithms
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: rfc
              value: RFC8624
        - uuid: f4b007e80df34fada46abfd4c1bac4de
          name: 'DNSSEC DNSKEY Count'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.dnskey_count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Total number of DNSKEY records for the domain.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.dnskey.count
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: rfc
              value: RFC4034
        - uuid: d8f44bcc41c74cde98ae3cb8a5fe381c
          name: 'DNSSEC DS Record Count'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.ds_count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Number of DS (Delegation Signer) records at parent zone. DS records link child zone to parent for chain of trust.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.ds.count
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: rfc
              value: RFC4034
        - uuid: f93d5d161dd14020bbd5df07a5f81344
          name: 'DNS DNSSEC Enabled'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.enabled,{$DNS_DOMAIN}]'
          delay: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.dnssec.enabled
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: rfc
              value: RFC4033
          triggers:
            - uuid: 4bc4068b9e044565a839ed2e23176618
              expression: 'last(/Domain Health/get_domain_health.py[dnssec.enabled,{$DNS_DOMAIN}])=0'
              name: 'DNSSEC Not Enabled on {$DNS_DOMAIN}'
              priority: INFO
              description: 'DNSSEC is not enabled for this domain. This is informational - many domains operate without DNSSEC. Consider enabling DNSSEC for improved DNS security.'
              tags:
                - tag: dns_check
                  value: dnssec
                - tag: rfc
                  value: RFC4033
        - uuid: 11bf2ced0775478282f4fc0b406293b8
          name: 'DNSSEC Failure Description'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.failure_description,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'Human-readable description explaining why DNSSEC validation failed. Empty if DNSSEC is valid or not configured.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.failure_description
              error_handler: CUSTOM_VALUE
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: diagnostic
              value: failure_description
            - tag: dns_check
              value: dnssec
        - uuid: 0ab88fff85fa41f29de3b8ed04b7c6d0
          name: 'DNSSEC Failure Reason'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.failure_reason,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: |
            Machine-readable failure reason for DNSSEC validation issues:
            - not_configured: No DNSKEY or DS records found
            - missing_dnskey: DS exists but DNSKEY missing (broken chain)
            - missing_ds: DNSKEY exists but DS missing (incomplete setup)
            - rrsig_not_visible: Keys present but RRSIG not visible (EDNS0/DO limitation)
            - missing_ksk: No Key Signing Key found
            - missing_zsk: No Zone Signing Key found
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.failure_reason
              error_handler: CUSTOM_VALUE
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: diagnostic
              value: failure_reason
            - tag: dns_check
              value: dnssec
          triggers:
            - uuid: 771867ecc9ee42ae96588a8b50fdf737
              expression: 'find(/Domain Health/get_domain_health.py[dnssec.failure_reason,{$DNS_DOMAIN}],,"like","missing_dnskey")=1'
              name: 'DNSSEC Broken Chain: DS exists but DNSKEY missing on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'CRITICAL - A DS (Delegation Signer) record exists in the parent zone, but no DNSKEY records are published in the child zone. This is a broken DNSSEC configuration that will cause DNSSEC-validating resolvers to FAIL resolution for this domain. Resolution: 1) Publish DNSKEY records in the zone, OR 2) Remove the DS record from the parent zone to disable DNSSEC.'
              tags:
                - tag: dns_check
                  value: dnssec
                - tag: failure
                  value: broken_chain
                - tag: rfc
                  value: RFC4033
            - uuid: d979df24896049e6a4c2544ed6853aab
              expression: 'find(/Domain Health/get_domain_health.py[dnssec.failure_reason,{$DNS_DOMAIN}],,"like","missing_ds")=1'
              name: 'DNSSEC Incomplete: DNSKEY exists but DS missing on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'DNSSEC is partially configured. DNSKEY records exist in the zone, but no DS record is published in the parent zone. Without a DS record, the chain of trust cannot be established from the root. Resolution: 1) Add a DS record to the parent zone (registrar DNSSEC settings), OR 2) Remove DNSKEY records if DNSSEC is not desired.'
              tags:
                - tag: dns_check
                  value: dnssec
                - tag: failure
                  value: incomplete
                - tag: rfc
                  value: RFC4033
            - uuid: 915747a9326c4cb69feff1b96578c105
              expression: 'find(/Domain Health/get_domain_health.py[dnssec.failure_reason,{$DNS_DOMAIN}],,"like","missing_ksk")=1'
              name: 'DNSSEC Missing KSK on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'DNSSEC is misconfigured: No Key Signing Key (KSK, flags=257) found. The zone has ZSK but is missing the KSK needed to sign the DNSKEY RRset and create the chain of trust.'
              tags:
                - tag: dns_check
                  value: dnssec
                - tag: failure
                  value: missing_ksk
                - tag: rfc
                  value: RFC4033
            - uuid: d9b5acb1940d4960b0c60a46239968d8
              expression: 'find(/Domain Health/get_domain_health.py[dnssec.failure_reason,{$DNS_DOMAIN}],,"like","missing_zsk")=1'
              name: 'DNSSEC Missing ZSK on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'DNSSEC is misconfigured: No Zone Signing Key (ZSK, flags=256) found. The zone has KSK but is missing the ZSK needed to sign zone records like A, MX, NS.'
              tags:
                - tag: dns_check
                  value: dnssec
                - tag: failure
                  value: missing_zsk
                - tag: rfc
                  value: RFC4033
            - uuid: 5f379c8d3cd2430cbb2ca16eb8213594
              expression: 'find(/Domain Health/get_domain_health.py[dnssec.failure_reason,{$DNS_DOMAIN}],,"like","rrsig_not_visible")=1'
              name: 'DNSSEC RRSIG Not Visible on {$DNS_DOMAIN}'
              priority: INFO
              description: 'DNSSEC appears configured (DNSKEY and DS records present), but RRSIG records are not visible. This may be due to: 1) DNS query library limitation - stdlib DNS queries do not set EDNS0 DO (DNSSEC OK) bit, 2) Zone is publishing keys but not signing records. To verify DNSSEC works correctly, install dnspython library (pip install dnspython) or use external validators like dnsviz.net or verisignlabs.com/dnssec.'
              tags:
                - tag: dns_check
                  value: dnssec
                - tag: failure
                  value: rrsig_limitation
                - tag: rfc
                  value: RFC4033
        - uuid: a5c118f91ef44fab857b0fe5d2cb05ef
          name: 'DNSSEC KSK Count'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.ksk_count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Number of Key Signing Keys (flag 257). KSKs sign DNSKEY RRsets and are referenced by parent DS records.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.dnskey.ksk_count
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: key_type
              value: ksk
        - uuid: e9a55cdd52d84defa9bf4dc9b60f492d
          name: 'DNSSEC RRSIG Count'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.rrsig_count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Number of RRSIG (Resource Record Signature) records. Each signed RRset has an RRSIG.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.rrsig.count
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: rfc
              value: RFC4034
        - uuid: fab66dee63e94ef0bac0f5daca1a5a3e
          name: 'DNSSEC RRSIG Nearest Expiry Days'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.rrsig_expiry_days,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: d
          description: 'Days until the soonest RRSIG expires. Negative means already expired. DNSSEC validation will fail if RRSIGs expire.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.rrsig.nearest_expiry_days
              error_handler: CUSTOM_VALUE
              error_handler_params: '-1'
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: rfc
              value: RFC4034
          triggers:
            - uuid: bda88bb3c6d54e7a90f4c8e9a7b5d3f2
              expression: 'last(/Domain Health/get_domain_health.py[dnssec.rrsig_expiry_days,{$DNS_DOMAIN}])>7 and last(/Domain Health/get_domain_health.py[dnssec.rrsig_expiry_days,{$DNS_DOMAIN}])<=14'
              name: 'DNSSEC RRSIG Expiring (14 days) on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'DNSSEC RRSIG signatures expire within 14 days. Plan key rotation/re-signing.'
              dependencies:
                - name: 'DNSSEC RRSIG Expiring Soon (7 days) on {$DNS_DOMAIN}'
                  expression: 'last(/Domain Health/get_domain_health.py[dnssec.rrsig_expiry_days,{$DNS_DOMAIN}])>=0 and last(/Domain Health/get_domain_health.py[dnssec.rrsig_expiry_days,{$DNS_DOMAIN}])<=7'
              tags:
                - tag: dns_check
                  value: dnssec
                - tag: expiry
                  value: warning
                - tag: rfc
                  value: RFC4034
            - uuid: acf77aa2b5c44d6f89e3b7d8f6a4c2e1
              expression: 'last(/Domain Health/get_domain_health.py[dnssec.rrsig_expiry_days,{$DNS_DOMAIN}])>=0 and last(/Domain Health/get_domain_health.py[dnssec.rrsig_expiry_days,{$DNS_DOMAIN}])<=7'
              name: 'DNSSEC RRSIG Expiring Soon (7 days) on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'DNSSEC RRSIG signatures expire within 7 days. If not renewed, DNSSEC validation will fail.'
              tags:
                - tag: dns_check
                  value: dnssec
                - tag: expiry
                  value: critical
                - tag: rfc
                  value: RFC4034
        - uuid: 71997615a61e4303af9573ee32daeae0
          name: 'DNS DNSSEC Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.valid,{$DNS_DOMAIN}]'
          delay: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.dnssec.valid
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: rfc
              value: RFC4033
        - uuid: b6d229aa2fa54abc968c1af6e3dc16fa
          name: 'DNSSEC ZSK Count'
          type: DEPENDENT
          key: 'get_domain_health.py[dnssec.zsk_count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Number of Zone Signing Keys (flag 256). ZSKs sign zone records like A, MX, NS.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.dnskey.zsk_count
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: key_type
              value: zsk
        - uuid: e3aff6d7fce24e9ca35faec3b0afb3cd
          name: 'DNSSEC Detailed Data'
          type: EXTERNAL
          key: 'get_domain_health.py[dnssec_detailed,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Detailed DNSSEC analysis including DNSKEY types (KSK/ZSK), algorithms, DS records, RRSIG expiry, and chain validation.'
          tags:
            - tag: dns_check
              value: dnssec
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC4033
        - uuid: f5a6b9c8d4e34f8a949d3e4f5a6b7c85
          name: 'Domain Special Use Warning'
          type: DEPENDENT
          key: 'get_domain_health.py[domain.special_warning,{$DNS_DOMAIN}]'
          delay: '0'
          value_type: TEXT
          trends: '0'
          description: 'Warning message for special-use, reserved, or private domains'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.special_domain.warning
              error_handler: CUSTOM_VALUE
              error_handler_params: 'No special domain warnings'
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: special_domain
            - tag: rfc
              value: RFC5735
        - uuid: 2ea6aa41a46346bfaae2dfd921fbb3fa
          name: 'Email Security Full Data'
          type: EXTERNAL
          key: 'get_domain_health.py[email_security,{$DNS_DOMAIN}]'
          delay: 1h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Comprehensive email security status including SPF, DKIM, DMARC, MTA-STS, TLS-RPT, and BIMI.'
          tags:
            - tag: dns_check
              value: email_security
            - tag: integration
              value: dns_health
        - uuid: a7be8ecb1a3f4931a067f61bb4d7f16f
          name: 'Email Security Score'
          type: DEPENDENT
          key: 'get_domain_health.py[email_security.score,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Email security score (0-6). Counts configured: SPF, DKIM, DMARC, MTA-STS, TLS-RPT, BIMI.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.score
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[email_security,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: email_security
            - tag: integration
              value: dns_health
          triggers:
            - uuid: 1e1e21556bc1474f9e8b3bc347fafefd
              expression: 'last(/Domain Health/get_domain_health.py[email_security.score,{$DNS_DOMAIN}])<=2'
              name: 'Email Security Score Low on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Email security score is 2 or lower out of 6. Missing email authentication mechanisms (SPF, DKIM, DMARC, MTA-STS, TLS-RPT, BIMI). Improve email security posture.'
              tags:
                - tag: dns_check
                  value: email_security
                - tag: security
                  value: email
        - uuid: 5fcd14f908ae4629ab50a1e3cfff2fec
          name: 'Email SRV Records Data'
          type: EXTERNAL
          key: 'get_domain_health.py[email_srv,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Email client autoconfiguration SRV records (RFC 6186). Discovers IMAP, POP3, SMTP submission, and autodiscover SRV records.'
          tags:
            - tag: dns_check
              value: email_srv
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC6186
        - uuid: e78672c6923d4aa38482f4631b34a4ed
          name: 'Email SRV Services Found'
          type: DEPENDENT
          key: 'get_domain_health.py[email_srv.count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Number of email-related SRV records found for client autoconfiguration.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.services_found
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[email_srv,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: email_srv
            - tag: rfc
              value: RFC6186
        - uuid: 710ebcc8b0364870af7c326f68d5462f
          name: 'NS Glue Records Data'
          type: EXTERNAL
          key: 'get_domain_health.py[glue,{$DNS_DOMAIN}]'
          delay: 12h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Glue record validation (RFC 9471). Checks for proper glue records for in-bailiwick nameservers.'
          tags:
            - tag: dns_check
              value: glue
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC9471
        - uuid: e1f2a3b4c5d64e7f8a9b0c1d2e3f4a5b
          name: 'Glue Records Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[glue.valid,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if glue records are properly configured (1=Valid, 0=Missing or invalid).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.glue_valid
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[glue,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: glue
            - tag: rfc
              value: RFC9471
          triggers:
            - uuid: a46a968185914eabb822b640f2480581
              expression: 'last(/Domain Health/get_domain_health.py[glue.valid,{$DNS_DOMAIN}])=0'
              name: 'Glue Records Missing or Invalid on {$DNS_DOMAIN}'
              priority: AVERAGE
              description: 'Glue records are missing or invalid (RFC 9471). Required for in-bailiwick nameservers to prevent circular resolution dependencies.'
              tags:
                - tag: dns_check
                  value: glue
                - tag: reliability
                  value: glue
                - tag: rfc
                  value: RFC9471
        - uuid: e635bbdceecf4e7b902020530ffa03e9
          name: 'DNS Health Full Report'
          type: EXTERNAL
          key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          delay: 1h
          history: 30d
          value_type: TEXT
          trends: '0'
          tags:
            - tag: dns_check
              value: full_report
            - tag: integration
              value: dns_health
        - uuid: d71573c863e74937a07b5f86ae9cb666
          name: 'Overall Domain Health Score'
          type: DEPENDENT
          key: 'get_domain_health.py[health.comprehensive_score,{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          units: '%'
          description: 'Comprehensive health score based on all DNS monitoring components (0-100%)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.overall_health_score
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[comprehensive,{$DNS_DOMAIN}]'
          triggers:
            - uuid: 4b27cde152954923a91f4b08758f5888
              expression: 'last(/Domain Health/get_domain_health.py[health.comprehensive_score,{$DNS_DOMAIN}])<50'
              name: 'Critical Domain Health Issues on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Overall domain health score below 50% - immediate attention required'
              tags:
                - tag: dns_check
                  value: comprehensive
            - uuid: 70196eb1f15d4b20a589309f742b24f5
              expression: 'last(/Domain Health/get_domain_health.py[health.comprehensive_score,{$DNS_DOMAIN}])<70'
              name: 'Poor Overall Domain Health on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Overall domain health score below 70% - review critical issues and recommendations'
              tags:
                - tag: dns_check
                  value: comprehensive
        - uuid: 3a7cea35c4014a78a5fdde57dfe50367
          name: 'DNS Health Score'
          type: DEPENDENT
          key: 'get_domain_health.py[health_score,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.health_score
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: health_score
            - tag: integration
              value: dns_health
          triggers:
            - uuid: ef61558b4c70403895f77e5de3fa1956
              expression: 'last(/Domain Health/get_domain_health.py[health_score,{$DNS_DOMAIN}])<50'
              name: 'DNS Health Score Critical on {$DNS_DOMAIN}'
              priority: HIGH
              tags:
                - tag: dns_check
                  value: health_score
                - tag: severity
                  value: high
            - uuid: c9207b50d02f422cb884d52b2d7c047e
              expression: 'last(/Domain Health/get_domain_health.py[health_score,{$DNS_DOMAIN}])<75 and last(/Domain Health/get_domain_health.py[health_score,{$DNS_DOMAIN}])>=50'
              name: 'DNS Health Score Warning on {$DNS_DOMAIN}'
              priority: WARNING
              tags:
                - tag: dns_check
                  value: health_score
                - tag: severity
                  value: warning
        - uuid: 1a6ed025ea1d4da7a53c9d8cbd33d4e0
          name: 'DNS Query Latency'
          type: EXTERNAL
          key: 'get_domain_health.py[latency,{$DNS_DOMAIN}]'
          delay: 5m
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'DNS query resolution latency measurement.'
          tags:
            - tag: dns_check
              value: latency
            - tag: integration
              value: dns_health
        - uuid: d38945b30e7a4c9cbedcbf8273cff914
          name: 'DNS Average Latency'
          type: DEPENDENT
          key: 'get_domain_health.py[latency.average,{$DNS_DOMAIN}]'
          delay: '0'
          description: 'Average DNS resolution latency across multiple resolvers'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.performance_metrics.avg_latency_ms
              error_handler: CUSTOM_VALUE
              error_handler_params: '-1'
          master_item:
            key: 'get_domain_health.py[performance,{$DNS_DOMAIN}]'
          triggers:
            - uuid: 92df143093764703a589264837e45dd5
              expression: 'last(/Domain Health/get_domain_health.py[latency.average,{$DNS_DOMAIN}])>1000'
              name: 'High DNS Latency on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'DNS resolution taking longer than 1000ms - may impact user experience'
              tags:
                - tag: dns_check
                  value: performance
        - uuid: 72f86959c666472792b81d92d0ea9ce1
          name: 'DNS Query Latency (ms)'
          type: DEPENDENT
          key: 'get_domain_health.py[latency.ms,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: FLOAT
          units: ms
          description: 'DNS query resolution time in milliseconds.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.latency_ms
              error_handler: CUSTOM_VALUE
              error_handler_params: '-1'
          master_item:
            key: 'get_domain_health.py[latency,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: latency
            - tag: integration
              value: dns_health
          triggers:
            - uuid: 125e6473ada445d1900f5529201fafe7
              expression: 'last(/Domain Health/get_domain_health.py[latency.ms,{$DNS_DOMAIN}])>{$DNS_LATENCY_WARNING}'
              name: 'DNS Query Latency High on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'DNS query latency exceeds {$DNS_LATENCY_WARNING}ms threshold. This may indicate DNS server performance issues or network problems.'
              tags:
                - tag: dns_check
                  value: latency
                - tag: performance
                  value: warning
        - uuid: baa705a979414b6b8eb7d797d9368eea
          name: 'Legacy SPF Record Check'
          type: EXTERNAL
          key: 'get_domain_health.py[legacy_spf,{$DNS_DOMAIN}]'
          delay: 1d
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Check for deprecated SPF record type (RFC 7208 - should not be used)'
          timeout: 30s
          tags:
            - tag: dns_check
              value: legacy_spf
            - tag: rfc
              value: RFC7208
        - uuid: f1f957b5444c4d8daa60fbe9b2d9d24f
          name: 'Legacy SPF Records Count'
          type: DEPENDENT
          key: 'get_domain_health.py[legacy_spf.count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of deprecated SPF records found'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.count
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[legacy_spf,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: legacy_spf
            - tag: rfc
              value: RFC7208
        - uuid: 1d034eb7f259456493bc7a659de44c65
          name: 'Legacy SPF Records Found'
          type: DEPENDENT
          key: 'get_domain_health.py[legacy_spf.found,{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Indicates if deprecated SPF record type is found (1=Found, 0=Not Found)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.legacy_spf_found
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
            - type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[legacy_spf,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: legacy_spf
            - tag: rfc
              value: RFC7208
          triggers:
            - uuid: e017d28c0a664a10b9d381b75edb3e68
              expression: 'last(/Domain Health/get_domain_health.py[legacy_spf.found,{$DNS_DOMAIN}])=1'
              name: 'Legacy SPF Record Type Detected on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Deprecated SPF record type found - should use TXT records only (RFC 7208)'
              tags:
                - tag: dns_check
                  value: legacy_spf
                - tag: rfc
                  value: RFC7208
        - uuid: 5af4149fc95f40f8a574e3d6ab9bbe25
          name: 'MTA-STS Full Data'
          type: EXTERNAL
          key: 'get_domain_health.py[mta_sts,{$DNS_DOMAIN}]'
          delay: 1h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'MTA-STS (RFC 8461) policy record check. Prevents TLS downgrade attacks on SMTP.'
          tags:
            - tag: dns_check
              value: mta_sts
            - tag: email_security
              value: mta_sts
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC8461
        - uuid: f55e2b8e029b4f85befb2e2e397e1614
          name: 'MTA-STS Configured'
          type: DEPENDENT
          key: 'get_domain_health.py[mta_sts.configured,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if MTA-STS is configured (1=Yes, 0=No).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.configured
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[mta_sts,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: mta_sts
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC8461
          triggers:
            - uuid: 8422715ed06a4ee4964b42450d870e31
              expression: 'last(/Domain Health/get_domain_health.py[mta_sts.configured,{$DNS_DOMAIN}])=0'
              name: 'MTA-STS Not Configured on {$DNS_DOMAIN}'
              priority: INFO
              description: 'MTA-STS (RFC 8461) is not configured. MTA-STS prevents TLS downgrade attacks on SMTP connections. Consider publishing a _mta-sts TXT record.'
              tags:
                - tag: dns_check
                  value: mta_sts
                - tag: email_security
                  value: mta_sts
                - tag: rfc
                  value: RFC8461
        - uuid: 69969865268c46e1a7e481582a86804c
          name: 'MTA-STS Policy ID'
          type: DEPENDENT
          key: 'get_domain_health.py[mta_sts.id,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'MTA-STS policy ID (changes when policy is updated).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.id
              error_handler: CUSTOM_VALUE
          master_item:
            key: 'get_domain_health.py[mta_sts,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: mta_sts
            - tag: integration
              value: dns_health
        - uuid: 5d550dea94594f689435299c3de3340b
          name: 'DNS MX Records Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[mx.valid,{$DNS_DOMAIN}]'
          delay: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.mx.valid
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: mx
            - tag: rfc
              value: RFC1035
          triggers:
            - uuid: d2fdbd2ef619473fb5739450b90356b5
              expression: 'last(/Domain Health/get_domain_health.py[mx.valid,{$DNS_DOMAIN}])=0'
              name: 'DNS MX Records Invalid on {$DNS_DOMAIN}'
              priority: AVERAGE
              tags:
                - tag: dns_check
                  value: mx
                - tag: rfc
                  value: RFC1035
        - uuid: 767606b158e54caeb9a88749213de711
          name: 'DNS NS Records Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[ns.valid,{$DNS_DOMAIN}]'
          delay: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.ns.valid
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: ns
            - tag: rfc
              value: RFC1035
          triggers:
            - uuid: ebb7238c3c204ac79a1dc58de38718d5
              expression: 'last(/Domain Health/get_domain_health.py[ns.valid,{$DNS_DOMAIN}])=0'
              name: 'DNS NS Records Invalid on {$DNS_DOMAIN}'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: ns
                - tag: rfc
                  value: RFC1035
        - uuid: bd7dfce4f5954c2f8984041504b102b4
          name: 'NS Count'
          type: DEPENDENT
          key: 'get_domain_health.py[ns_count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Total number of authoritative nameservers for the domain.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.ns_count
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[ns_diversity,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: ns_diversity
            - tag: rfc
              value: RFC2182
          triggers:
            - uuid: f0ad6327ac8e48cd9ee156aafbfd79e0
              expression: 'last(/Domain Health/get_domain_health.py[ns_count,{$DNS_DOMAIN}])<2'
              name: 'Insufficient NS Count on {$DNS_DOMAIN}'
              priority: AVERAGE
              description: 'Domain has less than 2 authoritative nameservers (RFC 2182 recommends at least 2). Single points of failure risk DNS availability.'
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: ns_diversity
                - tag: reliability
                  value: spof
                - tag: rfc
                  value: RFC2182
        - uuid: f2a3b4c5d6e74f8a9b0c1d2e3f4a5b6c
          name: 'NS Diversity Data'
          type: EXTERNAL
          key: 'get_domain_health.py[ns_diversity,{$DNS_DOMAIN}]'
          delay: 12h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Nameserver diversity analysis (RFC 2182). Checks NS distribution across networks, ASNs, and geographic diversity.'
          tags:
            - tag: dns_check
              value: ns_diversity
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC2182
        - uuid: 43ce1a9333ed461f9bef635f5f383471
          name: 'NS Diversity Score'
          type: DEPENDENT
          key: 'get_domain_health.py[ns_diversity.score,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Nameserver diversity score (0-100). Higher scores indicate better distribution for resilience.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.diversity_score
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[ns_diversity,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: ns_diversity
            - tag: rfc
              value: RFC2182
          triggers:
            - uuid: ab18f6e9c6534cdda0da84b2d26caa30
              expression: 'last(/Domain Health/get_domain_health.py[ns_diversity.score,{$DNS_DOMAIN}])<50'
              name: 'NS Diversity Score Low on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Nameserver diversity score is below 50 (RFC 2182). Low diversity increases risk of DNS outages. Consider using nameservers on different networks/ASNs.'
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: ns_diversity
                - tag: reliability
                  value: redundancy
                - tag: rfc
                  value: RFC2182
        - uuid: bc8ab63c115f49b3badd929b1b7486f3
          name: 'DNS Performance Analysis'
          type: EXTERNAL
          key: 'get_domain_health.py[performance,{$DNS_DOMAIN}]'
          delay: 15m
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Comprehensive DNS performance analysis including latency, resolver diversity, and caching metrics'
          timeout: 30s
          tags:
            - tag: component
              value: advanced_monitoring
            - tag: dns_check
              value: performance
        - uuid: d3e4f8a7b2c14d6e827b4c5d6e7f8a92
          name: 'Domain Private Use Status'
          type: DEPENDENT
          key: 'get_domain_health.py[private_use,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if domain appears to be for private/internal use - 1=Private, 0=Public'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.special_domain.is_private
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: special_domain
            - tag: rfc
              value: RFC6761
          triggers:
            - uuid: e4f5a9b8c3d24e7f938e2b3c4d5e6f79
              expression: 'last(/Domain Health/get_domain_health.py[private_use,{$DNS_DOMAIN}])=1'
              name: 'Domain appears to be for Private/Internal Use on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Domain uses patterns suggesting private/internal use (.internal, .corp, .home, .lan, .local) which may cause public DNS resolution issues'
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: special_domain
                - tag: rfc
                  value: RFC6761
        - uuid: dc3ee9c085ef472cbce8475b3fbba6bc
          name: 'RDAP Full Data'
          type: EXTERNAL
          key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          delay: 1d
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'RDAP (Registration Data Access Protocol) data for domain. Modern replacement for WHOIS with structured JSON output.'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC7480
        - uuid: dafa4c1d51a54df98ab0a228a7cc1ade
          name: 'RDAP Creation Date'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.creation_date,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'Domain creation/registration date from RDAP.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.creation_date
              error_handler: CUSTOM_VALUE
              error_handler_params: Unknown
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
        - uuid: fe5aa1e2a7ab49488e0a697d5bddb8de
          name: 'RDAP Days Until Expiry'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.days_until_expiry,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          units: d
          description: 'Days until domain expiry from RDAP data.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.days_until_expiry
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
        - uuid: 35611e0ca8de435abed0d2d2f067c002
          name: 'RDAP Domain Age (Days)'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.domain_age,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Domain age in days since registration. Newly registered domains (< 30 days) may indicate phishing risk.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.domain_age_days
              error_handler: CUSTOM_VALUE
              error_handler_params: '-1'
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
            - tag: security
              value: domain_age
          triggers:
            - uuid: 4b9c694ff1c5458c8e4075fccbc8edb8
              expression: 'last(/Domain Health/get_domain_health.py[rdap.domain_age,{$DNS_DOMAIN}])>=0 and last(/Domain Health/get_domain_health.py[rdap.domain_age,{$DNS_DOMAIN}])<30'
              name: 'Domain Age Under 30 Days on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Domain was registered less than 30 days ago. Newly registered domains may indicate phishing or spam campaigns. Verify domain legitimacy.'
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: rdap
                - tag: security
                  value: domain_age
        - uuid: eb0b5d2e62b64ea0abc1b339b8dd2bef
          name: 'RDAP Expiry Date'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.expiry_date,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'Domain expiry date from RDAP in ISO 8601 format.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.expiry_date
              error_handler: CUSTOM_VALUE
              error_handler_params: Unknown
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
        - uuid: c9e33b0c40f44ce88faef117f6bb09cd
          name: 'RDAP Nameservers'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.nameservers,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'Comma-separated list of nameservers from RDAP data.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.nameservers
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
            - type: JAVASCRIPT
              parameters:
                - 'return JSON.parse(value).join(", ");'
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
        - uuid: ed4ff0d196fa48398df9586c4acca7cd
          name: 'RDAP Registrar'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.registrar,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.registrar
              error_handler: CUSTOM_VALUE
              error_handler_params: Unknown
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
        - uuid: fc1c6e3f73c74fb1acd2c44ac9ee3cfa
          name: 'RDAP Server'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.server,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'RDAP server URL used for the query.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.rdap_server
              error_handler: CUSTOM_VALUE
              error_handler_params: Unknown
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
        - uuid: a16bb3e4c8dc4a608f2c8b9f8effd1ab
          name: 'RDAP Status List'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.status,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'Comma-separated list of all domain status codes from RDAP (e.g., clientTransferProhibited, serverDeleteProhibited).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.status
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
            - type: JAVASCRIPT
              parameters:
                - 'return JSON.parse(value).join(", ");'
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
        - uuid: d49ee6b7fbaf4d93b25fbec2b1ccb4de
          name: 'RDAP Client Delete Prohibited'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.status.client_delete_prohibited,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if clientDeleteProhibited status is set (1=Yes, 0=No). Prevents accidental domain deletion.'
          valuemap:
            name: 'Registrar Lock Status'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.status
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
            - type: JAVASCRIPT
              parameters:
                - 'var arr = JSON.parse(value); return arr.some(function(s) { return s.toLowerCase().indexOf("client delete prohibited") >= 0 || s.toLowerCase().indexOf("clientdeleteprohibited") >= 0; }) ? 1 : 0;'
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
            - tag: registrar_lock
              value: delete
        - uuid: c38dd5a6eafe4c82a14eadb1a0bba3cd
          name: 'RDAP Client Transfer Prohibited'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.status.client_transfer_prohibited,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if clientTransferProhibited status is set (1=Yes, 0=No). Prevents unauthorized domain transfers.'
          valuemap:
            name: 'Transfer Prohibition Status'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.status
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
            - type: JAVASCRIPT
              parameters:
                - 'var arr = JSON.parse(value); return arr.some(function(s) { return s.toLowerCase().indexOf("client transfer prohibited") >= 0 || s.toLowerCase().indexOf("clienttransferprohibited") >= 0; }) ? 1 : 0;'
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
            - tag: registrar_lock
              value: transfer
          triggers:
            - uuid: 7bea09ad21b74fd2925fdb59c72c22a2
              expression: 'last(/Domain Health/get_domain_health.py[rdap.status.client_transfer_prohibited,{$DNS_DOMAIN}])=0'
              name: 'Domain Transfer Lock Disabled on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Domain transfer lock (clientTransferProhibited) is not enabled. This leaves the domain vulnerable to unauthorized transfers. Enable registrar transfer lock.'
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: rdap
                - tag: registrar_lock
                  value: transfer
                - tag: security
                  value: domain_lock
        - uuid: e5aff7c80cb04ea48369fdd3c2ddc5ef
          name: 'RDAP Client Update Prohibited'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.status.client_update_prohibited,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if clientUpdateProhibited status is set (1=Yes, 0=No). Prevents unauthorized DNS/contact changes.'
          valuemap:
            name: 'Registrar Lock Status'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.status
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
            - type: JAVASCRIPT
              parameters:
                - 'var arr = JSON.parse(value); return arr.some(function(s) { return s.toLowerCase().indexOf("client update prohibited") >= 0 || s.toLowerCase().indexOf("clientupdateprohibited") >= 0; }) ? 1 : 0;'
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
            - tag: registrar_lock
              value: update
        - uuid: a7c119ea2ed24ac6858c1ff5e4ffe7ab
          name: 'RDAP Server Delete Prohibited'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.status.server_delete_prohibited,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if serverDeleteProhibited status is set (1=Yes, 0=No). Registry-level delete protection.'
          valuemap:
            name: 'Registrar Lock Status'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.status
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
            - type: JAVASCRIPT
              parameters:
                - 'var arr = JSON.parse(value); return arr.some(function(s) { return s.toLowerCase().indexOf("server delete prohibited") >= 0 || s.toLowerCase().indexOf("serverdeleteprohibited") >= 0; }) ? 1 : 0;'
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
            - tag: registry_lock
              value: delete
        - uuid: f6b008d91dc14fb5847b0ee4d3eed6fa
          name: 'RDAP Server Transfer Prohibited'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.status.server_transfer_prohibited,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if serverTransferProhibited status is set (1=Yes, 0=No). Registry-level transfer lock.'
          valuemap:
            name: 'Transfer Prohibition Status'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.status
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
            - type: JAVASCRIPT
              parameters:
                - 'var arr = JSON.parse(value); return arr.some(function(s) { return s.toLowerCase().indexOf("server transfer prohibited") >= 0 || s.toLowerCase().indexOf("servertransferprohibited") >= 0; }) ? 1 : 0;'
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
            - tag: registry_lock
              value: transfer
        - uuid: b8d22afb3fe34bd7869d2006f5aaf8bc
          name: 'RDAP Server Update Prohibited'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.status.server_update_prohibited,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if serverUpdateProhibited status is set (1=Yes, 0=No). Registry-level update protection.'
          valuemap:
            name: 'Registrar Lock Status'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.status
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
            - type: JAVASCRIPT
              parameters:
                - 'var arr = JSON.parse(value); return arr.some(function(s) { return s.toLowerCase().indexOf("server update prohibited") >= 0 || s.toLowerCase().indexOf("serverupdateprohibited") >= 0; }) ? 1 : 0;'
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
            - tag: registry_lock
              value: update
        - uuid: b27cc4f5d9ed4b71903d9ca09faae2bc
          name: 'RDAP Status Count'
          type: DEPENDENT
          key: 'get_domain_health.py[rdap.status_count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Number of domain status codes applied by the registrar.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.status.length()
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[rdap,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rdap
            - tag: integration
              value: dns_health
        - uuid: b9c1d4e6f2a04b3e8c8c9d1e2f3a4b57
          name: 'Domain Reserved Status'
          type: DEPENDENT
          key: 'get_domain_health.py[reserved,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if domain is reserved for documentation (RFC 2606) - 1=Reserved, 0=Normal'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.special_domain.is_reserved
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: special_domain
            - tag: rfc
              value: RFC2606
          triggers:
            - uuid: c8d2e5f7a4b14c9e958f1a2b3c4d5e68
              expression: 'last(/Domain Health/get_domain_health.py[reserved,{$DNS_DOMAIN}])=1'
              name: 'Domain is Reserved for Documentation on {$DNS_DOMAIN}'
              priority: INFO
              description: 'Domain is reserved for documentation/examples (example.com, example.net, example.org, test.example) and should not be used in production'
              manual_close: 'YES'
              tags:
                - tag: dns_check
                  value: special_domain
                - tag: rfc
                  value: RFC2606
        - uuid: 42496d2f7d164627b7772634d8a1d61c
          name: 'DNS Resolver Success Rate'
          type: DEPENDENT
          key: 'get_domain_health.py[resolver.success_rate,{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          units: '%'
          description: 'Percentage of DNS resolvers that successfully respond'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.performance_metrics.resolver_success_rate
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[performance,{$DNS_DOMAIN}]'
          triggers:
            - uuid: fda70b13c63c4dda9cffddeaaefbd04a
              expression: 'last(/Domain Health/get_domain_health.py[resolver.success_rate,{$DNS_DOMAIN}])<80'
              name: 'Low DNS Resolver Success Rate on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Less than 80% of DNS resolvers responding successfully - potential DNS infrastructure issues'
              tags:
                - tag: dns_check
                  value: performance
        - uuid: 5dd0a32f7b3546718050af02d05314a3
          name: 'DNS CNAME Coexistance Validation Data'
          type: EXTERNAL
          key: 'get_domain_health.py[rfc2181,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'RFC 2181 compliance check including CNAME rules and TTL consistency validation.'
          tags:
            - tag: dns_check
              value: cname_coexists
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC2181
        - uuid: 8e121a86260e4641adc37f2cac430bea
          name: 'DNS CNAME Coexistence Violation'
          type: DEPENDENT
          key: 'get_domain_health.py[rfc2181.cname_coexists,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if CNAME coexists with other records (1=Violation, 0=OK). Per RFC 2181, CNAME must not coexist with other data.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.cname_validation.cname_coexists
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[rfc2181,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rfc2181
            - tag: rfc
              value: RFC2181
          triggers:
            - uuid: a48a08827ab6492485e93c6a8cbd38ea
              expression: 'last(/Domain Health/get_domain_health.py[rfc2181.cname_coexists,{$DNS_DOMAIN}])=1'
              name: 'DNS CNAME Coexistence Violation: CNAME coexists with other records on {$DNS_DOMAIN}'
              priority: AVERAGE
              description: 'RFC 2181 violation detected: A CNAME record coexists with other record types at the same name. Per RFC 2181 Section 10.1, a CNAME record must not coexist with any other data. This can cause unpredictable DNS resolution behavior.'
              tags:
                - tag: dns_check
                  value: rfc2181
                - tag: failure
                  value: cname_violation
                - tag: rfc
                  value: RFC2181
        - uuid: 5aa62bbf870b45318e63aa9aeac36a3f
          name: 'DNS CNAME Coexistance Compliant'
          type: DEPENDENT
          key: 'get_domain_health.py[rfc2181.valid,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates RFC 2181 compliance (1=Compliant, 0=Violations found). Checks CNAME rules and TTL consistency.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.valid
              error_handler: CUSTOM_VALUE
              error_handler_params: '1'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[rfc2181,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: rfc2181
            - tag: rfc
              value: RFC2181
          triggers:
            - uuid: 7feb2a29c6564aa5843d627bc959e1bf
              expression: 'last(/Domain Health/get_domain_health.py[rfc2181.valid,{$DNS_DOMAIN}])=0'
              name: 'DNS CNAME Coexistence Compliance Failed on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'RFC 2181 DNS specification compliance check failed. This may indicate CNAME rule violations or inconsistent TTLs across RRsets. Review the "DNS CNAME Coexistance Validation data" for details.'
              tags:
                - tag: dns_check
                  value: rfc2181
                - tag: rfc
                  value: RFC2181
        - uuid: 5cb7ef91b76f4550bec183e79e8361e1
          name: 'DNS Amplification Risk'
          type: DEPENDENT
          key: 'get_domain_health.py[security.amplification_risk,{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Indicates if domain has potential for DNS amplification attacks (1=Risk, 0=Safe)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.vulnerability_scan.amplification_risk.potential_risk
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[security_scan,{$DNS_DOMAIN}]'
          triggers:
            - uuid: c900ce919b694d9180bb17bb42ea742c
              expression: 'last(/Domain Health/get_domain_health.py[security.amplification_risk,{$DNS_DOMAIN}])=1'
              name: 'DNS Amplification Attack Risk on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Domain has large TXT records that could be exploited for DNS amplification attacks (RFC 8482)'
              tags:
                - tag: dns_check
                  value: security
                - tag: rfc
                  value: RFC8482
        - uuid: 6ba1ce4e52db4b82be8c6b63be724a84
          name: 'DNS Zone Transfer Protection'
          type: DEPENDENT
          key: 'get_domain_health.py[security.zone_transfer_protected,{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of nameservers properly protecting against unauthorized zone transfers'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.security_checks.zone_transfer_protection.properly_protected
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[security_scan,{$DNS_DOMAIN}]'
          triggers:
            - uuid: 2ca3dd95a8634a149c66ad1fcea1191d
              expression: 'last(/Domain Health/get_domain_health.py[security.zone_transfer_protected,{$DNS_DOMAIN}])=0'
              name: 'Insecure Zone Transfer Configuration on {$DNS_DOMAIN}'
              priority: AVERAGE
              description: 'One or more nameservers may allow unauthorized zone transfers - potential information disclosure'
              tags:
                - tag: dns_check
                  value: security
        - uuid: 7eb4334ce2604887b2bb295257a9088d
          name: 'DNS Security Analysis'
          type: EXTERNAL
          key: 'get_domain_health.py[security_scan,{$DNS_DOMAIN}]'
          delay: 1h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Comprehensive DNS security analysis including vulnerability scanning and threat detection'
          timeout: 60s
          tags:
            - tag: component
              value: advanced_monitoring
            - tag: dns_check
              value: security
        - uuid: 468476f7410f441eae779e869633900f
          name: 'HTTPS Services Available'
          type: DEPENDENT
          key: 'get_domain_health.py[services.https_available,{$DNS_DOMAIN}]'
          delay: '0'
          history: 7d
          description: 'Indicates if HTTPS services are available for the domain (1=Available, 0=Not Available)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.discovered_services.web.https_available
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[discover_services.master,{$DNS_DOMAIN}]'
        - uuid: 76005f953a3540bda61df9a530086039
          name: 'TLS Services Count'
          type: DEPENDENT
          key: 'get_domain_health.py[services.tls_count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 7d
          description: 'Number of TLS-enabled services discovered for the domain'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.discovered_services.tls.tls_service_count
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[discover_services.master,{$DNS_DOMAIN}]'
        - uuid: 9683a4c7e49c4de6803dba41b8ecbbe3
          name: 'DNS SOA Expire'
          type: DEPENDENT
          key: 'get_domain_health.py[soa.expire,{$DNS_DOMAIN}]'
          delay: '0'
          units: s
          description: 'Expire time (seconds) from SOA record. How long secondary NS should serve zone data without successful refresh.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.soa.expire
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: soa
            - tag: rfc
              value: RFC1035
        - uuid: adb3716d3812476eb2705f5d67eccd00
          name: 'DNS SOA Minimum TTL'
          type: DEPENDENT
          key: 'get_domain_health.py[soa.minimum,{$DNS_DOMAIN}]'
          delay: '0'
          units: s
          description: 'Minimum TTL (seconds) from SOA record. Used for negative caching (NXDOMAIN responses).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.soa.minimum
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: soa
            - tag: rfc
              value: RFC2308
        - uuid: c50b5328402641739be9bbb1b7973bdb
          name: 'DNS SOA Primary NS'
          type: DEPENDENT
          key: 'get_domain_health.py[soa.mname,{$DNS_DOMAIN}]'
          delay: '0'
          value_type: TEXT
          trends: '0'
          description: 'Primary nameserver (MNAME) from SOA record.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.soa.mname
              error_handler: CUSTOM_VALUE
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: soa
            - tag: rfc
              value: RFC1035
        - uuid: cf2d4d03ae7f4a79bbedaac151b1ff46
          name: 'DNS SOA Refresh'
          type: DEPENDENT
          key: 'get_domain_health.py[soa.refresh,{$DNS_DOMAIN}]'
          delay: '0'
          units: s
          description: 'Refresh interval (seconds) from SOA record. How often secondary NS should check for updates.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.soa.refresh
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: soa
            - tag: rfc
              value: RFC1035
        - uuid: 64b4c532d7414c9badc2598499acf230
          name: 'DNS SOA Retry'
          type: DEPENDENT
          key: 'get_domain_health.py[soa.retry,{$DNS_DOMAIN}]'
          delay: '0'
          units: s
          description: 'Retry interval (seconds) from SOA record. How long secondary NS should wait before retrying failed transfer.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.soa.retry
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: soa
            - tag: rfc
              value: RFC1035
        - uuid: 1d3f501f359349e2ac5973d06ca24b5d
          name: 'DNS SOA Contact Email'
          type: DEPENDENT
          key: 'get_domain_health.py[soa.rname,{$DNS_DOMAIN}]'
          delay: '0'
          value_type: TEXT
          trends: '0'
          description: 'Responsible person email (RNAME) from SOA record. Format: admin.example.com = admin@example.com'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.soa.rname
              error_handler: CUSTOM_VALUE
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: soa
            - tag: rfc
              value: RFC1035
        - uuid: bae5f758442c4f36a30eb3b8a3cea94b
          name: 'DNS SOA Serial'
          type: DEPENDENT
          key: 'get_domain_health.py[soa.serial,{$DNS_DOMAIN}]'
          delay: '0'
          description: 'Zone serial number from SOA record. Should increase on each zone update.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.soa.serial
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: soa
            - tag: rfc
              value: RFC1035
        - uuid: 3b40d868cc6e450ab880aa6ad7d8dc96
          name: 'DNS SOA Record Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[soa.valid,{$DNS_DOMAIN}]'
          delay: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.soa.valid
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: soa
            - tag: rfc
              value: RFC1035
          triggers:
            - uuid: 6c611785345546a38a7c5ab9d773271f
              expression: 'last(/Domain Health/get_domain_health.py[soa.valid,{$DNS_DOMAIN}])=0'
              name: 'DNS SOA Record Invalid on {$DNS_DOMAIN}'
              priority: HIGH
              tags:
                - tag: dns_check
                  value: soa
                - tag: rfc
                  value: RFC1035
        - uuid: a8f2d3e5b9c04f1e856d7a2c9b4e1f35
          name: 'Domain Special Use Status'
          type: DEPENDENT
          key: 'get_domain_health.py[special_domain,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if domain uses special-use TLD (RFC 6761) - 1=Special Use, 0=Normal'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.special_domain.is_special_use
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: special_domain
            - tag: rfc
              value: RFC6761
          triggers:
            - uuid: f7e8a9b2c3d14e5f967a8b1c2d3e4f56
              expression: 'last(/Domain Health/get_domain_health.py[special_domain,{$DNS_DOMAIN}])=1'
              name: 'Domain uses Special-Use TLD on {$DNS_DOMAIN}'
              priority: INFO
              description: 'Domain uses a special-use top-level domain (.localhost, .local, .test, .invalid, .example, .onion) which may cause resolution issues'
              tags:
                - tag: dns_check
                  value: special_domain
                - tag: rfc
                  value: RFC6761
        - uuid: ca35b78cc7e14d9395ef56c33f2f0978
          name: 'DNS SPF Error'
          type: DEPENDENT
          key: 'get_domain_health.py[spf.error,{$DNS_DOMAIN}]'
          delay: '0'
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.spf.error
              error_handler: CUSTOM_VALUE
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: spf
            - tag: rfc
              value: RFC7208
        - uuid: 06e9aacda37843739991ae81d4b9f06a
          name: 'DNS SPF Record Valid'
          type: DEPENDENT
          key: 'get_domain_health.py[spf.valid,{$DNS_DOMAIN}]'
          delay: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.checks.spf.valid
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: spf
            - tag: rfc
              value: RFC7208
          triggers:
            - uuid: b67794716b7d477895c23cf915687f0d
              expression: 'last(/Domain Health/get_domain_health.py[spf.valid,{$DNS_DOMAIN}])=0'
              name: 'DNS SPF Record Invalid on {$DNS_DOMAIN}'
              priority: AVERAGE
              tags:
                - tag: dns_check
                  value: spf
                - tag: rfc
                  value: RFC7208
        - uuid: f023072c31574b53ae6ff3a9aee9e408
          name: 'SSHFP Records Data'
          type: EXTERNAL
          key: 'get_domain_health.py[sshfp,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'SSH Fingerprint records (RFC 4255). Publishes SSH host key fingerprints in DNS for verification.'
          tags:
            - tag: dns_check
              value: sshfp
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC4255
        - uuid: 3aae3c24b11349f68b9e8fea3702c27a
          name: 'SSHFP Record Count'
          type: DEPENDENT
          key: 'get_domain_health.py[sshfp.count,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Number of SSHFP records published for domain.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.record_count
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[sshfp,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: sshfp
            - tag: rfc
              value: RFC4255
        - uuid: 02d8f33f7b8d4bf8bcf42cdbac0ebf51
          name: 'TLS-RPT Full Data'
          type: EXTERNAL
          key: 'get_domain_health.py[tls_rpt,{$DNS_DOMAIN}]'
          delay: 1h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'TLS-RPT (RFC 8460) record check. Enables receiving TLS connectivity reports.'
          tags:
            - tag: dns_check
              value: tls_rpt
            - tag: email_security
              value: tls_rpt
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC8460
        - uuid: cbc25295ba334a8e9a665cf1b8872b52
          name: 'TLS-RPT Configured'
          type: DEPENDENT
          key: 'get_domain_health.py[tls_rpt.configured,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          description: 'Indicates if TLS-RPT is configured (1=Yes, 0=No).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.configured
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[tls_rpt,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: tls_rpt
            - tag: integration
              value: dns_health
            - tag: rfc
              value: RFC8460
          triggers:
            - uuid: fbaeac5c39e24b8eb37f6ebf3d8bb80a
              expression: 'last(/Domain Health/get_domain_health.py[tls_rpt.configured,{$DNS_DOMAIN}])=0'
              name: 'TLS-RPT Not Configured on {$DNS_DOMAIN}'
              priority: INFO
              description: 'TLS-RPT (RFC 8460) is not configured. TLS-RPT enables receiving reports about TLS connectivity problems. Consider publishing a _smtp._tls TXT record.'
              tags:
                - tag: dns_check
                  value: tls_rpt
                - tag: email_security
                  value: tls_rpt
                - tag: rfc
                  value: RFC8460
        - uuid: b78c8a29704e4464976e4bf248bdd2fb
          name: 'TLS-RPT Reporting URI'
          type: DEPENDENT
          key: 'get_domain_health.py[tls_rpt.rua,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          value_type: TEXT
          trends: '0'
          description: 'TLS-RPT reporting URI (email address for receiving reports).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.rua
              error_handler: CUSTOM_VALUE
              error_handler_params: '[]'
            - type: JAVASCRIPT
              parameters:
                - 'return JSON.parse(value).join(", ");'
          master_item:
            key: 'get_domain_health.py[tls_rpt,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: tls_rpt
            - tag: integration
              value: dns_health
        - uuid: ba1cc7a863ce461aaac6253f1dffd4ff
          name: 'WHOIS Full Data'
          type: EXTERNAL
          key: 'get_domain_health.py[whois,{$DNS_DOMAIN}]'
          delay: 1d
          history: 30d
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: dns_check
              value: whois
            - tag: integration
              value: dns_health
        - uuid: cb2dd8b974df472bbbd7364a2eaae5ab
          name: 'WHOIS Days Until Expiry'
          type: DEPENDENT
          key: 'get_domain_health.py[whois.days_until_expiry,{$DNS_DOMAIN}]'
          delay: '0'
          history: 90d
          units: d
          description: 'Number of days until domain registration expires. Calculated from WHOIS expiry date.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.days_until_expiry
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[whois,{$DNS_DOMAIN}]'
          tags:
            - tag: dns_check
              value: whois
            - tag: integration
              value: dns_health
          triggers:
            - uuid: 8d6e9f2ab4c34c7e80f1a9e8a7b6c5d4
              expression: 'last(/Domain Health/get_domain_health.py[whois.days_until_expiry,{$DNS_DOMAIN}])>{$DNS_EXPIRY_WARNING} and last(/Domain Health/get_domain_health.py[whois.days_until_expiry,{$DNS_DOMAIN}])<={$DNS_EXPIRY_INFO}'
              name: 'Domain Expiry Notice ({$DNS_EXPIRY_INFO} days) on {$DNS_DOMAIN}'
              priority: INFO
              dependencies:
                - name: 'Domain Expiry Warning ({$DNS_EXPIRY_WARNING} days) on {$DNS_DOMAIN}'
                  expression: 'last(/Domain Health/get_domain_health.py[whois.days_until_expiry,{$DNS_DOMAIN}])>0 and last(/Domain Health/get_domain_health.py[whois.days_until_expiry,{$DNS_DOMAIN}])<={$DNS_EXPIRY_WARNING}'
              tags:
                - tag: dns_check
                  value: whois
            - uuid: 7c5d8e1fa3b24a6db9e0c8d7f6a5b4c3
              expression: 'last(/Domain Health/get_domain_health.py[whois.days_until_expiry,{$DNS_DOMAIN}])>0 and last(/Domain Health/get_domain_health.py[whois.days_until_expiry,{$DNS_DOMAIN}])<={$DNS_EXPIRY_WARNING}'
              name: 'Domain Expiry Warning ({$DNS_EXPIRY_WARNING} days) on {$DNS_DOMAIN}'
              priority: WARNING
              tags:
                - tag: dns_check
                  value: whois
        - uuid: aa0ffc557b1f4c65abc612ef355516cd
          name: 'WHOIS Expiry Date'
          type: EXTERNAL
          key: 'get_domain_health.py[whois_expiry,{$DNS_DOMAIN}]'
          delay: 1d
          history: 30d
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.expiry_date
              error_handler: CUSTOM_VALUE
              error_handler_params: Unknown
          tags:
            - tag: dns_check
              value: whois
            - tag: integration
              value: dns_health
        - uuid: 9d27ba76ee034e0fb6e46f4134613021
          name: 'WHOIS Registrar'
          type: EXTERNAL
          key: 'get_domain_health.py[whois_registrar,{$DNS_DOMAIN}]'
          delay: 1d
          history: 30d
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.registrar
              error_handler: CUSTOM_VALUE
              error_handler_params: Unknown
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: dns_check
              value: whois
            - tag: integration
              value: dns_health
        - uuid: 33721fa6142941d292922889e8427257
          name: 'DNS Geographic Diversity'
          type: DEPENDENT
          key: 'get_domain_health.py[zone.geographic_diversity,{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Indicates if nameservers are geographically diverse (1=Diverse, 0=Not Diverse)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.delegation_analysis.geographic_diversity
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[zone_analysis,{$DNS_DOMAIN}]'
          triggers:
            - uuid: f110b5af04624d5f81e0767e05a32eff
              expression: 'last(/Domain Health/get_domain_health.py[zone.geographic_diversity,{$DNS_DOMAIN}])=0'
              name: 'Poor Nameserver Geographic Diversity on {$DNS_DOMAIN}'
              priority: INFO
              description: 'Nameservers lack geographic diversity - consider distributing across different regions for better resilience'
              tags:
                - tag: dns_check
                  value: zone_analysis
        - uuid: 3091fb43a7844cddbd0614d4ed03dceb
          name: 'DNS Zone Serial Consistency'
          type: DEPENDENT
          key: 'get_domain_health.py[zone.serial_consistency,{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Indicates if SOA serial numbers are consistent across nameservers (1=Consistent, 0=Inconsistent)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.zone_structure.serial_consistency.consistent
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: BOOL_TO_DECIMAL
              parameters:
                - ''
          master_item:
            key: 'get_domain_health.py[zone_analysis,{$DNS_DOMAIN}]'
          triggers:
            - uuid: 0ff66929cb7d42e2b6fb2b925d55b9b3
              expression: 'last(/Domain Health/get_domain_health.py[zone.serial_consistency,{$DNS_DOMAIN}])=0'
              name: 'Inconsistent Zone Serial Numbers on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'SOA serial numbers differ across nameservers - indicates zone propagation issues'
              tags:
                - tag: dns_check
                  value: zone_analysis
        - uuid: 29624210674443599c2ec5b16b8160da
          name: 'DNS Zone Analysis'
          type: EXTERNAL
          key: 'get_domain_health.py[zone_analysis,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Comprehensive DNS zone analysis including delegation, authority chain, and SOA validation'
          timeout: 45s
          tags:
            - tag: component
              value: advanced_monitoring
            - tag: dns_check
              value: zone_analysis
        
        # Additional Script Capabilities for 100% Alignment
        
        # Certificate Monitoring
        - uuid: d9558958b9f04d14a46de2e09231e886
          name: 'Certificate Analysis'
          type: EXTERNAL
          key: 'get_domain_health.py[certificate,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'SSL/TLS certificate analysis and validation'
          timeout: 45s
          tags:
            - tag: component
              value: security
            - tag: dns_check
              value: certificate
        
        # Service Discovery Master Items
        - uuid: 6d5c33862b4d4b338714b20a450e26a4
          name: 'Service Discovery Master'
          type: EXTERNAL
          key: 'get_domain_health.py[discover.master,{$DNS_DOMAIN}]'
          delay: 1h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Master item for comprehensive service discovery'
          timeout: 90s
          tags:
            - tag: component
              value: service_discovery
            - tag: dns_check
              value: discover_master
        
        # DANE Discovery
        - uuid: 7d7e4deb2ab7454d865f028dccf2a2e5
          name: 'DANE Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_dane,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'DANE record discovery for TLSA validation'
          timeout: 45s
          tags:
            - tag: component
              value: security
            - tag: dns_check
              value: discover_dane
        
        # MX Discovery
        - uuid: 104641132c89497ab11f3b4e4b4c0fae
          name: 'MX Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_mx,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'MX record discovery with priority analysis'
          timeout: 30s
          tags:
            - tag: component
              value: email_infrastructure
            - tag: dns_check
              value: discover_mx
        
        # Nameserver Discovery Master
        - uuid: 6f1e3ea1ecea44118490b8ad38b628b6
          name: 'Nameserver Discovery Master'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_ns.master,{$DNS_DOMAIN}]'
          delay: 1d
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Master item for nameserver discovery and analysis'
          timeout: 60s
          tags:
            - tag: component
              value: dns_infrastructure
            - tag: dns_check
              value: discover_ns_master
        
        # Full Service Discovery
        - uuid: 2b9ab3cca2fe4a0d9eb7b3535770bc4a
          name: 'Full Service Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_services.full,{$DNS_DOMAIN}]'
          delay: 1d
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Full comprehensive service discovery (extensive)'
          timeout: 300s
          tags:
            - tag: component
              value: comprehensive_monitoring
            - tag: dns_check
              value: discover_services_full
        
        # Service Discovery LLD
        - uuid: 259ae5eb38994a289c57b6bc9ce95770
          name: 'Service Discovery LLD'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_services.lld,{$DNS_DOMAIN}]'
          delay: 6h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Service discovery data for Low-Level Discovery'
          timeout: 90s
          tags:
            - tag: component
              value: service_discovery
            - tag: dns_check
              value: discover_services_lld
        
        # Basic Zone Discovery
        - uuid: 01c122c72e4b45189901fad4122acf76
          name: 'Basic Zone Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_zone,{$DNS_DOMAIN}]'
          delay: 1d
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Basic DNS zone discovery for all record types'
          timeout: 60s
          tags:
            - tag: component
              value: dns_monitoring
            - tag: dns_check
              value: discover_zone
        
        # DNS Error Analysis
        - uuid: ec4c3d4552db429098e52fc6019b1da5
          name: 'DNS Error Analysis'
          type: EXTERNAL
          key: 'get_domain_health.py[dns_errors,{$DNS_DOMAIN}]'
          delay: 1h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Comprehensive DNS error analysis and troubleshooting'
          timeout: 45s
          tags:
            - tag: component
              value: troubleshooting
            - tag: dns_check
              value: dns_errors
        
        # DNSBL MX Check
        - uuid: 4d297cba512346b1b427f00ac7132709
          name: 'DNSBL MX Check'
          type: EXTERNAL
          key: 'get_domain_health.py[dnsbl_mx,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'DNSBL checking for MX record IP addresses'
          timeout: 45s
          tags:
            - tag: component
              value: email_security
            - tag: dns_check
              value: dnsbl_mx
        
        # Error Reporting
        - uuid: 93466cbf6b264537a976ec72ff92eef5
          name: 'Error Reporting'
          type: EXTERNAL
          key: 'get_domain_health.py[error_reporting,{$DNS_DOMAIN}]'
          delay: 30m
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Comprehensive error reporting and troubleshooting'
          timeout: 30s
          tags:
            - tag: component
              value: troubleshooting
            - tag: dns_check
              value: error_reporting
        
        # OpenPGP Key Records
        - uuid: 0b7d13bd59e1419592ad64124c654e14
          name: 'OpenPGP Key Records'
          type: EXTERNAL
          key: 'get_domain_health.py[openpgpkey,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'OpenPGP public key records for email encryption'
          timeout: 30s
          tags:
            - tag: component
              value: email_security
            - tag: dns_check
              value: openpgpkey
        
        # Script Self-Test
        - uuid: d61afd5f929e41d2aec06418d37a6424
          name: 'Script Self-Test'
          type: EXTERNAL
          key: 'get_domain_health.py[selftest,{$DNS_DOMAIN}]'
          delay: 1d
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Self-test validation of script functionality'
          timeout: 30s
          tags:
            - tag: component
              value: validation
            - tag: dns_check
              value: selftest
        
        # S/MIME Certificate Records
        - uuid: 207b3c3830004f6e990a8cd8552bef6c
          name: 'S/MIME Certificate Records'
          type: EXTERNAL
          key: 'get_domain_health.py[smimea,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'S/MIME certificate records for email security'
          timeout: 30s
          tags:
            - tag: component
              value: email_security
            - tag: dns_check
              value: smimea
        
        # Special Domain Analysis
        - uuid: 33be26dc12d74d5b96b9c00daefae808
          name: 'Special Domain Analysis'
          type: EXTERNAL
          key: 'get_domain_health.py[special,{$DNS_DOMAIN}]'
          delay: 1d
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Special domain type analysis (reserved, private, etc.)'
          timeout: 30s
          tags:
            - tag: component
              value: domain_classification
            - tag: dns_check
              value: special
        
        # Enhanced SRV Service Status
        - uuid: 0b406ac46d714b84aa1e644aaa32ea45
          name: 'SRV Service Status'
          type: EXTERNAL
          key: 'get_domain_health.py[srv.service_status,{$DNS_DOMAIN}]'
          delay: 15m
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Enhanced SRV service status with connectivity testing'
          timeout: 60s
          tags:
            - tag: component
              value: service_monitoring
            - tag: dns_check
              value: srv_service_status
        
        # TLS Integration Testing
        - uuid: 85f941bb1b7c4038a387f456dce854a2
          name: 'TLS Integration Testing'
          type: EXTERNAL
          key: 'get_domain_health.py[tls_integration,{$DNS_DOMAIN}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Advanced TLS integration testing and protocol validation'
          timeout: 60s
          tags:
            - tag: component
              value: security
            - tag: dns_check
              value: tls_integration
        
      discovery_rules:
        - uuid: d6920d8abfc94c1ab160dca0fd20f597
          name: 'DNS Zone Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[discover,{$DNS_DOMAIN}]'
          delay: 1d
          filter:
            conditions:
              - macro: '{#RECORD_TYPE}'
                value: .+
                formulaid: A
          item_prototypes:
            - uuid: b4d1109b44d84fb5b8b26514e0231737
              name: 'DNS {#RECORD_TYPE} Records Count'
              type: EXTERNAL
              key: 'get_domain_health.py[records,{$DNS_DOMAIN},{#RECORD_TYPE}]'
              delay: 1h
              history: 30d
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.count
              tags:
                - tag: dns_record_type
                  value: '{#RECORD_TYPE}'
                - tag: integration
                  value: dns_health
            - uuid: bd253db2173a46aba05e5a26bee0cc91
              name: 'DNS {#RECORD_TYPE} Records Data'
              type: DEPENDENT
              key: 'get_domain_health.py[records.data,{$DNS_DOMAIN},{#RECORD_TYPE}]'
              delay: '0'
              history: 30d
              value_type: TEXT
              trends: '0'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.records
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'No records found'
              master_item:
                key: 'get_domain_health.py[records,{$DNS_DOMAIN},{#RECORD_TYPE}]'
              tags:
                - tag: dns_record_type
                  value: '{#RECORD_TYPE}'
                - tag: integration
                  value: dns_health
          graph_prototypes:
            - uuid: 10c587e23e8c40afb5c2403753def568
              name: 'DNS {#RECORD_TYPE} Record Count'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Domain Health'
                    key: 'get_domain_health.py[records,{$DNS_DOMAIN},{#RECORD_TYPE}]'
        - uuid: e7a31f9bcfa04d2ba271ecb1af00e3cd
          name: 'DNS Namespace Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_ns,{$DNS_DOMAIN}]'
          delay: 1h
          filter:
            conditions:
              - macro: '{#NS_SERVER}'
                value: .+
                formulaid: A
          description: 'Discovers all authoritative nameservers for the domain and monitors their availability and latency.'
          item_prototypes:
            - uuid: a9c53bbdeb124f4d8493aed3cb22a5ef
              name: 'NS Server {#NS_SERVER} Available'
              type: DEPENDENT
              key: 'get_domain_health.py[ns.available,{$DNS_DOMAIN},{#NS_SERVER}]'
              delay: '0'
              history: 30d
              description: 'Availability status of NS server {#NS_SERVER}. 1=Available, 0=Unavailable'
              valuemap:
                name: 'DNS Check Status'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.available
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
              master_item:
                key: 'get_domain_health.py[ns_check,{$DNS_DOMAIN},{#NS_SERVER}]'
              tags:
                - tag: integration
                  value: dns_health
                - tag: ns_server
                  value: '{#NS_SERVER}'
              trigger_prototypes:
                - uuid: cbe75ddfac344b6e86b5caf5ed44c7ab
                  expression: 'last(/Domain Health/get_domain_health.py[ns.available,{$DNS_DOMAIN},{#NS_SERVER}])=0'
                  name: 'NS Server {#NS_SERVER} Unavailable on {$DNS_DOMAIN}'
                  priority: AVERAGE
                  description: 'Nameserver {#NS_SERVER} is not responding to DNS queries.'
                  manual_close: 'YES'
                  tags:
                    - tag: dns_check
                      value: ns_availability
                    - tag: ns_server
                      value: '{#NS_SERVER}'
            - uuid: bac64ccefb234a5e85a4bfe4dc33b6fa
              name: 'NS Server {#NS_SERVER} Latency'
              type: DEPENDENT
              key: 'get_domain_health.py[ns.latency,{$DNS_DOMAIN},{#NS_SERVER}]'
              delay: '0'
              history: 30d
              value_type: FLOAT
              units: ms
              description: 'DNS query latency to NS server {#NS_SERVER} in milliseconds'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - $.latency_ms
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '-1'
              master_item:
                key: 'get_domain_health.py[ns_check,{$DNS_DOMAIN},{#NS_SERVER}]'
              tags:
                - tag: integration
                  value: dns_health
                - tag: ns_server
                  value: '{#NS_SERVER}'
              trigger_prototypes:
                - uuid: dce86eea0d454c7f87c6dba6fe55d8bc
                  expression: 'last(/Domain Health/get_domain_health.py[ns.latency,{$DNS_DOMAIN},{#NS_SERVER}])>{$DNS_NS_LATENCY_WARNING}'
                  name: 'NS Server {#NS_SERVER} High Latency on {$DNS_DOMAIN}'
                  priority: WARNING
                  description: 'Nameserver {#NS_SERVER} latency exceeds {$DNS_NS_LATENCY_WARNING}ms threshold.'
                  dependencies:
                    - name: 'NS Server {#NS_SERVER} Unavailable on {$DNS_DOMAIN}'
                      expression: 'last(/Domain Health/get_domain_health.py[ns.available,{$DNS_DOMAIN},{#NS_SERVER}])=0'
                  manual_close: 'YES'
                  tags:
                    - tag: dns_check
                      value: ns_latency
                    - tag: ns_server
                      value: '{#NS_SERVER}'
            - uuid: f8b42aacda014e3c8382fdc2ba11f4de
              name: 'NS Server {#NS_SERVER} Check'
              type: EXTERNAL
              key: 'get_domain_health.py[ns_check,{$DNS_DOMAIN},{#NS_SERVER}]'
              delay: 5m
              history: 30d
              value_type: TEXT
              trends: '0'
              description: 'Full check data for NS server {#NS_SERVER}'
              tags:
                - tag: integration
                  value: dns_health
                - tag: ns_server
                  value: '{#NS_SERVER}'
          graph_prototypes:
            - uuid: edf97ffb1e564d8a88d7ecb7af66e9cd
              name: 'NS Server {#NS_SERVER} Latency'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Domain Health'
                    key: 'get_domain_health.py[ns.latency,{$DNS_DOMAIN},{#NS_SERVER}]'
        - uuid: 2ef793c27cb24e0ca542b0af03426f64
          name: 'SRV Services Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_services,{$DNS_DOMAIN}]'
          delay: 24h
          lifetime: 14d
          item_prototypes:
            - uuid: 91f20bb1899540f1a00839d29be07bdf
              name: 'SRV Service {#SERVICE} Status'
              type: EXTERNAL
              key: 'get_domain_health.py[srv.service_status,{$DNS_DOMAIN},{#SERVICE}]'
              delay: 5m
              history: 30d
              description: 'SRV service availability status for {#SERVICE}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.records[0]'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: unavailable
              tags:
                - tag: service
                  value: srv
                - tag: service_type
                  value: '{#SERVICE}'
        - uuid: a8f3e2c549d847a1b6e4f7c8d9a1b2c3
          name: 'Subdomain Infrastructure Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[discover_subdomains.lld,{$DNS_DOMAIN}]'
          delay: 12h
          lifetime: 30d
          description: 'Phase 1: Enhanced subdomain discovery with categorization for comprehensive infrastructure mapping'
          filter:
            conditions:
              - macro: '{#SUBDOMAIN}'
                value: .+
                formulaid: A
          item_prototypes:
            - uuid: b7e4c9a2f1d64e2a8c5b9f9e7d1a4b6c
              name: 'Subdomain {#SUBDOMAIN} Service Category'
              type: DEPENDENT
              key: 'subdomain.category[{#SUBDOMAIN},{$DNS_DOMAIN}]'
              delay: '0'
              history: 7d
              value_type: CHAR
              trends: '0'
              description: 'Service category classification for subdomain {#SUBDOMAIN}'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.subdomain_discovery.subdomain_services.{#SUBDOMAIN}.service_category'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'unknown'
              master_item:
                key: 'get_domain_health.py[discover_subdomains.master,{$DNS_DOMAIN}]'
              tags:
                - tag: subdomain
                  value: '{#SUBDOMAIN}'
                - tag: category
                  value: '{#CATEGORY}'
                - tag: integration
                  value: subdomain_discovery
            - uuid: c8f5d0b3e2a74f3a9d6c4e7b8a2c9d9f
              name: 'Subdomain {#SUBDOMAIN} Web Accessible'
              type: DEPENDENT
              key: 'subdomain.web_accessible[{#SUBDOMAIN},{$DNS_DOMAIN}]'
              delay: '0'
              history: 30d
              value_type: UNSIGNED
              description: 'Web accessibility status for subdomain {#SUBDOMAIN} (0=not accessible, 1=accessible)'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.subdomain_discovery.subdomain_services.{#SUBDOMAIN}.web_accessible'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'get_domain_health.py[discover_subdomains.master,{$DNS_DOMAIN}]'
              tags:
                - tag: subdomain
                  value: '{#SUBDOMAIN}'
                - tag: category
                  value: '{#CATEGORY}'
                - tag: integration
                  value: subdomain_discovery
              trigger_prototypes:
                - uuid: d9e6a1c4f7b84e2a9f6d9c8b7a4e2f1d
                  expression: 'last(/Domain Health/subdomain.web_accessible[{#SUBDOMAIN},{$DNS_DOMAIN}])=1 and prev(/Domain Health/subdomain.web_accessible[{#SUBDOMAIN},{$DNS_DOMAIN}])=0'
                  name: 'New Web Service Discovered: {#SUBDOMAIN}.{$DNS_DOMAIN}'
                  priority: INFO
                  description: 'A new web-accessible subdomain service has been discovered: {#SUBDOMAIN}.{$DNS_DOMAIN}'
                  manual_close: 'YES'
                  tags:
                    - tag: subdomain_discovery
                      value: new_service
                    - tag: subdomain
                      value: '{#SUBDOMAIN}'
                    - tag: category
                      value: '{#CATEGORY}'
            - uuid: e0f7b2d5c3a64e4a8f7c9b9e2a6d3c8f
              name: 'Subdomain {#SUBDOMAIN} SSL Available'
              type: DEPENDENT
              key: 'subdomain.ssl_available[{#SUBDOMAIN},{$DNS_DOMAIN}]'
              delay: '0'
              history: 30d
              value_type: UNSIGNED
              description: 'SSL/TLS availability for subdomain {#SUBDOMAIN} (0=no SSL, 1=SSL available)'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.subdomain_discovery.subdomain_services.{#SUBDOMAIN}.ssl_available'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: '0'
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'get_domain_health.py[discover_subdomains.master,{$DNS_DOMAIN}]'
              tags:
                - tag: subdomain
                  value: '{#SUBDOMAIN}'
                - tag: category
                  value: '{#CATEGORY}'
                - tag: integration
                  value: subdomain_discovery
          graph_prototypes:
            - uuid: f1e8c3b6a4d94f7a9e9d6c7b8a3f4e1c
              name: 'Subdomain {#SUBDOMAIN} Availability'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Domain Health'
                    key: 'subdomain.web_accessible[{#SUBDOMAIN},{$DNS_DOMAIN}]'
                - color: C80000
                  calc_fnc: ALL
                  item:
                    host: 'Domain Health'
                    key: 'subdomain.ssl_available[{#SUBDOMAIN},{$DNS_DOMAIN}]'
                - tag: service_type
                  value: '{#SERVICE}'
        
        # ================================================================================================
        # Phase 5: Web Application Analysis Items
        # ================================================================================================
        
        - uuid: ad5db2c0a00840afb358f2f95ef3a9d8
          name: 'Web Applications Discovery'
          type: EXTERNAL
          key: 'get_domain_health.py[web_discover,{$DNS_DOMAIN}]'
          delay: 8h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Discovery of web applications running on the domain'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.total_applications'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          tags:
            - tag: component
              value: web_analysis
            - tag: phase
              value: '5'
            - tag: discovery
              value: web_applications

        - uuid: b615be1c2358465495a0f8ce4f4f7961
          name: 'Web Security Grade'
          type: EXTERNAL
          key: 'get_domain_health.py[web_security,{$DNS_DOMAIN},{$WEB_PORTS}]'
          delay: 6h
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Overall web application security grade (A+ to F)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.web_security_grade'
              error_handler: CUSTOM_VALUE
              error_handler_params: 'F'
          tags:
            - tag: component
              value: web_analysis
            - tag: phase
              value: '5'
            - tag: security
              value: web_grade
          triggers:
            - uuid: ce32091f8a354735b05032baf17ef0ed
              expression: 'last(/Domain Health/get_domain_health.py[web_security,{$DNS_DOMAIN},{$WEB_PORTS}])="F" or last(/Domain Health/get_domain_health.py[web_security,{$DNS_DOMAIN},{$WEB_PORTS}])="D-" or last(/Domain Health/get_domain_health.py[web_security,{$DNS_DOMAIN},{$WEB_PORTS}])="D" or last(/Domain Health/get_domain_health.py[web_security,{$DNS_DOMAIN},{$WEB_PORTS}])="D+"'
              name: 'Poor Web Security Grade on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Web application security grade is critically low (D+ or worse)'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: web_security_poor

        - uuid: 1144485e88724adf8b941843d89eac4f
          name: 'Web Security Score'
          type: EXTERNAL
          key: 'get_domain_health.py[web_security,{$DNS_DOMAIN},{$WEB_PORTS}]'
          delay: 6h
          history: 30d
          value_type: FLOAT
          description: 'Web application security score (0-100)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.security_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          tags:
            - tag: component
              value: web_analysis
            - tag: phase
              value: '5'
            - tag: security
              value: web_score
          triggers:
            - uuid: bf820970982c48c9ab074c5712b3b5c6
              expression: 'last(/Domain Health/get_domain_health.py[web_security,{$DNS_DOMAIN},{$WEB_PORTS}])<{$WEB_SECURITY_SCORE_THRESHOLD}'
              name: 'Low Web Security Score on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Web application security score is below acceptable threshold'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: web_security_low

        - uuid: 1135811fe32f413c86a3b4cc872ce3f5
          name: 'Web Vulnerabilities Count'
          type: EXTERNAL
          key: 'get_domain_health.py[web_security,{$DNS_DOMAIN},{$WEB_PORTS}]'
          delay: 6h
          history: 30d
          value_type: FLOAT
          description: 'Total number of web application vulnerabilities detected'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.total_vulnerabilities'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          tags:
            - tag: component
              value: web_analysis
            - tag: phase
              value: '5'
            - tag: vulnerability
              value: web_vulns
          triggers:
            - uuid: d08086727c434a77be89750174b517ab
              expression: 'last(/Domain Health/get_domain_health.py[web_security,{$DNS_DOMAIN},{$WEB_PORTS}])>{$WEB_VULNERABILITIES_THRESHOLD}'
              name: 'High Number of Web Vulnerabilities on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Detected high number of web application vulnerabilities'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: web_vulnerabilities_high

        - uuid: 4e4030a247f444708b680a77547a6871
          name: 'Web Technology Stack'
          type: EXTERNAL
          key: 'get_domain_health.py[web_tech,{$DNS_DOMAIN},443]'
          delay: 12h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Detected web technologies, frameworks, and server information'
          tags:
            - tag: component
              value: web_analysis
            - tag: phase
              value: '5'
            - tag: discovery
              value: technology_stack

        - uuid: 0cba3643f5ea45b28acc5f87f42f0ace
          name: 'Web Security Headers'
          type: EXTERNAL
          key: 'get_domain_health.py[web_headers,{$DNS_DOMAIN},443]'
          delay: 6h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Analysis of HTTP security headers (HSTS, CSP, X-Frame-Options, etc.)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.security_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          tags:
            - tag: component
              value: web_analysis
            - tag: phase
              value: '5'
            - tag: security
              value: headers
          triggers:
            - uuid: c151c30c40244ee1b81baa236b39b5f2
              expression: 'last(/Domain Health/get_domain_health.py[web_headers,{$DNS_DOMAIN},443])<{$WEB_HEADERS_SCORE_THRESHOLD}'
              name: 'Poor Security Headers Configuration on {$DNS_DOMAIN}'
              priority: AVERAGE
              description: 'Security headers configuration is inadequate'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: security_headers_poor

        - uuid: 7bb2aea6fe584cd7b529dd836b03e6fe
          name: 'Web Vulnerability Details'
          type: EXTERNAL
          key: 'get_domain_health.py[web_vulnerabilities,{$DNS_DOMAIN},443]'
          delay: 6h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Detailed web application vulnerability scan results'
          tags:
            - tag: component
              value: web_analysis
            - tag: phase
              value: '5'
            - tag: vulnerability
              value: detailed_scan

        - uuid: 8160258dc04d477ea79ba7e2980aff57
          name: 'Web Application Count'
          type: DEPENDENT
          key: 'web.applications_count[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of web applications discovered on the domain'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.total_applications'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[web_discover,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: web_analysis
            - tag: phase
              value: '5'
            - tag: metric_type
              value: application_count

        - uuid: a31e0cd634234ba5b802b4eeb208f204
          name: 'Web CMS Detection'
          type: DEPENDENT
          key: 'web.cms_detected[{$DNS_DOMAIN}]'
          delay: '0'
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Content Management System (CMS) detection results'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.web_applications_discovered'
              error_handler: CUSTOM_VALUE
              error_handler_params: 'unknown'
          master_item:
            key: 'get_domain_health.py[web_discover,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: web_analysis
            - tag: phase
              value: '5'
            - tag: discovery
              value: cms_detection

        # Phase 6: Advanced Network Analysis Items
        - uuid: 17eeff4be346431da4bc215c85e79e6f
          name: 'Network Topology Analysis'
          type: EXTERNAL
          key: 'get_domain_health.py[network_topology,{$DNS_DOMAIN}]'
          delay: 12h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Network topology discovery and routing path analysis'
          tags:
            - tag: component
              value: network_analysis
            - tag: phase
              value: '6'
            - tag: topology
              value: discovery

        - uuid: 780bc0b0e5c048cca83e7dc324dd3364
          name: 'Network Security Score'
          type: DEPENDENT
          key: 'network.security_score[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Network security assessment score (0-100)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.security_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[network_security,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: network_analysis
            - tag: phase
              value: '6'
            - tag: security
              value: score
          triggers:
            - uuid: 5cbdbd23a23a4af0b50ededf4dcd06d2
              expression: 'last(/Domain Health/network.security_score[{$DNS_DOMAIN}])<{$NETWORK_SECURITY_THRESHOLD}'
              name: 'Low Network Security Score on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Network security score is below acceptable threshold. Review network security configuration.'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: network_security_low

        - uuid: 8475b98dab7f4d8d9e37e88e9aea1ec9
          name: 'Network Performance Score'
          type: DEPENDENT
          key: 'network.performance_score[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Network performance assessment score (0-100)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.performance_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[network_performance,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: network_analysis
            - tag: phase
              value: '6'
            - tag: performance
              value: score
          triggers:
            - uuid: 9844a241a2fd4482b33cef5632296d9e
              expression: 'last(/Domain Health/network.performance_score[{$DNS_DOMAIN}])<{$NETWORK_PERFORMANCE_THRESHOLD}'
              name: 'Poor Network Performance on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Network performance score indicates potential issues. Check latency, jitter, and packet loss.'
              manual_close: 'YES'
              tags:
                - tag: performance_issue
                  value: network_performance_poor

        - uuid: 7ac7a118678c482b925274fa02af97f8
          name: 'Network Devices Discovered'
          type: DEPENDENT
          key: 'network.devices_count[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of network devices discovered in topology analysis'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.total_devices'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[network_devices,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: network_analysis
            - tag: phase
              value: '6'
            - tag: discovery
              value: device_count

        - uuid: e49ecb7476274c0ab1d205bb7c7b8e3f
          name: 'Network Compliance Score'
          type: DEPENDENT
          key: 'network.compliance_score[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Network compliance assessment score across security frameworks'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.overall_compliance_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[network_compliance,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: network_analysis
            - tag: phase
              value: '6'
            - tag: compliance
              value: score
          triggers:
            - uuid: be4c4c37ad454d64ab248677125dcca6
              expression: 'last(/Domain Health/network.compliance_score[{$DNS_DOMAIN}])<{$NETWORK_COMPLIANCE_THRESHOLD}'
              name: 'Network Compliance Issues on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Network compliance score indicates regulatory/security framework violations.'
              manual_close: 'YES'
              tags:
                - tag: compliance_issue
                  value: network_compliance_low

        - uuid: 9d7765bf7f954ddb84f12d2478a7c2fe
          name: 'Network Vulnerabilities Count'
          type: DEPENDENT
          key: 'network.vulnerabilities_count[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of network vulnerabilities identified'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.vulnerabilities_count'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[network_security,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: network_analysis
            - tag: phase
              value: '6'
            - tag: vulnerability
              value: count
          triggers:
            - uuid: af5964e33d0c477eafefcf05cbc2f56d
              expression: 'last(/Domain Health/network.vulnerabilities_count[{$DNS_DOMAIN}])>{$NETWORK_VULNERABILITIES_THRESHOLD}'
              name: 'Network Vulnerabilities Detected on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Multiple network vulnerabilities detected. Review network security configuration immediately.'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: network_vulnerabilities_high

        - uuid: 045c866522e0486d8e101e41f72cf544
          name: 'Network Risk Level'
          type: DEPENDENT
          key: 'network.risk_level[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          value_type: TEXT
          trends: '0'
          description: 'Network security risk level assessment'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.risk_level'
              error_handler: CUSTOM_VALUE
              error_handler_params: 'UNKNOWN'
          master_item:
            key: 'get_domain_health.py[network_security,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: network_analysis
            - tag: phase
              value: '6'
            - tag: security
              value: risk_level
          triggers:
            - uuid: 531b65d8dacd483ebdf0b1416a7c133d
              expression: 'find(/Domain Health/network.risk_level[{$DNS_DOMAIN}],,"regexp","^(CRITICAL|HIGH)$")=1'
              name: 'High Network Security Risk on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Network security risk level is CRITICAL or HIGH. Immediate action required.'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: network_risk_high

        - uuid: b8e236450fae47269ab943c4876bbeaa
          name: 'Network Latency Analysis'
          type: DEPENDENT
          key: 'network.latency_average[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          units: 'ms'
          description: 'Average network latency per hop in routing path'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.avg_latency_per_hop'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[network_performance,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: network_analysis
            - tag: phase
              value: '6'
            - tag: performance
              value: latency
          triggers:
            - uuid: f6ec265de2d043f0965191e2ca0a2835
              expression: 'last(/Domain Health/network.latency_average[{$DNS_DOMAIN}])>{$NETWORK_LATENCY_THRESHOLD}'
              name: 'High Network Latency on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Network latency is above acceptable threshold. Performance may be impacted.'
              manual_close: 'YES'
              tags:
                - tag: performance_issue
                  value: network_latency_high

        - uuid: 37512d777b9a401f8798948e52c24585
          name: 'Network Analysis Report'
          type: EXTERNAL
          key: 'get_domain_health.py[network_analysis,{$DNS_DOMAIN}]'
          delay: 12h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Complete network analysis report including topology, security, and performance'
          tags:
            - tag: component
              value: network_analysis
            - tag: phase
              value: '6'
            - tag: report
              value: comprehensive

        # Phase 7: Threat Intelligence & Risk Assessment Items
        - uuid: 4b53f1d43d264d3fb0a0818b5e07106d
          name: 'Threat Intelligence Analysis'
          type: EXTERNAL
          key: 'get_domain_health.py[threat_intelligence,{$DNS_DOMAIN}]'
          delay: 6h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Comprehensive threat intelligence analysis including reputation and malware indicators'
          tags:
            - tag: component
              value: threat_intelligence
            - tag: phase
              value: '7'
            - tag: analysis
              value: comprehensive

        - uuid: 2e928a41b2eb4fda8eb45f995642fa2e
          name: 'Domain Reputation Score'
          type: DEPENDENT
          key: 'threat.domain_reputation[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Domain reputation score based on threat intelligence feeds (0-100)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.domain_reputation.reputation_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '50'
          master_item:
            key: 'get_domain_health.py[threat_reputation,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: threat_intelligence
            - tag: phase
              value: '7'
            - tag: reputation
              value: domain_score
          triggers:
            - uuid: 5ffd1c1bd1db4073bce9a0695c4eef54
              expression: 'last(/Domain Health/threat.domain_reputation[{$DNS_DOMAIN}])<{$THREAT_REPUTATION_THRESHOLD}'
              name: 'Poor Domain Reputation on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Domain reputation score is below acceptable threshold, indicating potential security risk.'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: domain_reputation_poor

        - uuid: 3d766868584f4c6a956b006c8ac3753d
          name: 'Malware Detection Status'
          type: DEPENDENT
          key: 'threat.malware_detected[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          value_type: UNSIGNED
          description: 'Malware detection status (0=clean, 1=malware detected)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.malware_detected'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: BOOL_TO_DECIMAL
              parameters: []
          master_item:
            key: 'get_domain_health.py[malware_analysis,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: threat_intelligence
            - tag: phase
              value: '7'
            - tag: malware
              value: detection_status
          triggers:
            - uuid: c63e805b893e4c2283be0b06f9ece001
              expression: 'last(/Domain Health/threat.malware_detected[{$DNS_DOMAIN}])=1'
              name: 'Malware Detected on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Malware indicators have been detected for this domain. Immediate investigation required.'
              manual_close: 'YES'
              tags:
                - tag: security_incident
                  value: malware_detected

        - uuid: 87298d413d7e49329dc1ec90136ae18d
          name: 'Threat Intelligence Score'
          type: DEPENDENT
          key: 'threat.intelligence_score[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Overall threat intelligence score combining multiple indicators (0-100)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.threat_intelligence_analysis.overall_threat_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[threat_intelligence,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: threat_intelligence
            - tag: phase
              value: '7'
            - tag: threat
              value: overall_score
          triggers:
            - uuid: 948aa1728c504832900aef148f96b2bb
              expression: 'last(/Domain Health/threat.intelligence_score[{$DNS_DOMAIN}])>{$THREAT_INTELLIGENCE_THRESHOLD}'
              name: 'High Threat Intelligence Score on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Domain has elevated threat intelligence score indicating potential security risks.'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: threat_intelligence_high

        - uuid: b33217e19e904453b2b0a5eebd5cf12b
          name: 'Risk Assessment Score'
          type: DEPENDENT
          key: 'risk.assessment_score[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Comprehensive risk assessment score across all analysis phases (0-100)'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.risk_assessment.overall_risk_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[risk_assessment,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: risk_assessment
            - tag: phase
              value: '7'
            - tag: risk
              value: overall_score
          triggers:
            - uuid: c6cbfcc6918047b585d8e6cda78a5ed7
              expression: 'last(/Domain Health/risk.assessment_score[{$DNS_DOMAIN}])>{$RISK_ASSESSMENT_THRESHOLD}'
              name: 'High Risk Assessment Score on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Domain has high overall risk score requiring immediate attention.'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: risk_assessment_high

        - uuid: 6bd3650673174233a81914334be3fb4b
          name: 'Threat Actors Identified'
          type: DEPENDENT
          key: 'threat.actors_count[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of potential threat actors identified'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.threat_actors.actors_identified'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[threat_intelligence,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: threat_intelligence
            - tag: phase
              value: '7'
            - tag: threat
              value: actors_count
          triggers:
            - uuid: b7606772891a4732a85d94e1dc9fb221
              expression: 'last(/Domain Health/threat.actors_count[{$DNS_DOMAIN}])>{$THREAT_ACTORS_THRESHOLD}'
              name: 'Threat Actors Detected on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Multiple threat actors have been identified targeting this domain.'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: threat_actors_detected

        - uuid: 38733b303a7542ab8f653ad784aeb940
          name: 'Attack Surface Score'
          type: DEPENDENT
          key: 'attack.surface_score[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Attack surface analysis score indicating exposure level'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.attack_surface.exposure_score'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[threat_intelligence,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: threat_intelligence
            - tag: phase
              value: '7'
            - tag: attack_surface
              value: exposure_score
          triggers:
            - uuid: 6e4685e40ee8499cb57211d4c0d20cfd
              expression: 'last(/Domain Health/attack.surface_score[{$DNS_DOMAIN}])>{$ATTACK_SURFACE_THRESHOLD}'
              name: 'High Attack Surface on {$DNS_DOMAIN}'
              priority: WARNING
              description: 'Domain has large attack surface with multiple exposure points.'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: attack_surface_high

        - uuid: b95b220ecd554411aa279b768d468137
          name: 'Vulnerability Correlation Count'
          type: DEPENDENT
          key: 'vuln.correlation_count[{$DNS_DOMAIN}]'
          delay: '0'
          history: 30d
          description: 'Number of correlated vulnerabilities across all analysis phases'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.vulnerability_correlation.total_correlated'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
          master_item:
            key: 'get_domain_health.py[threat_intelligence,{$DNS_DOMAIN}]'
          tags:
            - tag: component
              value: vulnerability_correlation
            - tag: phase
              value: '7'
            - tag: vulnerability
              value: correlation_count
          triggers:
            - uuid: ffcd8e9aeaf949cd87e7b27642d171bb
              expression: 'last(/Domain Health/vuln.correlation_count[{$DNS_DOMAIN}])>{$VULN_CORRELATION_THRESHOLD}'
              name: 'High Vulnerability Correlation on {$DNS_DOMAIN}'
              priority: HIGH
              description: 'Multiple correlated vulnerabilities detected across infrastructure components.'
              manual_close: 'YES'
              tags:
                - tag: security_concern
                  value: vulnerability_correlation_high

        - uuid: 46de3344483c4db7b16459eeaf381176
          name: 'Threat Intelligence Report'
          type: EXTERNAL
          key: 'get_domain_health.py[threat_intelligence,{$DNS_DOMAIN}]'
          delay: 24h
          history: 7d
          value_type: TEXT
          trends: '0'
          description: 'Complete threat intelligence and risk assessment report'
          tags:
            - tag: component
              value: threat_intelligence
            - tag: phase
              value: '7'
            - tag: report
              value: comprehensive

      tags:
        - tag: Author
          value: 'Simon Jackson'
      macros:
        - macro: '{$DNS_DOMAIN}'
          description: 'The domain name to monitor (e.g., example.com)'
        - macro: '{$DNS_EXPIRY_INFO}'
          value: '90'
          description: 'Days until expiry threshold for info alerts (default: 90)'
        - macro: '{$DNS_EXPIRY_WARNING}'
          value: '45'
          description: 'Days until expiry threshold for warning alerts (default: 45)'
        - macro: '{$DNS_HEALTH_CRITICAL}'
          value: '50'
          description: 'Health score threshold for critical alerts'
        - macro: '{$DNS_HEALTH_WARNING}'
          value: '75'
          description: 'Health score threshold for warning alerts'
        - macro: '{$DNS_LATENCY_WARNING}'
          value: '500'
          description: 'DNS query latency threshold in ms for warning alerts (default: 500)'
        - macro: '{$DNS_NAMESERVER}'
          description: 'DNS nameserver to use (blank = system resolver)'
        - macro: '{$DNS_NS_LATENCY_WARNING}'
          value: '200'
          description: 'NS server latency threshold in ms for warning alerts (default: 200)'
        - macro: '{$DNS_TIMEOUT}'
          value: '10'
          description: 'DNS query timeout in seconds (default: 10)'
        - macro: '{$PORT_COUNT_WARNING}'
          value: '20'
          description: 'Threshold for warning when too many ports are open (default: 20)'
        - macro: '{$PORT_SECURITY_CRITICAL}'
          value: '40'
          description: 'Port security score threshold for critical alerts (default: 40)'
        - macro: '{$PORT_SECURITY_WARNING}'
          value: '70'
          description: 'Port security score threshold for warning alerts (default: 70)'
        
        # Phase 3: Service Identification Macros
        - macro: '{$SERVICE_IDENTIFICATION_TIMEOUT}'
          value: '30'
          description: 'Timeout for service identification probes in seconds (default: 30)'
        - macro: '{$SERVICE_SECURITY_CRITICAL}'
          value: '40'
          description: 'Service security score threshold for critical alerts (default: 40)'
        - macro: '{$SERVICE_SECURITY_WARNING}'
          value: '60'
          description: 'Service security score threshold for warning alerts (default: 60)'
        - macro: '{$MAX_FINGERPRINT_THREADS}'
          value: '10'
          description: 'Maximum concurrent threads for service fingerprinting (default: 10)'
        - macro: '{$DATABASE_EXPOSURE_WARNING}'
          value: '1'
          description: 'Enable warnings for exposed database services (1=enabled, 0=disabled)'
        - macro: '{$VULNERABLE_SERVICE_THRESHOLD}'
          value: '1'
          description: 'Threshold for vulnerable services alert (default: 1)'
        - macro: '{$ENABLE_BANNER_GRABBING}'
          value: '1'
          description: 'Enable banner grabbing for service identification (1=enabled, 0=disabled)'
        
        # Phase 4: SSL/TLS Security Analysis Macros
        - macro: '{$SSL_ANALYSIS_TIMEOUT}'
          value: '30'
          description: 'Timeout for SSL/TLS analysis operations in seconds (default: 30)'
        - macro: '{$SSL_SECURITY_CRITICAL}'
          value: '40'
          description: 'SSL security score threshold for critical alerts (default: 40)'
        - macro: '{$SSL_SECURITY_WARNING}'
          value: '70'
          description: 'SSL security score threshold for warning alerts (default: 70)'
        - macro: '{$SSL_COMPLIANCE_THRESHOLD}'
          value: '60'
          description: 'SSL compliance score threshold for warnings (default: 60)'
        - macro: '{$SSL_CERTIFICATE_WARNING_DAYS}'
          value: '30'
          description: 'Days before certificate expiry to trigger warning (default: 30)'
        - macro: '{$ENABLE_SSL_VULNERABILITY_SCAN}'
          value: '1'
          description: 'Enable SSL vulnerability scanning (1=enabled, 0=disabled)'
        - macro: '{$SSL_PROTOCOL_CHECK}'
          value: '1'
          description: 'Enable deprecated SSL protocol detection (1=enabled, 0=disabled)'

        # Phase 5: Web Application Analysis Macros
        - macro: '{$WEB_ANALYSIS_TIMEOUT}'
          value: '30'
          description: 'Timeout for web application analysis operations in seconds (default: 30)'
        - macro: '{$WEB_SECURITY_SCORE_THRESHOLD}'
          value: '60'
          description: 'Web application security score threshold for warnings (default: 60)'
        - macro: '{$WEB_VULNERABILITIES_THRESHOLD}'
          value: '5'
          description: 'Maximum number of web vulnerabilities before triggering alert (default: 5)'
        - macro: '{$WEB_HEADERS_SCORE_THRESHOLD}'
          value: '50'
          description: 'Security headers score threshold for warnings (default: 50)'
        - macro: '{$WEB_PORTS}'
          value: '80,443'
          description: 'Comma-separated list of web application ports to analyze (default: 80,443)'
        - macro: '{$ENABLE_WEB_DIRECTORY_ENUM}'
          value: '1'
          description: 'Enable web directory enumeration (1=enabled, 0=disabled)'
        - macro: '{$ENABLE_WEB_CMS_DETECTION}'
          value: '1'
          description: 'Enable CMS and framework detection (1=enabled, 0=disabled)'
        - macro: '{$WEB_FORM_SECURITY_THRESHOLD}'
          value: '70'
          description: 'Web form security score threshold for warnings (default: 70)'
        - macro: '{$WEB_COOKIE_SECURITY_THRESHOLD}'
          value: '80'
          description: 'Cookie security score threshold for warnings (default: 80)'

        # Phase 6: Advanced Network Analysis Macros
        - macro: '{$NETWORK_ANALYSIS_TIMEOUT}'
          value: '60'
          description: 'Timeout for network topology analysis operations in seconds (default: 60)'
        - macro: '{$NETWORK_SECURITY_THRESHOLD}'
          value: '60'
          description: 'Network security score threshold for warnings (default: 60)'
        - macro: '{$NETWORK_PERFORMANCE_THRESHOLD}'
          value: '70'
          description: 'Network performance score threshold for warnings (default: 70)'
        - macro: '{$NETWORK_COMPLIANCE_THRESHOLD}'
          value: '60'
          description: 'Network compliance score threshold for warnings (default: 60)'
        - macro: '{$NETWORK_VULNERABILITIES_THRESHOLD}'
          value: '3'
          description: 'Maximum number of network vulnerabilities before triggering alert (default: 3)'
        - macro: '{$NETWORK_LATENCY_THRESHOLD}'
          value: '100'
          description: 'Average network latency threshold in ms for warnings (default: 100)'
        - macro: '{$ENABLE_NETWORK_TOPOLOGY_DISCOVERY}'
          value: '1'
          description: 'Enable network topology discovery (1=enabled, 0=disabled)'
        - macro: '{$NETWORK_HOP_LIMIT}'
          value: '30'
          description: 'Maximum number of network hops for traceroute analysis (default: 30)'
        - macro: '{$ENABLE_NETWORK_COMPLIANCE_CHECK}'
          value: '1'
          description: 'Enable network compliance checking (1=enabled, 0=disabled)'

        # Phase 7: Threat Intelligence & Risk Assessment Macros
        - macro: '{$THREAT_INTELLIGENCE_TIMEOUT}'
          value: '120'
          description: 'Timeout for threat intelligence operations in seconds (default: 120)'
        - macro: '{$THREAT_REPUTATION_THRESHOLD}'
          value: '30'
          description: 'Domain reputation score threshold below which triggers alert (0-100, default: 30)'
        - macro: '{$THREAT_INTELLIGENCE_THRESHOLD}'
          value: '60'
          description: 'Overall threat intelligence score threshold above which triggers alert (0-100, default: 60)'
        - macro: '{$RISK_ASSESSMENT_THRESHOLD}'
          value: '70'
          description: 'Overall risk assessment score threshold above which triggers alert (0-100, default: 70)'
        - macro: '{$THREAT_ACTORS_THRESHOLD}'
          value: '1'
          description: 'Number of threat actors threshold above which triggers alert (default: 1)'
        - macro: '{$ATTACK_SURFACE_THRESHOLD}'
          value: '50'
          description: 'Attack surface exposure score threshold above which triggers alert (0-100, default: 50)'
        - macro: '{$VULN_CORRELATION_THRESHOLD}'
          value: '3'
          description: 'Number of correlated vulnerabilities threshold above which triggers alert (default: 3)'
        - macro: '{$ENABLE_THREAT_INTELLIGENCE}'
          value: '1'
          description: 'Enable threat intelligence analysis (1=enabled, 0=disabled)'
        - macro: '{$ENABLE_MALWARE_ANALYSIS}'
          value: '1'
          description: 'Enable malware detection and analysis (1=enabled, 0=disabled)'
        - macro: '{$ENABLE_RISK_ASSESSMENT}'
          value: '1'
          description: 'Enable comprehensive risk assessment (1=enabled, 0=disabled)'
        - macro: '{$THREAT_FEED_SOURCES}'
          value: 'virustotal,alienvault,hybrid-analysis'
          description: 'Comma-separated list of threat feed sources to use (default: virustotal,alienvault,hybrid-analysis)'
        - macro: '{$IOC_CONFIDENCE_THRESHOLD}'
          value: '75'
          description: 'IOC confidence threshold percentage for threat analysis (0-100, default: 75)'
        - macro: '{$THREAT_INTELLIGENCE_HISTORY_DAYS}'
          value: '30'
          description: 'Number of days to retain threat intelligence data (default: 30)'

      dashboards:
        - uuid: 2e5c45e5625e48d49134dcb42b9f2b09
          name: 'Domain Health Overview'
          display_period: '3600'
          pages:
            - name: 'Health Summary'
              widgets:
                - type: GAUGE
                  name: 'Overall Health Score'
                  width: '6'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
                - type: GRAPH
                  name: 'Health Score Over Time'
                  'y': '4'
                  width: '12'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[health,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'DNSSEC Status'
                  x: '6'
                  width: '6'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dnssec.enabled,{$DNS_DOMAIN}]'
            - name: 'Email Authentication'
              widgets:
                - type: SINGLE_VALUE
                  name: 'SPF Status'
                  width: '4'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[spf.valid,{$DNS_DOMAIN}]'
                - type: TEXT
                  name: 'SPF Error'
                  'y': '3'
                  width: '6'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[spf.error,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'DMARC Status'
                  x: '4'
                  width: '4'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dmarc.valid,{$DNS_DOMAIN}]'
                - type: TEXT
                  name: 'DMARC Error'
                  x: '6'
                  'y': '3'
                  width: '6'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dmarc.error,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'DKIM Status'
                  x: '8'
                  width: '4'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dkim.valid,{$DNS_DOMAIN}]'
            - name: 'DNSSEC & Security'
              widgets:
                - type: SINGLE_VALUE
                  name: 'DNSSEC Enabled'
                  width: '4'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dnssec.enabled,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  x: '4'
                  width: '4'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dnssec.valid,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'CAA Records Valid'
                  x: '8'
                  width: '4'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[caa.valid,{$DNS_DOMAIN}]'
            - name: 'Registrar Info'
              widgets:
                - type: TEXT
                  name: 'WHOIS Data'
                  width: '12'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[whois,{$DNS_DOMAIN}]'
            - name: 'Active Triggers'
              widgets:
                - type: TRIGGER_OVERVIEW
                  name: 'DNS Health Triggers'
                  width: '12'
                  height: '4'
            - name: 'DNS Performance'
              widgets:
                - type: GAUGE
                  name: 'DNS Query Latency'
                  width: '4'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[latency.ms,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'Domain Age (Days)'
                  'y': '3'
                  width: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[rdap.domain_age,{$DNS_DOMAIN}]'
                - type: GRAPH
                  name: 'DNS Latency Trend'
                  x: '4'
                  width: '8'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[latency.ms,{$DNS_DOMAIN}]'
            - name: 'Email Security'
              widgets:
                - type: GAUGE
                  name: 'Email Security Score'
                  width: '4'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[email_security.score,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: SPF
                  x: '4'
                  width: '2'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[spf.valid,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: TLS-RPT
                  x: '4'
                  'y': '2'
                  width: '2'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[tls_rpt.configured,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: DKIM
                  x: '6'
                  width: '2'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dkim.valid,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: BIMI
                  x: '6'
                  'y': '2'
                  width: '2'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[bimi.configured,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: DMARC
                  x: '8'
                  width: '2'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dmarc.valid,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: MTA-STS
                  x: '10'
                  width: '2'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[mta_sts.configured,{$DNS_DOMAIN}]'
            - name: 'DNSSEC Details'
              widgets:
                - type: SINGLE_VALUE
                  name: 'DNSSEC Enabled'
                  width: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dnssec.enabled,{$DNS_DOMAIN}]'
                - type: TEXT
                  name: Algorithms
                  'y': '2'
                  width: '6'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dnssec.algorithms,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'Chain Valid'
                  x: '3'
                  width: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dnssec.chain_valid,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'KSK Count'
                  x: '6'
                  width: '2'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dnssec.ksk_count,{$DNS_DOMAIN}]'
                - type: TEXT
                  name: 'Failure Reason'
                  x: '6'
                  'y': '2'
                  width: '6'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dnssec.failure_description,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'ZSK Count'
                  x: '8'
                  width: '2'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dnssec.zsk_count,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'RRSIG Expiry (Days)'
                  x: '10'
                  width: '2'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dnssec.rrsig_expiry_days,{$DNS_DOMAIN}]'
            - name: 'Performance Analytics'
              widgets:
                - type: GAUGE
                  name: 'Overall Health Score'
                  width: '4'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[health.comprehensive_score,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'Resolver Success Rate'
                  'y': '4'
                  width: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[resolver.success_rate,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'Average Latency (ms)'
                  x: '3'
                  'y': '4'
                  width: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[latency.average,{$DNS_DOMAIN}]'
                - type: GRAPH
                  name: 'DNS Latency Trends'
                  x: '4'
                  width: '8'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[latency.average,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'Geographic Diversity'
                  x: '6'
                  'y': '4'
                  width: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[zone.geographic_diversity,{$DNS_DOMAIN}]'
                - type: SINGLE_VALUE
                  name: 'Zone Serial Consistency'
                  x: '9'
                  'y': '4'
                  width: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[zone.serial_consistency,{$DNS_DOMAIN}]'
            - name: 'Security Monitoring'
              widgets:
                - type: HONEYCOMB
                  name: 'Security Status'
                  width: '6'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[security.amplification_risk,{$DNS_DOMAIN}]'
                    - type: ITEM
                      name: itemid.1
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[security.zone_transfer_protected,{$DNS_DOMAIN}]'
                    - type: ITEM
                      name: itemid.2
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dnssec.enabled,{$DNS_DOMAIN}]'
                - type: PROBLEMS_BY_SEVERITY
                  name: 'Security Alerts'
                  'y': '4'
                  width: '12'
                  height: '3'
                  fields:
                    - type: STRING
                      name: tags.tag.0
                      value: dns_check
                    - type: STRING
                      name: tags.value.0
                      value: security
                - type: DATA_TABLE
                  name: 'Security Checks'
                  x: '6'
                  width: '6'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[security.amplification_risk,{$DNS_DOMAIN}]'
                    - type: ITEM
                      name: itemid.1
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[security.zone_transfer_protected,{$DNS_DOMAIN}]'
                    - type: ITEM
                      name: itemid.2
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[dane.valid,{$DNS_DOMAIN}]'
            - name: 'Service Integration'
              widgets:
                - type: DATA_TABLE
                  name: 'Discovered Services'
                  width: '6'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[services.https_available,{$DNS_DOMAIN}]'
                    - type: ITEM
                      name: itemid.1
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[services.tls_count,{$DNS_DOMAIN}]'
                - type: GRAPH_PROTOTYPE
                  name: 'Port Connectivity'
                  'y': '4'
                  width: '12'
                  height: '4'
                  fields:
                    - type: STRING
                      name: prototype.0
                      value: 'Port {#PORTS} Connectivity'
                - type: GRAPH_PROTOTYPE
                  name: 'TLS Services Status'
                  x: '6'
                  width: '6'
                  height: '4'
                  fields:
                    - type: STRING
                      name: prototype.0
                      value: 'TLS Service Status on Port {#PORTS}'
            - name: 'Comprehensive Overview'
              widgets:
                - type: GAUGE
                  name: 'Comprehensive Health Score'
                  width: '6'
                  height: '6'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[health.comprehensive_score,{$DNS_DOMAIN}]'
                - type: TOP_HOSTS
                  name: 'Health Score Ranking'
                  'y': '6'
                  width: '12'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Domain Health'
                        key: 'get_domain_health.py[health.comprehensive_score,{$DNS_DOMAIN}]'
                - type: PROBLEMS
                  name: 'Critical Issues'
                  x: '6'
                  width: '6'
                  height: '6'
                  fields:
                    - type: STRING
                      name: tags.tag.0
                      value: dns_check
                    - type: STRING
                      name: tags.value.0
                      value: comprehensive
      valuemaps:
        - uuid: 7e8f9a0b1c2d4e4f8a6b7c8d9e0f1a2b
          name: 'DNS Check Status'
          mappings:
            - value: '0'
              newvalue: Invalid
            - value: '1'
              newvalue: Valid
        - uuid: 7d1227da1f874c3cb2c2336c703e4250
          name: 'DNS Performance Status'
          mappings:
            - value: '0'
              newvalue: Poor
            - value: '1'
              newvalue: Good
            - value: '2'
              newvalue: Excellent
        - uuid: 8f9a0b1c2d3e4f5a8b7c8d9e0f1a2b3c
          name: 'DNSSEC Status'
          mappings:
            - value: '0'
              newvalue: Disabled
            - value: '1'
              newvalue: Enabled
        - uuid: a002850d84574cfc9934ffa064655b55
          name: 'DNS Security Status'
          mappings:
            - value: '0'
              newvalue: 'High Risk'
            - value: '1'
              newvalue: 'Medium Risk'
            - value: '2'
              newvalue: 'Low Risk'
            - value: '3'
              newvalue: Secure
        - uuid: a39a21a642f84f8c95de7f2dde8c7b22
          name: 'Registrar Lock Status'
          mappings:
            - value: '0'
              newvalue: Unlocked
            - value: '1'
              newvalue: Locked
        - uuid: 53661c1353024dfcad235bd812d9e8d5
          name: 'Transfer Prohibition Status'
          mappings:
            - value: '0'
              newvalue: 'Not Protected'
            - value: '1'
              newvalue: Protected
