zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: c5381dc540504dbba10e2d300554e4cd
      name: Firewall
  templates:
    - uuid: 70bea07f3fbf4af0bf65b40690311461
      template: 'Watchguard Firewall'
      name: 'Watchguard Firewall'
      description: |
        Overview
        This template monitors WatchGuard Firebox appliances using SNMPv2.
        It covers system information, interfaces, BoVPNs, CPU, memory, HA cluster status, temperature, and other key metrics.
        
        Features
        - System information (uptime, firmware, serial number, feature key expiry)
        - CPU, memory, temperature, and fan monitoring
        - Interface traffic, errors, operational status
        - BoVPN tunnels: traffic, state, errors
        - Cluster/HA information including sync state and member health
        - Value mapping for interface statuses, VPN tunnel states, and cluster roles
        - SNMP discovery for network interfaces and VPN tunnels
        - Triggers for interface down, tunnel flaps, cluster sync loss
        - Graphs combining traffic and error metrics
        - Support for aggregation graphs on multi-member interfaces and BoVPNs
        
        Items
        - Core device monitoring (firmware version, uptime, cluster enabled state)
        - VPN tunnel monitoring by BoVPN tunnel name
        - Interface monitoring per port (traffic, status, errors)
        
        Discovery rules
        - Discovery of physical and logical interfaces
        - Discovery of BoVPN tunnels
        - Planned future: discovery of cluster members (HA extension)
        
        Item prototypes
        - Traffic (in/out), errors (in/out), operational status for each discovered interface
        - Traffic (in/out), status for each discovered BoVPN tunnel
        
        Trigger prototypes
        - Interface down detection
        - Interface error rate high
        - BoVPN tunnel state changes
        - BoVPN tunnel flapping (future refinement)
        - Cluster not synchronised
        - CPU or memory high utilisation
        
        Graph prototypes
        - Interface traffic and error overlays
        - VPN tunnel traffic graphs
        - Aggregated traffic graphs per VPN
        
        Supported devices
        - WatchGuard Firebox M Series (e.g., M370, M470, M570, M670)
        - T Series (partial support)
        - HA/Clustered environments (2-node active/passive clusters)
        
        Notes
        - Template based on SNMPv2.
        - Requires WatchGuard device SNMP service enabled and properly configured.
        - VPN tunnel monitoring uses BoVPN tunnel statistics; dynamic tunnels (e.g., Mobile VPNs) are not fully covered.
        
        Author: Simon Jackson / @sjackson0109
      groups:
        - name: Firewall
      items:
        - uuid: 01631f0dd4ee4fb294b78656cae137d6
          name: 'Application Control Enabled'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.4.3.0
          key: appcontrol.status
          delay: 1h
          value_type: FLOAT
          status: DISABLED
          valuemap:
            name: feature.status.valuemap
          tags:
            - tag: Application
              value: Licensing
        - uuid: 114315b387144adeb928ffd6b187f140
          name: 'FireCluster Primary Member Hardware Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.5.0
          key: 'cluster.hardware.health[primary]'
          description: 'Hardware health status of the Primary FireCluster member'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: 2b8be0c8e690433485d0c092f2797414
              expression: 'min(/Watchguard Firewall/cluster.hardware.health[primary],5m)<100'
              name: 'FireCluster Primary Member Hardware Health Problem'
              priority: HIGH
              description: 'Primary FireCluster member hardware health status is not OK. Possible hardware issue.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: e5a476b52d8d422da9f9d0c55b2de2c3
          name: 'FireCluster Secondary Member Hardware Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.11.0
          key: 'cluster.hardware.health[secondary]'
          description: 'Hardware health status of the Secondary FireCluster member'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: f5488d9e48b8497c82a3e047fcec78b0
              expression: 'min(/Watchguard Firewall/cluster.hardware.health[secondary],5m)<100'
              name: 'FireCluster Secondary Member Hardware Health Problem'
              priority: HIGH
              description: 'Secondary FireCluster member hardware health status is not OK. Possible hardware issue.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: f143cb6474e343c0b4d3af8481fdb991
          name: 'FireCluster Primary Member Interface Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.6.0
          key: 'cluster.interface.health[primary]'
          description: 'Interface (Port) health status of the Primary FireCluster member'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: a36e7dc9d8b74e08beaa7a60e3070150
              expression: 'min(/Watchguard Firewall/cluster.interface.health[primary],5m)<100'
              name: 'FireCluster Primary Member Interface Health Problem'
              priority: HIGH
              description: 'Primary FireCluster member interface (port) health status is not OK. Link/port issues suspected.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: 3aa7127f6c6d4fc0b41f53ef57e68bc1
          name: 'FireCluster Secondary Member Interface Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.12.0
          key: 'cluster.interface.health[secondary]'
          description: 'Interface (Port) health status of the Secondary FireCluster member'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: 81f1cfc6a9eb4260af02a199da4f2c8f
              expression: 'min(/Watchguard Firewall/cluster.interface.health[secondary],5m)<100'
              name: 'FireCluster Secondary Member Interface Health Problem'
              priority: WARNING
              description: 'Secondary FireCluster member interface (port) health status is not OK. Secondary link/port may have issues.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: 7635cc08a4d548b3a439f042050dffe8
          name: 'FireCluster Status'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.1.0
          key: cluster.status
          delay: 5m
          value_type: FLOAT
          valuemap:
            name: cluster.status.valuemap
          tags:
            - tag: Component
              value: HA
        - uuid: 9e291445b25c49009f02b0ebf8221c28
          name: 'Cluster Synchronisation Status'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.5.0
          key: cluster.sync.status
          value_type: FLOAT
          units: '%'
          description: 'Reports the synchronisation percentage between FireCluster nodes (0–100%). Available only if FireCluster is enabled. A persistent value below 100% indicates configuration or state mismatch between cluster members.'
          valuemap:
            name: cluster.sync.valuemap
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: b1d90c34321d4c9f91da6e1c1eb14542
              expression: 'min(/Watchguard Firewall/cluster.sync.status,5m)<>100'
              name: 'Cluster Synchronisation Issue Detected'
              priority: HIGH
              description: 'FireCluster nodes are not fully synchronised. Possible configuration divergence, failover event, or cluster instability.'
              tags:
                - tag: Component
                  value: HA
                - tag: EventType
                  value: SyncIssue
        - uuid: d369bbd462a4401a9fb30f1484a75709
          name: 'FireCluster Primary Member System Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.4.0
          key: 'cluster.system.health[primary]'
          description: 'System health status of the Primary FireCluster member'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: 35619e3ccfb04aa6b0f8b8b1cadfd774
              expression: 'min(/Watchguard Firewall/cluster.system.health[primary],5m)<100'
              name: 'FireCluster Primary Member System Health Problem'
              priority: HIGH
              description: 'Primary FireCluster member system health status is not OK. Investigate potential failures.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: 76fc99ec79c74197a1ee02f8c374f32f
          name: 'FireCluster Secondary Member System Health'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.6.10.0
          key: 'cluster.system.health[secondary]'
          description: 'System health status of the Secondary FireCluster member'
          tags:
            - tag: Component
              value: HA
          triggers:
            - uuid: 916d7c58f9af49c48622f5da3e63c78e
              expression: 'min(/Watchguard Firewall/cluster.system.health[secondary],5m)<100'
              name: 'FireCluster Secondary Member System Health Problem'
              priority: HIGH
              description: 'Secondary FireCluster member system health status is not OK. Investigate potential failures.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: HA
        - uuid: 7bf47d4cf3f0427c90077b3070d9ae01
          name: 'Active Connections'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.5.1.2.1.0
          key: connections.active
          value_type: FLOAT
          units: connections
          description: 'Current active firewall connections'
          triggers:
            - uuid: b29b0981202f43dfa0f9fed286962c04
              expression: 'last(/Watchguard Firewall/connections.active) > {$WATCHGUARD_MAX_CONNECTIONS}'
              name: 'Possible DDoS Attack'
              priority: AVERAGE
              description: 'Total connections ({ITEM.LASTVALUE}) exceeded threshold ({$WATCHGUARD_MAX_CONNECTIONS})'
              tags:
                - tag: Component
                  value: Connections
        - uuid: e756a8c29bf64b5bb507238cd6314304
          name: 'Connection Rate'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.5.1.2.2.0
          key: connections.rate
          value_type: FLOAT
          units: conn/s
          description: 'Current connection rate'
          tags:
            - tag: Performance
              value: Metrics
        - uuid: 0a7d17d617f849748f83fcf2521f54b5
          name: 'Device Description'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysDescr.0'
          key: description
          delay: '30'
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'A textual description of the entity.  This value should include the full name and version identification of the system''s hardware type, software operating-system, and networking software.'
          inventory_link: HARDWARE
          tags:
            - tag: Application
              value: General
        - uuid: 47ecd8643eb14dce951d3e7204b377ec
          name: 'GAV Update'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.1.3.0
          key: gav.version
          delay: 1h
          value_type: TEXT
          trends: '0'
          description: 'Gateway AV service last update time'
          preprocessing:
            - type: REGEX
              parameters:
                - '<gav_version:[\d\.]+>\((.*?)\)'
                - \1
          tags:
            - tag: Application
              value: Licensing
          triggers:
            - uuid: c7c34885066042268335c60f4ac48bff
              expression: 'length(last(/Watchguard Firewall/gav.version))=0'
              name: 'Antivirus (GAV) Disabled, Not Installed or No Updating'
              priority: WARNING
        - uuid: 48704d5ad2654eaeadfe1060259f5888
          name: 'IPS Update'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.1.4.0
          key: ips.version
          delay: 1h
          value_type: TEXT
          trends: '0'
          description: 'IPS service last update time'
          preprocessing:
            - type: REGEX
              parameters:
                - '<ips_version:[\d\.]+>\((.*?)\)'
                - \1
          tags:
            - tag: Application
              value: Licensing
          triggers:
            - uuid: 78e413ece3b74e3d8d0e0b4bde05e3ed
              expression: 'length(last(/Watchguard Firewall/ips.version))=0'
              name: 'Intrusion Protection System (IPS) Disabled, Not Installed or No Updating'
              priority: WARNING
        - uuid: 529287f4ce164be1be0a1eabead176a5
          name: 'Device Location'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysLocation.0'
          key: location
          delay: '30'
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'The physical location of this node (e.g., `telephone closet, 3rd floor'').  If the location is unknown, the value is the zero-length string.'
          inventory_link: LOCATION
          tags:
            - tag: Application
              value: General
        - uuid: 3fb0eec716ee423a819486947d8666d0
          name: 'Device Model'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysDescr.0'
          key: model
          delay: '30'
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'Model name or identifier of the WatchGuard hardware.'
          inventory_link: MODEL
          tags:
            - tag: Application
              value: General
        - uuid: 5f9f37467ceb4deba44592bed7bff233
          name: 'Device Name'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysName.0'
          key: name
          delay: '30'
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'An administratively-assigned name for this managed node. By convention, this is the node''s fully-qualified domain name.  If the name is unknown, the value is the zero-length string.'
          inventory_link: NAME
          tags:
            - tag: Application
              value: General
        - uuid: 9ae35f6ab16d42ae84acc6bb6b91316f
          name: 'Traffic: Inbound'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.5.1.2.5.0
          key: traffc_inbound
          value_type: FLOAT
          units: bps
          description: 'Total inbound traffic'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
          tags:
            - tag: Performance
              value: Metrics
        - uuid: 276ee8e2402e4b799d1bbb52110559f9
          name: 'Traffic: Outbound'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.5.1.2.6.0
          key: traffc_outbound
          value_type: FLOAT
          units: bps
          description: 'Total outbound traffic'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
          tags:
            - tag: Performance
              value: Metrics
        - uuid: 9d37f216afb040ae85a1f6dfda360251
          name: 'Device Uptime'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysUpTime.0'
          key: uptime
          delay: '30'
          history: 1w
          units: uptime
          description: 'The time since the network management portion of the system was last re-initialized.'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Application
              value: General
        - uuid: 46eeebe15b3a40779bd76821e2ee5c2e
          name: 'System CPU Utilisation'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.77.0
          key: watchguard.system.cpu.util
          delay: 30s
          units: '%'
          description: 'CPU utilisation percentage over the last 1 minute.'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          triggers:
            - uuid: 5646e63dd8e4497a9e4ceebbaf85f756
              expression: 'avg(/Watchguard Firewall/watchguard.system.cpu.util,3m) > 90'
              name: 'High CPU Usage (>90%) Detected (3 minutes)'
              priority: HIGH
              description: 'The CPU utilisation has been above 90% consistently for the past 3 minutes. Check for overloaded processes, traffic spikes, or potential system resource exhaustion.'
              tags:
                - tag: Resource
                  value: CPU
        - uuid: 626d070250584ec5970fd97e87a00abf
          name: 'WatchGuard System Current Time'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.1.1.0
          key: watchguard.system.currenttime
          delay: 1h
          value_type: TEXT
          trends: '0'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'var timestamp=parseInt(value);if(isNaN(timestamp))throw ''Invalid timestamp'';var date=new Date(timestamp*1000);return date.getUTCFullYear()+''-''+(''0''+(date.getUTCMonth()+1)).slice(-2)+''-''+(''0''+date.getUTCDate()).slice(-2)+'' ''+(''0''+date.getUTCHours()).slice(-2)+'':''+(''0''+date.getUTCMinutes()).slice(-2)+'':''+(''0''+date.getUTCSeconds()).slice(-2);'
        - uuid: 13f42e02f8a44c1396c7bfe6b30b4c21
          name: 'Device Firmware'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.1.0
          key: watchguard.system.firmware
          delay: '30'
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'Firmware version currently running on the Watchguard gateway device.'
          preprocessing:
            - type: REGEX
              parameters:
                - '<sysa:([^>]+)>'
                - \1
          tags:
            - tag: Application
              value: General
        - uuid: 5ba25820fe984afd8bf91795045186b7
          name: 'LiveSecurity Expires'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.1.5.0
          key: watchguard.system.livesecurityexp
          delay: 1h
          value_type: CHAR
          trends: '0'
          description: 'Expiration date of the LiveSecurity Support Subscription.'
          preprocessing:
            - type: REGEX
              parameters:
                - '<feature key>\(LIVESECURITY:\s(.*?)\)'
                - \1
        - uuid: 45b6065d71e249d9a8052cbe9b5bf8a3
          name: 'System Total Bytes Received (bps)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.9.0
          key: watchguard.system.total_recv_bps
          delay: 30s
          units: bps
          description: 'Total number of bytes received, converted to bits per second.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
        - uuid: 631a3f97f1554ab3b9640ec3afef657c
          name: 'System Total Packets Received (pps)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.11.0
          key: watchguard.system.total_recv_pps
          delay: 30s
          units: pps
          description: 'Total number of packets received, converted to packets per second.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
        - uuid: 67255bac37514d2cbedf7ea210c817e7
          name: 'System Total Bytes Sent (bps)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.8.0
          key: watchguard.system.total_send_bps
          delay: 30s
          units: bps
          description: 'Total number of bytes sent, converted to bits per second.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
            - type: MULTIPLIER
              parameters:
                - '8'
        - uuid: 5646e63dd8e4497a9e4ceebbaf85f756
          name: 'System Total Packets Sent (pps)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.10.0
          key: watchguard.system.total_send_pps
          delay: 30s
          units: pps
          description: 'Total number of packets sent, converted to packets per second.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
      discovery_rules:
        - uuid: fa8bb6e2d1f644cb8c83bb07368d9d0d
          name: 'VPN Tunnels (Route Based) - BoVPNs'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: bovpn.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#IFTYPE}'
                value: ^131$
                formulaid: A
          description: 'Firebox v12.11 firmware resolves the discovery of BoVPN interfaces, that contain a logical Interface (Virtual Tunnel Interface), these are detected as {#IFTYPE=^131}.'
          item_prototypes:
            - uuid: 3825d5cb56b441a7a9d26c9af97c81d4
              name: 'BoVPN: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'bovpn.ifInErrors[{#IFDESCR}]'
              description: 'Inbound errors on BoVPN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: BoVPN
              trigger_prototypes:
                - uuid: cbaaacd3b2144964915fa569fea949bb
                  expression: 'avg(/Watchguard Firewall/bovpn.ifInErrors[{#IFDESCR}],300s) > {$BOVPN_ERROR_THRESHOLD}'
                  name: 'BoVPN {#IFDESCR} Errors In'
                  priority: HIGH
                  description: 'Inbound errors on BoVPN {#IFDESCR} exceeded critical threshold ({ITEM.LASTVALUE} > {$BOVPN_ERROR_THRESHOLD}/s)'
                  tags:
                    - tag: Component
                      value: BoVPN
                - uuid: 10651d67459a40adb0466aec7537e284
                  expression: 'avg(/Watchguard Firewall/bovpn.ifInErrors[{#IFDESCR}],300s) > {$BOVPN_WARNING_THRESHOLD}'
                  name: 'BoVPN {#IFDESCR} Errors In'
                  priority: WARNING
                  description: 'Inbound errors on BoVPN {#IFDESCR} exceeded warning threshold ({ITEM.LASTVALUE} > {$BOVPN_WARNING_THRESHOLD}/s)'
                  tags:
                    - tag: Component
                      value: BoVPN
            - uuid: 4a5b0b9e96574bba8ad34e9bb9721d98
              name: 'BoVPN: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'bovpn.ifInOctets[{#IFDESCR}]'
              units: Bps
              description: 'Incoming traffic on boVPN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: BoVPN
            - uuid: f750d8e05ca54716ad71706ddceade21
              name: 'BoVPN: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'bovpn.ifOperStatus[{#IFDESCR}]'
              description: 'Operational status of BoVPN {#IFDESCR}'
              valuemap:
                name: interface.status.valuemap
              tags:
                - tag: Component
                  value: BoVPN
              trigger_prototypes:
                - uuid: 9ce65072570a4ddf823a63e1ccd86298
                  expression: 'last(/Watchguard Firewall/bovpn.ifOperStatus[{#IFDESCR}],#1)<>last(/Watchguard Firewall/bovpn.ifOperStatus[{#IFDESCR}],#5:now-5m)=1'
                  name: 'BoVPN {#IFDESCR} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: Component
                      value: BoVPN
            - uuid: 9eb3a3b320694e8b9b03ee60f7fe35c6
              name: 'BoVPN: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'bovpn.ifOutErrors[{#IFDESCR}]'
              description: 'Outbound errors on BoVPN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: BoVPN
              trigger_prototypes:
                - uuid: 34f1ab6cacf4415aa23c0d8d3cd12d12
                  expression: 'avg(/Watchguard Firewall/bovpn.ifOutErrors[{#IFDESCR}],300s) > {$BOVPN_ERROR_THRESHOLD}'
                  name: 'BoVPN {#IFDESCR} Errors Out'
                  priority: HIGH
                  description: 'Outbound errors on BoVPN {#IFDESCR} exceeded critical threshold ({ITEM.LASTVALUE} > {$BOVPN_ERROR_THRESHOLD}/s)'
                  tags:
                    - tag: Component
                      value: BoVPN
                - uuid: 12a75b598cad4476b170b0720064eb1a
                  expression: 'avg(/Watchguard Firewall/bovpn.ifOutErrors[{#IFDESCR}],300s) > {$BOVPN_WARNING_THRESHOLD}'
                  name: 'BoVPN {#IFDESCR} Errors Out'
                  priority: WARNING
                  description: 'Outbound errors on BoVPN {#IFDESCR} exceeded warning threshold ({ITEM.LASTVALUE} > {$BOVPN_WARNING_THRESHOLD}/s)'
                  tags:
                    - tag: Component
                      value: BoVPN
            - uuid: 2b9d96f7cffc4b06a50f264788a3542f
              name: 'BoVPN: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'bovpn.ifOutOctets[{#IFDESCR}]'
              units: Bps
              description: 'Outgoing traffic on boVPN interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: BoVPN
          graph_prototypes:
            - uuid: a0438209de22405c9dd99914b7df55af
              name: 'BoVPN: {#IFDESCR} Status'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'bovpn.ifOperStatus[{#IFDESCR}]'
            - uuid: 5a0eb594d92f4ea89047fe130d8bec86
              name: 'BoVPN: {#IFDESCR} Traffic'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'Watchguard Firewall'
                    key: 'bovpn.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Watchguard Firewall'
                    key: 'bovpn.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  color: 81C784
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'bovpn.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  color: E57373
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'bovpn.ifOutErrors[{#IFDESCR}]'
        - uuid: d08266c54b8340dfbe79b7fc198e7135
          name: Processors
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},HOST-RESOURCES-MIB::hrProcessorLoad]'
          key: cpu.discovery
          delay: 1h
          description: 'Discover the processors of the firewall device'
          item_prototypes:
            - uuid: a14697b5314449cba012621e3233ccbb
              name: 'Processor Utilisation {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: 'HOST-RESOURCES-MIB::hrProcessorLoad.{#SNMPINDEX}'
              key: 'hrProcessorLoad[{#SNMPINDEX}]'
              units: '%'
              description: 'The average, over the last minute, of the percentage of time that this processor was not idle. Implementations may approximate this one minute smoothing period if necessary.'
              tags:
                - tag: Application
                  value: CPU
              trigger_prototypes:
                - uuid: 8d877b6be7de4f35976e80c447681379
                  expression: 'last(/Watchguard Firewall/hrProcessorLoad[{#SNMPINDEX}],#1:now-300s)>{$WATCHGUARD_CPU_HIGH}'
                  name: 'Firebox CPU {#SNMPINDEX} Utilisation over {$WATCHGUARD_CPU_HIGH}%'
                  priority: WARNING
                  description: 'Firebox Master CPU on {HOST.NAME} is over {$WATCHGUARD_CPU_HIGH}%'
                  tags:
                    - tag: Value
                      value: '{ITEM.VALUE}'
                - uuid: 09f704b658ec46ba8787211659adc66c
                  expression: 'last(/Watchguard Firewall/hrProcessorLoad[{#SNMPINDEX}],#1:now-300s)>{$WATCHGUARD_CPU_LOW}'
                  name: 'Firebox CPU {#SNMPINDEX} Utilisation over {$WATCHGUARD_CPU_LOW}%'
                  priority: AVERAGE
                  description: 'Firebox Master CPU on {HOST.NAME} is over {$WATCHGUARD_CPU_LOW}%'
                  manual_close: 'YES'
                  tags:
                    - tag: Value
                      value: '{ITEM.VALUE}'
          graph_prototypes:
            - uuid: e108e4fbf3074c6fb907630bf1a4a090
              name: 'Processor Utilisation{#SNMPINDEX}'
              width: '600'
              height: '340'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Watchguard Firewall'
                    key: 'hrProcessorLoad[{#SNMPINDEX}]'
        - uuid: 4aecb006c90142bea79bfae5a1da5dac
          name: Disks
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},HOST-RESOURCES-MIB::hrStorageDescr]'
          key: disk.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#SNMPVALUE}'
                value: ^(/var|/|/boot|/tmp)$
                formulaid: A
          item_prototypes:
            - uuid: 9ee5bab46a4e4ead913110ab4ff1bbf5
              name: 'Description of storage {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: 'HOST-RESOURCES-MIB::hrStorageDescr.{#SNMPINDEX}'
              key: 'hrStorageDescr[{#SNMPVALUE}]'
              delay: 1h
              value_type: CHAR
              trends: '0'
              description: 'A description of the type and instance of the storage described by this entry.'
              tags:
                - tag: Application
                  value: 'Disk partitions'
            - uuid: d922bb9b39e342ddbf5a515fb89fac07
              name: 'Total disk space on {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: 'HOST-RESOURCES-MIB::hrStorageSize.{#SNMPINDEX}'
              key: 'hrStorageSize[{#SNMPVALUE}]'
              delay: 5m
              units: B
              description: 'total disk space in bytes.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '10240'
              tags:
                - tag: Application
                  value: 'Disk partitions'
            - uuid: 1d90884e06d040d1924a511e2deae73d
              name: 'Used disk space on {#SNMPVALUE}'
              type: SNMP_AGENT
              snmp_oid: 'HOST-RESOURCES-MIB::hrStorageUsed.{#SNMPINDEX}'
              key: 'hrStorageUsed[{#SNMPVALUE}]'
              delay: 5m
              units: B
              description: 'Used disk space in bytes.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '10240'
              tags:
                - tag: Application
                  value: 'Disk partitions'
          trigger_prototypes:
            - uuid: fc92586b426f452fb52d1651869c3333
              expression: '(last(/Watchguard Firewall/hrStorageUsed[{#SNMPVALUE}]) / last(/Watchguard Firewall/hrStorageSize[{#SNMPVALUE}])) * 100 > {$WATCHGUARD_DISK_LOW}'
              name: 'ALARM: Disk {#SNMPVALUE} utilisation above {$WATCHGUARD_DISK_LOW}'
              priority: AVERAGE
            - uuid: 350e4b4d1ab44c39a8ab44646dabb578
              expression: '(last(/Watchguard Firewall/hrStorageUsed[{#SNMPVALUE}]) / last(/Watchguard Firewall/hrStorageSize[{#SNMPVALUE}])) * 100 > {$WATCHGUARD_DISK_HIGH}'
              name: 'WARNING: Disk {#SNMPVALUE} utilisation above {$WATCHGUARD_DISK_HIGH}'
              priority: WARNING
          graph_prototypes:
            - uuid: 937ac52180a942408ab3fc921532ce33
              name: 'Disk space usage {#SNMPVALUE}'
              width: '600'
              height: '340'
              yaxismax: '0'
              type: PIE
              show_3d: 'YES'
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Watchguard Firewall'
                    key: 'hrStorageSize[{#SNMPVALUE}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Watchguard Firewall'
                    key: 'hrStorageUsed[{#SNMPVALUE}]'
        - uuid: 99d69c506b1f41f1816fea394fb29fde
          name: 'Fan Sensors'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPINDEX},1.3.6.1.4.1.3097.6.3.2.1.1]'
          key: fan.discovery
          delay: 1h
          status: DISABLED
          filter:
            conditions:
              - macro: '{#FAN_TYPE}'
                value: fan
                formulaid: A
          description: 'Firebox v12.10 does not expose FAN Index, FAN Speed, or FAN Health metrics over SNMPv2/3. Their published MIB pack suggests this should be available. Likely a bug in the firmware.'
          item_prototypes:
            - uuid: d7c819753c1949359cfadc15a78e13d1
              name: 'Fan {#FAN_NAME} Speed'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.3.2.1.3.{#SNMPINDEX}'
              key: 'fan.speed[{#FAN_NAME}]'
              delay: 5m
              value_type: FLOAT
              units: RPM
              description: 'Rotation speed for fan {#FAN_NAME}'
              tags:
                - tag: Component
                  value: Fan
              trigger_prototypes:
                - uuid: d78a3ac9a76541fcbac5dc278a3a198f
                  expression: 'last(/Watchguard Firewall/fan.speed[{#FAN_NAME}]) < {$WATCHGUARD_FAN_MIN_SPEED}'
                  name: 'Low Fan Speed on {#FAN_NAME}'
                  priority: WARNING
                  description: 'Fan {#FAN_NAME} speed is below minimum threshold ({ITEM.LASTVALUE} < {$WATCHGUARD_FAN_MIN_SPEED} RPM)'
                  tags:
                    - tag: Component
                      value: Fan
            - uuid: d96ba1d905a34d20bd3ff96703b2aa04
              name: 'Fan {#FAN_NAME} Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.3.2.1.4.{#SNMPINDEX}'
              key: 'fan.status[{#FAN_NAME}]'
              delay: 5m
              value_type: FLOAT
              description: 'Operational status for fan {#FAN_NAME} (0 = normal, 1 = warning, 2 = critical)'
              valuemap:
                name: fan.status.valuemap
              tags:
                - tag: Component
                  value: Fan
              trigger_prototypes:
                - uuid: 88dbf85421c1499091853fa6d555c0de
                  expression: 'last(/Watchguard Firewall/fan.status[{#FAN_NAME}]) > 0'
                  name: 'Fan {#FAN_NAME} Status Alert'
                  priority: WARNING
                  description: 'Fan {#FAN_NAME} reports non-normal status (Value: {ITEM.LASTVALUE})'
                  tags:
                    - tag: Component
                      value: Fan
          graph_prototypes:
            - uuid: a679223d23974611b13d25a26f16980e
              name: 'Fan Speed Trend - {#FAN_NAME}'
              graph_items:
                - color: 0000FF
                  item:
                    host: 'Watchguard Firewall'
                    key: 'fan.speed[{#FAN_NAME}]'
        - uuid: 6c359cfe2bd8453bab331ef6ae877a8c
          name: 'VPN Tunnels (Policy Based) - GwVPNs'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#VPNINDEX},1.3.6.1.4.1.3097.6.5.1.2.1.1,{#LOCALONE},1.3.6.1.4.1.3097.6.5.1.2.1.24,{#LOCALTWO},1.3.6.1.4.1.3097.6.5.1.2.1.25,{#REMOTEONE},1.3.6.1.4.1.3097.6.5.1.2.1.20,{#REMOTETWO},1.3.6.1.4.1.3097.6.5.1.2.1.21]'
          key: gwvpn.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#LOCALONE}'
                value: '^((?!0\.0\.0\.0).)*$'
                formulaid: A
              - macro: '{#REMOTEONE}'
                value: '^((?!0\.0\.0\.0).)*$'
                formulaid: B
          lifetime: 1d
          description: |
            Currently, as of firebox v12.10 firmware, the SNMP OID published in their MIB pack, is NOT exposed over SNMPv2/v3 - suggesting this is a bug in the FW firmware.
            These VPNs are Policy-Based VPNs, not Route-Based like BoVPNs are. I've never seen a firewall that successfully exposes metrics over SNMP related to Policy-Based VPNs. So i'm not hopeful this will ever be resolved by watchguard.
          item_prototypes:
            - uuid: fa6017fe1c0a49c29f5df0e3cb12eeb9
              name: 'GwVPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] Bytes In'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.5.1.2.1.28.{#VPNINDEX}'
              key: 'vpn.policy.bytesIn[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}]'
              value_type: FLOAT
              units: bps
              description: 'Inbound Bytes on VPN tunnel [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: GwVPN
            - uuid: 4df9f9b19eca4d46816a21c3df5e4b6e
              name: 'GwVPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] Bytes Out'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.5.1.2.1.29.{#VPNINDEX}'
              key: 'vpn.policy.bytesOut[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}]'
              value_type: FLOAT
              units: bps
              description: 'Outbound Bytes on VPN tunnel [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}]'''
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: GwVPN
            - uuid: d069897a63fb4fa58cc051ded4fddd55
              name: 'GwVPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] Errors In'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.5.1.2.1.29.{#VPNINDEX}'
              key: 'vpn.policy.ifInErrors[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}]'
              description: 'Inbound errors on VPN tunnel [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}]'
              tags:
                - tag: Component
                  value: GwVPN
              trigger_prototypes:
                - uuid: ed96cd2938124583bf5e7ad54eb32e32
                  expression: 'avg(/Watchguard Firewall/vpn.policy.ifInErrors[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}],300s) > {$GWVPN_ERROR_THRESHOLD}'
                  name: 'GwVPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] Errors In'
                  status: DISABLED
                  discover: NO_DISCOVER
                  priority: HIGH
                  description: 'Inbound errors on Gateway VPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] exceeded critical threshold ({ITEM.LASTVALUE} > {$GWVPN_ERROR_THRESHOLD}/s) within the last 5 minutes'
                  tags:
                    - tag: Component
                      value: GwVPN
                - uuid: 5196bb6e24a749018f20f64dde91b925
                  expression: 'avg(/Watchguard Firewall/vpn.policy.ifInErrors[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}],300s) > {$GWVPN_WARNING_THRESHOLD}'
                  name: 'GwVPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] Errors In'
                  priority: WARNING
                  description: 'Inbound errors on Gateway VPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] exceeded warning threshold ({ITEM.LASTVALUE} > {$GWVPN_WARNING_THRESHOLD}/s) within the last 5 mins'
                  tags:
                    - tag: Component
                      value: GwVPN
            - uuid: db71225b1ac5441f80a3ee5739cce566
              name: 'GwVPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] Errors Out'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.5.1.2.1.31.{#VPNINDEX}'
              key: 'vpn.policy.ifOutErrors[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}]'
              description: 'Outbound errors on VPN tunnel [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}]'
              tags:
                - tag: Component
                  value: GwVPN
              trigger_prototypes:
                - uuid: 4561d362106243c0bef50d5357ae0f33
                  expression: 'avg(/Watchguard Firewall/vpn.policy.ifOutErrors[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}],300s) > {$GWVPN_ERROR_THRESHOLD}'
                  name: 'GwVPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] Errors Out'
                  status: DISABLED
                  discover: NO_DISCOVER
                  priority: HIGH
                  description: 'Outbound errors on Gateway VPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] exceeded critical threshold ({ITEM.LASTVALUE} > {$GWVPN_ERROR_THRESHOLD}/s) within the last 5 minutes'
                  tags:
                    - tag: Component
                      value: GwVPN
                - uuid: c85d376f7b604ba08a32bb53588e4602
                  expression: 'avg(/Watchguard Firewall/vpn.policy.ifOutErrors[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}],300s) > {$GWVPN_WARNING_THRESHOLD}'
                  name: 'GwVPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] Errors Out'
                  priority: WARNING
                  description: 'Outbound errors on Gateway VPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] exceeded warning threshold ({ITEM.LASTVALUE} > {$GWVPN_WARNING_THRESHOLD}/s) within the last 5 minutes'
                  tags:
                    - tag: Component
                      value: GwVPN
            - uuid: 3c6d0169e5eb4bc5ac8fe2a6da35a4d6
              name: 'GwVPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] SA Lifetime'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.5.1.2.1.17.{#VPNINDEX}'
              key: 'vpn.policy.lifetime[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}]'
              value_type: CHAR
              trends: '0'
              tags:
                - tag: GwVPN
                  value: SecurityAssociation
            - uuid: 6e38304aac414a329194a1240788d3d8
              name: 'GwVPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.7.1.{#VPNINDEX}'
              key: 'vpn.policy.status[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}]'
              value_type: FLOAT
              status: DISABLED
              discover: NO_DISCOVER
              description: 'Status of VPN tunnel [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] (1=up, 0=down)'
              valuemap:
                name: interface.status.valuemap
              tags:
                - tag: Component
                  value: GwVPN
              trigger_prototypes:
                - uuid: dcfa13b84c1341c382b7138cc9981b3c
                  expression: 'count(/Watchguard Firewall/vpn.policy.status[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}],300,"ne")>2 and nodata(/Watchguard Firewall/vpn.policy.status[{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}],120s)=0'
                  name: 'GwVPN [{#LOCALONE}/{#LOCALTWO}→{#REMOTEONE}/{#REMOTETWO}] Flap Detected'
                  priority: AVERAGE
                  description: 'Should indicate if a single tunnel is flapping, investigate it if this happens.'
                  manual_close: 'YES'
                  tags:
                    - tag: VPN
                      value: Flap
        - uuid: 30253dfbef0b4849b4f51e0bc815934a
          name: Interfaces
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: interface.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#IFTYPE}'
                value: ^6$
                formulaid: A
          description: 'Discover Interfaces (ifType = 6)'
          item_prototypes:
            - uuid: 7d1ebdc1c66e45a4b6a8db1bb4b2be1c
              name: 'Interface: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'interface.ifInErrors[{#IFDESCR}]'
              description: 'Inbound errors on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Application
                  value: Interfaces
              trigger_prototypes:
                - uuid: 348b07d008854b899f9e94659405877f
                  expression: 'last(/Watchguard Firewall/interface.ifInErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_ERROR_THRESHOLD}'
                  name: 'Interface {#IFDESCR} Inbound Errors'
                  priority: HIGH
                - uuid: 1b9e2bce98494c6ebb34a9442aede8f6
                  expression: 'last(/Watchguard Firewall/interface.ifInErrors[{#IFDESCR}]) > {$WATCHGUARD_INTERFACE_WARNING_THRESHOLD}'
                  name: 'Interface {#IFDESCR} Inbound Warning'
                  priority: AVERAGE
            - uuid: 1bbe4491bab148d398ce4868d20fa140
              name: 'Interface: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'interface.ifInOctets[{#IFDESCR}]'
              units: Bps
              description: 'Incoming traffic on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Application
                  value: Interfaces
            - uuid: f750d8e05ca54716ad71706ddceade1e
              name: 'Interface: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'interface.ifOperStatus[{#IFDESCR}]'
              description: 'Operational status of interface {#IFDESCR}'
              valuemap:
                name: interface.status.valuemap
              tags:
                - tag: Application
                  value: Interfaces
              trigger_prototypes:
                - uuid: 9ce65072570a4ddf823a63e1ccd86295
                  expression: '(last(/Watchguard Firewall/interface.ifOperStatus[{#IFDESCR}],#1)<>last(/Watchguard Firewall/interface.ifOperStatus[{#IFDESCR}],#2))=1'
                  name: 'Interface {#IFDESCR} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: a460f11b55cf4d21a102846183d4656e
              name: 'Interface: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'interface.ifOutErrors[{#IFDESCR}]'
              description: 'Outbound errors on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Application
                  value: Interfaces
            - uuid: 2b9d96f7cffc4b06a50f264788a3542c
              name: 'Interface: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'interface.ifOutOctets[{#IFDESCR}]'
              units: Bps
              description: 'Outgoing traffic on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Application
                  value: Interfaces
          graph_prototypes:
            - uuid: 3d0f28c28e8149edaaad34aacca27515
              name: 'Interface: {#IFDESCR} Status'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'interface.ifOperStatus[{#IFDESCR}]'
            - uuid: 441c90eb2707495a8fffb78efc4bdba5
              name: 'Interface: {#IFDESCR} Traffic'
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Watchguard Firewall'
                    key: 'interface.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Watchguard Firewall'
                    key: 'interface.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'interface.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: 2774A4
                  calc_fnc: ALL
                  item:
                    host: 'Watchguard Firewall'
                    key: 'interface.ifOutErrors[{#IFDESCR}]'
        - uuid: 0fe9ccfaff514ddc95c8484e0eee14a5
          name: 'Power Supplies'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#PSU_NAME},1.3.6.1.4.1.3097.6.4.2.1.1]'
          key: psu.discovery
          delay: 1h
          status: DISABLED
          description: 'Currently, as of firebox v12.10 firmware, the SNMP OID published in their MIB pack, is NOT exposed over SNMPv2/v3 - suggesting this is a bug in the FW firmware.'
          item_prototypes:
            - uuid: f168009628b849788bea5a086d6f635f
              name: 'Power Supply {#PSU_NAME} Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.4.2.1.2.{#SNMPINDEX}'
              key: 'psu.status[{#PSU_NAME}]'
              value_type: FLOAT
              valuemap:
                name: psu.status.valuemap
              tags:
                - tag: Component
                  value: Power
              trigger_prototypes:
                - uuid: e7994f58fe0f451b90276ffdbc4d19bb
                  expression: 'min(/Watchguard Firewall/psu.status[{#PSU_NAME}],5m)<>1'
                  name: 'Power Supply {#PSU_NAME} Fault Detected'
                  priority: HIGH
                  description: 'Power supply {#PSU_NAME} is reporting a fault or has been disconnected.'
                  tags:
                    - tag: Component
                      value: Power
        - uuid: 36f6c341b9af4ccb9641fc003968f837
          name: 'Temperature Sensors'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.3097.6.3.1
          key: temp.discovery
          delay: 1h
          status: DISABLED
          filter:
            conditions:
              - macro: '{#SENSOR_TYPE}'
                value: temperature
                formulaid: A
          description: 'Currently, as of firebox v12.10 firmware, the SNMP OID published in their MIB pack, is NOT exposed over SNMPv2/v3 - suggesting this is a bug in the FW firmware.'
          item_prototypes:
            - uuid: 6bbe24e86cca4734b9435ded3b63a957
              name: 'Temperature Sensor {#SENSOR_NAME}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.3097.6.3.1.{#SNMPINDEX}'
              key: 'temperature.sensor[{#SENSOR_NAME}]'
              delay: 5m
              value_type: FLOAT
              units: °C
              description: 'Temperature reading from {#SENSOR_NAME} sensor'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.1'
              tags:
                - tag: Component
                  value: Temperature
              trigger_prototypes:
                - uuid: b86cb876da87465f8ccc9b7bbf9141d1
                  expression: 'last(/Watchguard Firewall/temperature.sensor[{#SENSOR_NAME}]) > {$WATCHGUARD_TEMP_CRITICAL}'
                  name: 'Critical Temperature on {#SENSOR_NAME}'
                  priority: HIGH
                  description: 'Temperature sensor {#SENSOR_NAME} is above critical threshold ({ITEM.LASTVALUE} > {$WATCHGUARD_TEMP_CRITICAL}°C)'
                  tags:
                    - tag: Component
                      value: Temperature
                - uuid: dc6ffe6c7e1f47c48f691e3494a7d8d5
                  expression: 'last(/Watchguard Firewall/temperature.sensor[{#SENSOR_NAME}]) > {$WATCHGUARD_TEMP_WARNING}'
                  name: 'High Temperature Warning on {#SENSOR_NAME}'
                  priority: WARNING
                  description: 'Temperature sensor {#SENSOR_NAME} is above warning threshold ({ITEM.LASTVALUE} > {$WATCHGUARD_TEMP_WARNING}°C)'
                  tags:
                    - tag: Component
                      value: Temperature
          graph_prototypes:
            - uuid: cf89c10b5d2b46ccb24cc4a6d6067852
              name: 'Temperature Trend - {#SENSOR_NAME}'
              graph_items:
                - color: FF0000
                  item:
                    host: 'Watchguard Firewall'
                    key: 'temperature.sensor[{#SENSOR_NAME}]'
      tags:
        - tag: Author
          value: 'Simon Jackson'
      macros:
        - macro: '{$BOVPN_ERROR_THRESHOLD}'
          value: '10'
        - macro: '{$BOVPN_WARNING_THRESHOLD}'
          value: '1'
        - macro: '{$GWVPN_ERROR_THRESHOLD}'
          value: '1000000'
        - macro: '{$GWVPN_WARNING_THRESHOLD}'
          value: '100000'
        - macro: '{$WATCHGUARD_CACHED_THRESHOLD}'
          value: '99'
        - macro: '{$WATCHGUARD_CLUSTER_HEALTH_PERCENT}'
          value: '90'
        - macro: '{$WATCHGUARD_CPU_HIGH}'
          value: '90'
        - macro: '{$WATCHGUARD_CPU_LOW}'
          value: '70'
        - macro: '{$WATCHGUARD_DISK_HIGH}'
          value: '90'
        - macro: '{$WATCHGUARD_DISK_LOW}'
          value: '80'
        - macro: '{$WATCHGUARD_FAN_MIN_SPEED}'
          value: '2000'
        - macro: '{$WATCHGUARD_HIGH_THROUGHPUT}'
          value: '1000000000'
        - macro: '{$WATCHGUARD_INTERFACE_ERROR_THRESHOLD}'
          value: '1000'
        - macro: '{$WATCHGUARD_INTERFACE_WARNING_THRESHOLD}'
          value: '100'
        - macro: '{$WATCHGUARD_MAX_CONNECTIONS}'
          value: '50000'
        - macro: '{$WATCHGUARD_SWAP_THRESHOLD}'
          value: '99'
        - macro: '{$WATCHGUARD_TEMP_CRITICAL}'
          value: '70'
        - macro: '{$WATCHGUARD_TEMP_WARNING}'
          value: '60'
      dashboards:
        - uuid: e056d7d058ee45309c64875fb4bfd5e1
          name: 'Watchguard Firebox'
          pages:
            - name: Cluster
              widgets:
                - type: problemsbysv
                  width: '30'
                  height: '1'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: reference
                      value: GZKAM
                    - type: INTEGER
                      name: show_timeline
                      value: '0'
                - type: honeycomb
                  name: 'Important Info'
                  'y': '1'
                  width: '30'
                  height: '3'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Cluster Synchronisation Status'
                    - type: STRING
                      name: items.1
                      value: 'Device Firmware'
                    - type: STRING
                      name: items.2
                      value: 'GAV Update'
                    - type: STRING
                      name: items.3
                      value: 'IPS Update'
                    - type: STRING
                      name: items.4
                      value: 'LiveSecurity Expires'
                    - type: STRING
                      name: items.5
                      value: 'Device Uptime'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: ZTIWL
                - type: svggraph
                  name: Traffic
                  'y': '4'
                  width: '46'
                  height: '3'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '0'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Traffic: Inbound'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '0'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'Traffic: Outbound'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '2'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: CIYCM
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: item
                  name: 'Connection Rate'
                  x: '30'
                  width: '8'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Watchguard Firewall'
                        key: connections.rate
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: STRING
                      name: units
                      value: /s
                - type: item
                  name: 'Active Connections'
                  x: '30'
                  'y': '2'
                  width: '8'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Watchguard Firewall'
                        key: connections.active
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                - type: svggraph
                  name: 'FireCluster Health'
                  x: '38'
                  width: '22'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00FFBF
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'FireCluster Primary Member * Health'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: 00BFFF
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'FireCluster Secondary Member * Health'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '6'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: GWZXM
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: gauge
                  x: '46'
                  'y': '4'
                  width: '14'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Watchguard Firewall'
                        key: watchguard.system.cpu.util
                    - type: STRING
                      name: max
                      value: '100'
                    - type: STRING
                      name: min
                      value: '0'
            - name: 'Branch Office VPNs'
              widgets:
                - type: honeycomb
                  name: 'BoVPN Statuses'
                  width: '21'
                  height: '13'
                  fields:
                    - type: STRING
                      name: items.0
                      value: '* Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: BoVPN
                    - type: INTEGER
                      name: maintenance
                      value: '1'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^BoVPN: (.+) Status$", "\1")}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: INTEGER
                      name: primary_label_size
                      value: '50'
                    - type: STRING
                      name: reference
                      value: JWFEG
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '2'
                - type: svggraph
                  name: 'BoVPN: Bytes In/Out'
                  x: '21'
                  width: '51'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00FF00
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'BoVPN: * Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: 0080FF
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'BoVPN: * Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '8'
                    - type: STRING
                      name: reference
                      value: TJAWZ
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'BoVPN: Errors In/Out'
                  x: '21'
                  'y': '5'
                  width: '51'
                  height: '3'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF8000
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'BoVPN: * Errors In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: INTEGER
                      name: ds.0.type
                      value: '2'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: ds.1.color
                      value: FF0000
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'BoVPN: * Errors Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: ds.1.type
                      value: '2'
                    - type: INTEGER
                      name: ds.1.width
                      value: '2'
                    - type: INTEGER
                      name: legend
                      value: '0'
                    - type: STRING
                      name: reference
                      value: JAFCO
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: problems
                  name: 'GwVPN: Problems'
                  x: '21'
                  'y': '8'
                  width: '51'
                  height: '5'
                  fields:
                    - type: STRING
                      name: problem
                      value: Errors
                    - type: STRING
                      name: reference
                      value: FRTVH
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '1'
                    - type: STRING
                      name: tags.0.tag
                      value: Component
                    - type: STRING
                      name: tags.0.value
                      value: BoVPN
            - name: 'Gateway VPNs'
              widgets:
                - type: honeycomb
                  name: 'GwVPN Tunnels (Unsupported in current firmware)'
                  width: '21'
                  height: '13'
                  fields:
                    - type: STRING
                      name: items.0
                      value: '* Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: GwVPN
                    - type: INTEGER
                      name: maintenance
                      value: '1'
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^GwVPN: (.+) Status$", "\1")}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: INTEGER
                      name: primary_label_size
                      value: '50'
                    - type: STRING
                      name: reference
                      value: GBEEE
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.1.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '2'
                - type: svggraph
                  name: 'GwVPN: Bytes In/Out'
                  x: '21'
                  width: '51'
                  height: '5'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00FF00
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'GwVPN * Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: 0080FF
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'GwVPN * Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '8'
                    - type: STRING
                      name: reference
                      value: TBGMU
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: svggraph
                  name: 'GwVPN: Errors In/Out'
                  x: '21'
                  'y': '5'
                  width: '51'
                  height: '3'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF4000
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'GwVPN * Errors In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: INTEGER
                      name: ds.0.type
                      value: '2'
                    - type: INTEGER
                      name: ds.0.width
                      value: '2'
                    - type: STRING
                      name: ds.1.color
                      value: FF0000
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'GwVPN * Errors Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: ds.1.type
                      value: '2'
                    - type: INTEGER
                      name: ds.1.width
                      value: '2'
                    - type: INTEGER
                      name: legend
                      value: '0'
                    - type: STRING
                      name: reference
                      value: JVRGX
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: problems
                  name: 'GwVPN: Problems'
                  x: '21'
                  'y': '8'
                  width: '51'
                  height: '5'
                  fields:
                    - type: STRING
                      name: problem
                      value: Errors
                    - type: STRING
                      name: reference
                      value: YIALR
                    - type: INTEGER
                      name: show
                      value: '2'
                    - type: INTEGER
                      name: tags.0.operator
                      value: '1'
                    - type: STRING
                      name: tags.0.tag
                      value: Component
                    - type: STRING
                      name: tags.0.value
                      value: GwVPN
      valuemaps:
        - uuid: 71a060a54ea2489b9997531e0de28103
          name: cluster.status.valuemap
          mappings:
            - value: '0'
              newvalue: N/A
            - value: '1'
              newvalue: Clustered
            - value: '2'
              newvalue: Standalone
        - uuid: bbe748f3a1a7405ab4c1e49d4e4eb75f
          name: cluster.sync.valuemap
          mappings:
            - value: '0'
              newvalue: 'Not Synchronized'
            - value: '1'
              newvalue: Synchronized
        - uuid: cddcb4c626d641759b26f30d7c8d129b
          name: fan.status.valuemap
          mappings:
            - value: '1'
              newvalue: OK
            - value: '2'
              newvalue: Fault
            - value: '3'
              newvalue: 'Not Present'
        - uuid: ba5c23563caa4ec1aaf4657ccb304f23
          name: feature.status.valuemap
          mappings:
            - value: '0'
              newvalue: Disabled
            - value: '1'
              newvalue: Enabled
        - uuid: 839e718ef97f40659f422cf5f603b17b
          name: interface.status.valuemap
          mappings:
            - value: '1'
              newvalue: Up
            - value: '2'
              newvalue: Down
            - value: '3'
              newvalue: Testing
            - value: '4'
              newvalue: Unknown
            - value: '5'
              newvalue: Dormant
            - value: '6'
              newvalue: 'Not Present'
            - value: '7'
              newvalue: 'Lower Layer Down'
        - uuid: e75ad32d175e4bc882730f78a60ae7f6
          name: member.role.valuemap
          mappings:
            - value: '1'
              newvalue: Rebooting
            - value: '2'
              newvalue: Standby
            - value: '3'
              newvalue: Master
        - uuid: 1ee381ecbce64a3eb2c75d9e4205954d
          name: psu.status.valuemap
          mappings:
            - value: '1'
              newvalue: OK
            - value: '2'
              newvalue: Fault
            - value: '3'
              newvalue: 'Not Present'
