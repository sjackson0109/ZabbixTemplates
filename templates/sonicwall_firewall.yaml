zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: c5381dc540504dbba10e2d300554e4cd
      name: Firewall
  templates:
    - uuid: fb23d8d3752b4d4e8d19afe70b430993
      template: Sonicwall
      name: Sonicwall
      description: |
        ## Overview    
        Complete Template for monitoring SonicWALL Firewalls.
        
        ITEMS:           
        - Basic Info: Uptime, Device Name, Model, Location, Description, Firmware, Ping, Latency, Packet-Loss
        - Firewall Info: Firmware Version, ROM Version
        - HA Info: Primary/Secondary Status, Primary/Secondary Serial
        - Device Utilisation: CPU, Cache, Memory, Swap (Not working yet)
        - Temperature (Not available on any Sonicwall firmware yet)
        - sonicStats: (Not available on some FW models)
        - WAN Interfaces
        
        ITEM-TRIGGERS:
        - HA: State Changes, Peer Status Issues
        - High no of concurrent connections > Possible DDoS Attack
        - CPU/Memory thresholds exceeded
        
        DISCOVERY ITEMS:
        - Ethernet Interfaces: Status, Bytes In/Out, Errors In/Out
        - VLAN Interfaces: Status, Bytes In/Out, Errors In/Out
        - PortShield Interfaces: Status, Bytes In/Out, Errors In/Out
        - VPN Policies: Status, Bytes In/Out, Errors In/Out
        - VTI Interfaces: Status, Bytes In/Out, Errors In/Out
        - License Features: GAV, Mail, IDS/IPS, AntiSpyware(ASW)


        DISCOVERY ITEM-TRIGGERS:
        - Interfaces: Status Changed, Error thresholds
        - VPN Tunnels: Status Changed
        
        + Graphs and Dashboards (Useful)
        
        TESTED ON:
        - SonicWall TZ, NSA, and SuperMassive series
        - Firmware versions 6.5.x and newer
        
        Author: Simon Jackson / @sjackson0109
      groups:
        - name: Firewall
      items:
        - uuid: ab8294f669e54a40acd47663fafb1a27
          name: 'Active Connections'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.2.0
          key: connections.active
          value_type: FLOAT
          units: connections
          description: 'Current active firewall connections'
          tags:
            - tag: Performance
              value: Metrics
          triggers:
            - uuid: 15badb8904af4b32bf2779791835105c
              expression: 'last(/Sonicwall/connections.active) > {$SONICWALL_DDOS_THRESHOLD}'
              name: 'Possible DDoS Attack'
              priority: AVERAGE
              description: 'Total connections ({ITEM.LASTVALUE}) exceeded threshold ({$SONICWALL_DDOS_THRESHOLD})'
              tags:
                - tag: Performance
                  value: Metrics
        - uuid: 31e66e3942ff44fb90b81ea85abcd944
          name: 'CPU Utilisation'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.3.0
          key: cpu.utilisation
          units: '%'
          description: 'Instantaneous RAM Utilisation in percent'
          tags:
            - tag: Component
              value: Memory
          triggers:
            - uuid: 9f180f268ee14701883cf6bb4aa80635
              expression: 'avg(/Sonicwall/cpu.utilisation,5m) > {$SONICWALL_CPU_ERROR}'
              name: 'High CPU Usage (Error)'
              priority: HIGH
              description: 'System processor usage exceeded critical threshold ({ITEM.LASTVALUE} > {$SONICWALL_CPU_ERROR%), on average over past 5 minutes'
              tags:
                - tag: Component
                  value: Memory
            - uuid: 7950a7db6ea94a9d981c7de4d92d56b4
              expression: 'avg(/Sonicwall/cpu.utilisation,5m) > {$SONICWALL_CPU_WARNING}'
              name: 'High CPU Usage (Warning)'
              priority: AVERAGE
              description: 'System processor usage exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_CPU_WARNING%), on average over past 5 minutes'
              tags:
                - tag: Component
                  value: Memory
        - uuid: 10e12f7f3d434f9fa8f182223973cc09
          name: 'Device Administrator'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.4.0
          key: device.admin
          delay: 5m
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'Device Administrator'
          tags:
            - tag: Component
              value: System
        - uuid: 000e78a73db74e568cf407866d5a3113
          name: 'Device Firmware Version'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: firmware
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Firmware version currently running on the SonicWall device.'
          inventory_link: SOFTWARE
          preprocessing:
            - type: REGEX
              parameters:
                - '^.*\((.*)\)$'
                - \1
            - type: STR_REPLACE
              parameters:
                - 'SonicOS '
                - ''
            - type: STR_REPLACE
              parameters:
                - 'Enhanced '
                - ''
          tags:
            - tag: Component
              value: System
        - uuid: 2eba2a5d85e5428d93b7b7d307525c0d
          name: 'Device Location'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.6.0
          key: location
          delay: 1h
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'Location currently running on the SonicWall device.'
          inventory_link: LOCATION
          tags:
            - tag: Component
              value: System
        - uuid: 821ab106202c4a62a3545d212b08bc6c
          name: 'Memory Utilisation'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.4.0
          key: memory.utilisation
          units: '%'
          description: 'Instantaneous RAM Utilisation in percent'
          tags:
            - tag: Component
              value: Memory
          triggers:
            - uuid: 52f99c32e8f1491691e40c31c519f5d2
              expression: 'last(/Sonicwall/memory.utilisation) > {$SONICWALL_MEMORY_ERROR}'
              name: 'High Memory Usage (Error)'
              priority: HIGH
              description: 'System memory usage exceeded critical threshold ({ITEM.LASTVALUE} > {$SONICWALL_MEMORY_ERROR}%)'
              tags:
                - tag: Component
                  value: Memory
            - uuid: 7c566e3d0d584c1889b9cd468485ecf4
              expression: 'last(/Sonicwall/memory.utilisation) > {$SONICWALL_MEMORY_WARNING}'
              name: 'High Memory Usage (Warning)'
              priority: AVERAGE
              description: 'System memory usage exceeded warning threshold ({ITEM.LASTVALUE} > {$SONICWALL_MEMORY_WARNING}%)'
              tags:
                - tag: Component
                  value: Memory
        - uuid: a0a0aa8098a74868ac05aad45fbbe25d
          name: 'Device Model'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.2.1.1.1.0
          key: model
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Model name or identifier of the SonicWall hardware.'
          inventory_link: MODEL
          tags:
            - tag: Component
              value: System
        - uuid: a22a81fe13e6467197ed76a7d3a99345
          name: 'Device Name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          key: name
          delay: 1h
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'An administratively-assigned name for this managed node.'
          inventory_link: NAME
          tags:
            - tag: Component
              value: System
        - uuid: 636c8a8b003d4235bf3b12d76da98bf0
          name: 'Device Primary Serial'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.2.1.1.2.0
          key: primary.serial
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Primary Serial Number'
          inventory_link: SERIALNO_A
          tags:
            - tag: Component
              value: System
        - uuid: 39f6c0007a104949b105645debe13922
          name: 'HA Primary Status'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.1.0
          key: primary.status
          delay: 1h
          value_type: FLOAT
          valuemap:
            name: sonicwall.ha.status.valuemap
          tags:
            - tag: Component
              value: HA
        - uuid: e8866dac9055439ca020af54663cdc3e
          name: 'Device ROM Version'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.2.1.1.4.0
          key: rom
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'ROM version currently running on the SonicWall device.'
          tags:
            - tag: Component
              value: System
        - uuid: b616f5b1ee8e48c384221421821c715c
          name: 'Device Secondary Serial'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.2.1.1.3.0
          key: secondary.serial
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Secondary Serial Number'
          inventory_link: SERIALNO_B
          tags:
            - tag: Component
              value: System
        - uuid: 95cb2764ee524b4694d0612c9e869292
          name: 'HA Secondary Status'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.2.0
          key: secondary.status
          value_type: FLOAT
          valuemap:
            name: sonicwall.ha.status.valuemap
          tags:
            - tag: Component
              value: HA
        - uuid: 1bd50e81a3644f8b9a1240320dcd555e
          name: sonicCFS
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.9.0
          key: sonicCFS
          description: 'Metrics returned from the sonicwallFwStats table'
          tags:
            - tag: Component
              value: FwStats
        - uuid: 88215cb400a44578ae9c9ce5899d2d17
          name: sonicCurrentConnCacheEntries
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.2.0
          key: sonicCurrentConnCacheEntries
          description: 'Metrics returned from the sonicwallFwStats table'
          tags:
            - tag: Component
              value: FwStats
        - uuid: 8075dddd2d4e4ceba3ca21a255c96d2e
          name: sonicCurrentCPUUtil
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.3.0
          key: sonicCurrentCPUUtil
          description: 'Metrics returned from the sonicwallFwStats table'
          tags:
            - tag: Component
              value: FwStats
        - uuid: df750f31668449b09e55c22544c7eb2e
          name: sonicCurrentFwdAndInspectCPUUtil
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.8.0
          key: sonicCurrentFwdAndInspectCPUUtil
          description: 'Metrics returned from the sonicwallFwStats table'
          tags:
            - tag: Component
              value: FwStats
        - uuid: 5af6a549048349efa150c9b33a643d97
          name: sonicCurrentManagementCPUUtil
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.7.0
          key: sonicCurrentManagementCPUUtil
          description: 'Metrics returned from the sonicwallFwStats table'
          tags:
            - tag: Component
              value: FwStats
        - uuid: 3e39c1102a09435da7def1f6f7c82d0b
          name: sonicCurrentRAMUtil
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.5.0
          key: sonicCurrentRAMUtil
          description: 'Metrics returned from the sonicwallFwStats table'
          tags:
            - tag: Component
              value: FwStats
        - uuid: 68433a0bf31442139f9c588683b84825
          name: sonicMaxConnCacheEntries
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.0
          key: sonicMaxConnCacheEntries
          description: 'Metrics returned from the sonicwallFwStats table'
          tags:
            - tag: Component
              value: FwStats
        - uuid: 91dd0953373049f186a0472510eba808
          name: sonicNatTranslationCount
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.6.0
          key: sonicNatTranslationCount
          description: 'Metrics returned from the sonicwallFwStats table'
          tags:
            - tag: Component
              value: FwStats
        - uuid: 64e1234d83894181ac5ef172e2e03e07
          name: 'Cache Utilisation'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.7.1.0
          key: sonicwall.cache.util
          units: Kb
          description: 'Cache Utilisation'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '8'
          tags:
            - tag: Component
              value: Memory
        - uuid: 0a227205065449ef9e9143ec4b297c86
          name: 'Memory Utilisation'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.25.1.7.1.0
          key: sonicwall.ram.util
          units: Kb
          description: 'Memory Utilisation'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '8'
          tags:
            - tag: Component
              value: Memory
        - uuid: c191a24b5b204501835dd3bcf16b1f2c
          name: 'Swap Utilisation'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.24.1.7.1.0
          key: sonicwall.swap.util
          units: Kb
          description: 'Swap Utilisation'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '8'
          tags:
            - tag: Component
              value: Memory
        - uuid: 27ae43ee1d874829af0ced3313609d6b
          name: 'Device Temperature'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.99.1.1.1.4.4
          key: temperature
          delay: 5m
          units: °C
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.1'
          tags:
            - tag: Component
              value: Temperature
          triggers:
            - uuid: 0d47b9c4560942a6a4ffd37a2b56f777
              expression: 'last(/Sonicwall/temperature) > {$SONICWALL_TEMP_ERROR}'
              name: 'Device Temperature Critical (>{$SONICWALL_TEMP_ERROR}°C)'
              priority: HIGH
              description: 'Device temperature ({ITEM.LASTVALUE}°C) exceeded critical threshold ({$SONICWALL_TEMP_ERROR}°C)'
              tags:
                - tag: Component
                  value: Temperature
            - uuid: 183528caeae54f58a5c4b3f086a412bd
              expression: 'last(/Sonicwall/temperature) > {$SONICWALL_TEMP_WARNING}'
              name: 'Device Temperature Warning (>{$SONICWALL_TEMP_WARNING}°C)'
              priority: WARNING
              description: 'Device temperature ({ITEM.LASTVALUE}°C) exceeded warning threshold ({$SONICWALL_TEMP_WARNING}°C)'
              tags:
                - tag: Component
                  value: Temperature
        - uuid: 07050a4878c549e894e016a7fe24181d
          name: 'Device Uptime'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysUpTime.0'
          key: uptime
          units: uptime
          description: 'The time since the network management portion of the system was last re-initialized.'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Component
              value: System
        - uuid: cd5a053b404448d5809621c103573a39
          name: 'WAN Interfaces'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.7.1.1.1.3.87.65.78
          key: zone.wan.ports
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Physical port assignments for WAN zone (e.g., "X1,X2")'
          preprocessing:
            - type: TRIM
              parameters:
                - '"'
          tags:
            - tag: Component
              value: Zone
            - tag: Zone
              value: WAN
      discovery_rules:
        - uuid: 41667e9384114b828459fb25a4c605d5
          name: 'Licensed Features [ASW]'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ASW_LICENSE},1.3.6.1.4.1.8741.1.3.1.8.0]'
          key: asw.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#ASW_LICENSE}'
                value: '1'
                formulaid: A
              - macro: '{#ASW_LICENSE}'
                value: '3'
                formulaid: B
          lifetime: 1d
          item_prototypes:
            - uuid: 776cea823ebd460dac46fed8a3338892
              name: 'AntiSpyware Scan Requests ({#ASW_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.5.2.1.0
              key: 'asw.scan.requests[{#ASW_LICENSE}]'
              units: scans
              description: 'Total number of AntiSpyware scan requests'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Security
                  value: AntiSpyware
            - uuid: eec8f68d142b46b6b5baf0239d055d89
              name: 'AntiSpyware Scan Time ({#ASW_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.5.2.4.0
              key: 'asw.scan.time[{#ASW_LICENSE}]'
              units: ms
              description: 'Average time taken for AntiSpyware scans'
              tags:
                - tag: Performance
                  value: AntiSpyware
              trigger_prototypes:
                - uuid: 20fedba77e2e428fa6c39e68e941ecb8
                  expression: 'avg(/Sonicwall/asw.scan.time[{#ASW_LICENSE}],5m) > {$SONICWALL_ASW_SCAN_TIME_THRESHOLD}'
                  name: 'High AntiSpyware Scan Time (CPU under load?)'
                  priority: AVERAGE
                  description: |
                    AntiSpyware scan time elevated for 5+ minutes (avg: {avg(/Sonicwall/asw.scan.time,5m):.0f}ms)
                    while at least one CPU core was > {$SONICWALL_CPU_WARNING}% (min: Core1={min(/Sonicwall/hrProcessorLoad[1],5m)}%, Core2={min(/Sonicwall/hrProcessorLoad[2],5m)}%).
                    Security scanning may be impacted by CPU contention.
                  manual_close: 'YES'
            - uuid: 9419bf5f668246d7be619a72363502aa
              name: 'AntiSpyware Threats Blocked ({#ASW_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.5.2.3.0
              key: 'asw.threats.blocked[{#ASW_LICENSE}]'
              units: threats
              description: 'Total number of spyware threats blocked'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Security
                  value: AntiSpyware
            - uuid: 580aa84226934bffa927cac6e1ca4238
              name: 'AntiSpyware Threats Detected ({#ASW_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.5.2.2.0
              key: 'asw.threats.detected[{#ASW_LICENSE}]'
              units: threats
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Security
                  value: AntiSpyware
              trigger_prototypes:
                - uuid: 0949580e893b42ecb17d1fd26910f4b7
                  expression: 'avg(/Sonicwall/asw.threats.detected[{#ASW_LICENSE}],300s) > {$SONICWALL_ASW_THREAT_THRESHOLD}'
                  name: 'Unusual AntiSpyware Threat Detection Rate'
                  priority: WARNING
                  description: 'AntiSpyware threat detection rate ({ITEM.LASTVALUE}/s) exceeded threshold ({$SONICWALL_ASW_THREAT_THRESHOLD}/s)'
                  manual_close: 'YES'
          graph_prototypes:
            - uuid: adaefe8c889742488a4721d049569573
              name: 'AntiSpyware Threats Detected vs Blocked'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'asw.threats.detected[{#ASW_LICENSE}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'asw.threats.blocked[{#ASW_LICENSE}]'
        - uuid: 58ebb24e494d4e7eb3437d95f9abfe58
          name: Processors
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},HOST-RESOURCES-MIB::hrProcessorLoad]'
          key: cpu.discovery
          delay: 1h
          description: 'Discover the processors of the firewall device'
          item_prototypes:
            - uuid: 503d76e0ce784d088c7768b3e14e7ff6
              name: 'CPU Utilisation {#SNMPINDEX}'
              type: SNMP_AGENT
              snmp_oid: 'HOST-RESOURCES-MIB::hrProcessorLoad.{#SNMPINDEX}'
              key: 'hrProcessorLoad[{#SNMPINDEX}]'
              units: '%'
              description: 'The average, over the last minute, of the percentage of time that this processor was not idle.'
              tags:
                - tag: CPU
                  value: Utilisation
              trigger_prototypes:
                - uuid: 891cd55755a648caba85846b80759bee
                  expression: 'last(/Sonicwall/hrProcessorLoad[{#SNMPINDEX}],#1:now-300s)>{$SONICWALL_CPU_ERROR}'
                  name: 'CPU {#SNMPINDEX} Utilisation over {$SONICWALL_CPU_ERROR}%'
                  priority: WARNING
                  description: 'CPU {#SNMPINDEX} on {HOST.NAME} is over {$SONICWALL_CPU_ERROR}%'
                  tags:
                    - tag: CPU
                      value: Utilisation
          graph_prototypes:
            - uuid: 282f59dcf7854b6cab11bde4636e56f5
              name: 'Processor Utilisation{#SNMPINDEX}'
              width: '600'
              height: '340'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - color: 1A7C11
                  item:
                    host: Sonicwall
                    key: 'hrProcessorLoad[{#SNMPINDEX}]'
        - uuid: d4f4a7d0e4d04102b7092c4b8d7b8fe1
          name: 'Licensed Features [GAV]'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#GAV_LICENSE},1.3.6.1.4.1.8741.1.3.1.7.0]'
          key: gav.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#GAV_LICENSE}'
                value: '1'
                formulaid: A
          lifetime: 1d
          item_prototypes:
            - uuid: 230a69f6142c4499a605bced9bf6e7e3
              name: 'GAV Scan Count ({#GAV_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.5.1.1.0
              key: 'gav.scan.count[{#GAV_LICENSE}]'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
            - uuid: 50f9cd82709c47ee831a5ff9749ac0ee
              name: 'GAV Virus Count ({#GAV_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.5.1.2.0
              key: 'gav.virus.count[{#GAV_LICENSE}]'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
          graph_prototypes:
            - uuid: eb59ecdb7abf40819950450993c1069c
              name: 'GAV Activity'
              graph_items:
                - color: 00FF00
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'gav.scan.count[{#GAV_LICENSE}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'gav.virus.count[{#GAV_LICENSE}]'
        - uuid: 92c2c17fc43047128f217364187b0b6b
          name: 'Licensed Features [IDS]'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IDS_LICENSE},1.3.6.1.4.1.8741.1.3.1.10.0]'
          key: ids.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#IDS_LICENSE}'
                value: '1'
                formulaid: A
          lifetime: 1d
          item_prototypes:
            - uuid: ad876b04a8dd491f9a01adfad5ce71b8
              name: 'IDS Attacks Blocked ({#IDS_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.6.2.2.0
              key: 'ids.attacks.blocked[{#IDS_LICENSE}]'
              units: attacks
              description: 'Total number of attacks blocked by IDS'
            - uuid: 5700d4114d5849d5b714ba54dd36641d
              name: 'IDS Attacks Detected ({#IDS_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.6.2.1.0
              key: 'ids.detected[{#IDS_LICENSE}]'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
          graph_prototypes:
            - uuid: 121c202e42784b0aaae631d498e14b68
              name: 'IDS Activity'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'ids.detected[{#IDS_LICENSE}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'ids.attacks.blocked[{#IDS_LICENSE}]'
        - uuid: e6e32eb374ea4517871ab696cb2917b6
          name: 'Physical Interfaces'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFINDEX},IF-MIB::ifIndex, {#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: interface.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFDESCR}'
                value: '^.*\(Unassigned\)$'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#IFDESCR}'
                value: '^Portshielded To .*$'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#IFTYPE}'
                value: ^(6|161)$
                formulaid: C
          description: 'Discover physical interfaces include Ethernet or LAG (ifType = 6|161)'
          item_prototypes:
            - uuid: ea03a12ce8ce47b0aa0cf8d91ebb623a
              name: 'Interface: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'interface.ifInErrors[{#IFDESCR}]'
              description: 'Inbound errors on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Errors
              trigger_prototypes:
                - uuid: 1ea5c9dfb4cd47fab81c6174bd81fa26
                  expression: 'last(/Sonicwall/interface.ifInErrors[{#IFDESCR}]) > {$SONICWALL_INTERFACE_ERROR}'
                  name: 'Interface {#IFDESCR} Inbound Errors'
                  priority: WARNING
                  description: 'Inbound errors on interface {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_INTERFACE_ERROR}/s)'
                  tags:
                    - tag: Interface
                      value: Errors
            - uuid: 975303619c04411bb9bf189f4c535c5e
              name: 'Interface: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'interface.ifInOctets[{#IFDESCR}]'
              units: Bps
              description: 'Incoming traffic on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Traffic
            - uuid: 96fb55e64c97475d80a610214520e718
              name: 'Interface: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'interface.ifOutErrors[{#IFDESCR}]'
              description: 'Outbound errors on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Errors
              trigger_prototypes:
                - uuid: ddc2036479e042f69748eb221cf1aa26
                  expression: 'last(/Sonicwall/interface.ifOutErrors[{#IFDESCR}]) > {$SONICWALL_INTERFACE_ERROR}'
                  name: 'Interface {#IFDESCR} Outbound Errors'
                  priority: WARNING
                  description: 'Outbound errors on interface {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_INTERFACE_ERROR}/s)'
                  tags:
                    - tag: Interface
                      value: Errors
            - uuid: 690b15f964de4ab7af94c963249d2816
              name: 'Interface: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'interface.ifOutOctets[{#IFDESCR}]'
              units: Bps
              description: 'Outgoing traffic on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Traffic
            - uuid: 36adeb4a0ab14a4ab2daefc352ed1ef5
              name: 'Interface: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'interface.status[{#IFDESCR}]'
              description: 'Operational status of interface {#IFDESCR}'
              valuemap:
                name: sonicwall.interface.status.valuemap
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Status
              trigger_prototypes:
                - uuid: c5fdc6304b3b4b24a51668859dded4ef
                  expression: '(last(/Sonicwall/interface.status[{#IFDESCR}],#1)<>last(/Sonicwall/interface.status[{#IFDESCR}],#2))=1'
                  name: 'Interface {#IFDESCR} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: Interface
                      value: Status
          graph_prototypes:
            - uuid: 1a03d9e6aa9a4a7d95a497881a722894
              name: 'Interface: {#IFDESCR} Status'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'interface.status[{#IFDESCR}]'
            - uuid: 45a4bba63890410ba1e796a7319d08c7
              name: 'Interface: {#IFDESCR} Traffic'
              graph_items:
                - color: 1A7C11
                  item:
                    host: Sonicwall
                    key: 'interface.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: Sonicwall
                    key: 'interface.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 4CAF50
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'interface.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: EF5350
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'interface.ifOutErrors[{#IFDESCR}]'
        - uuid: e42cd2dc421e45fdb7e834ff217fc226
          name: 'Licensed Features [IPS]'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IPS_LICENSE},1.3.6.1.4.1.8741.1.3.1.9.0]'
          key: ips.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#IPS_LICENSE}'
                value: '1'
                formulaid: A
          lifetime: 1d
          item_prototypes:
            - uuid: fabb8b1fd2284e52ab804e1b3aeba46d
              name: 'IPS Attacks Blocked ({#IPS_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.6.1.1.0
              key: 'ips.blocked.count[{#IPS_LICENSE}]'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
          graph_prototypes:
            - uuid: c79aa1516dc245ddafa244c074b4d396
              name: 'IPS Attacks Blocked'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'ips.blocked.count[{#IPS_LICENSE}]'
        - uuid: 298be1eb79004ae9ba28995aeff057e0
          name: 'Licensed Features [MAIL]'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#MAIL_LICENSE},1.3.6.1.4.1.8741.1.3.1.6.0]'
          key: mail.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#MAIL_LICENSE}'
                value: '1'
                formulaid: A
          lifetime: 1d
          item_prototypes:
            - uuid: 583a9eb670824e8fbc2748bcc1902a0f
              name: 'Mail Good Allowed ({#MAIL_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.4.2.0
              key: 'mail.good.allowed[{#MAIL_LICENSE}]'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
            - uuid: f215d1044787409c8ed1d801e376781d
              name: 'Mail Spam Detected ({#MAIL_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.4.3.0
              key: 'mail.spam.count[{#MAIL_LICENSE}]'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
            - uuid: 71f2827827694e27950efdc26b648135
              name: 'Mail Total Count ({#MAIL_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.4.1.0
              key: 'mail.total.count[{#MAIL_LICENSE}]'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
            - uuid: 13e7fa716385460b8280ff5afd54537b
              name: 'Mail Virus Detected ({#MAIL_LICENSE})'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.4.5.0
              key: 'mail.virus.detected[{#MAIL_LICENSE}]'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - '3600'
          graph_prototypes:
            - uuid: 2a3c1e7af149448eafe0f7cc126476b9
              name: 'Mail Security Activity'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'mail.good.allowed[{#MAIL_LICENSE}]'
                - sortorder: '1'
                  drawtype: BOLD_LINE
                  color: BF00FF
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'mail.spam.count[{#MAIL_LICENSE}]'
                - sortorder: '2'
                  drawtype: DOTTED_LINE
                  color: 2774A4
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'mail.total.count[{#MAIL_LICENSE}]'
                - sortorder: '3'
                  drawtype: BOLD_LINE
                  color: FF0000
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'mail.virus.detected[{#MAIL_LICENSE}]'
        - uuid: e196ed9c5c414ee997a5c1bd50d7ad05
          name: 'PortShield Interfaces'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFINDEX},IF-MIB::ifIndex, {#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: portshield.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFDESCR}'
                value: '^Portshielded To .*$'
                formulaid: A
              - macro: '{#IFTYPE}'
                value: ^(6|161)$
                formulaid: B
          description: 'Discover physical interfaces include Ethernet or LAG (ifType = 6|161)'
          item_prototypes:
            - uuid: d70c5c50e09e4facbc985381611bdb10
              name: 'PortShield: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'portshield.ifInOctets[{#IFDESCR}]'
              units: Bps
              description: 'Incoming traffic on interface {#IFDESCR}'
            - uuid: 39ac767eb6114c5f9b4ca3426000b3c8
              name: 'PortShield: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'portshield.ifOutOctets[{#IFDESCR}]'
              units: Bps
              description: 'Outbound traffic on interface {#IFDESCR}'
            - uuid: 2a8785b7013840e9922f013791222f69
              name: 'PortShield: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'portshield.status[{#IFDESCR}]'
              description: 'Operational status of interface {#IFDESCR}'
              tags:
                - tag: Interface
                  value: Status
              trigger_prototypes:
                - uuid: 0645e22cc1d64d04a70040d2b426c0b2
                  expression: '(last(/Sonicwall/portshield.status[{#IFDESCR}],#1)<>last(/Sonicwall/portshield.status[{#IFDESCR}],#2))=1'
                  name: 'PortShield: {#IFDESCR} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
          graph_prototypes:
            - uuid: 8b6c0973bd924d2db67cb089cfe4f695
              name: 'PortShield: {#IFDESC} Traffic'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'portshield.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'portshield.ifOutOctets[{#IFDESCR}]'
        - uuid: d2640a528715449a88ff9ecbcd2086e5
          name: 'VLAN Interfaces'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFINDEX},IF-MIB::ifIndex, {#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: vlan.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFTYPE}'
                value: ^(135|53)$
                formulaid: A
          description: 'Discover physical interfaces types include VLANs (ifType = 53) and the router sub-interface (ifType = 135)'
          item_prototypes:
            - uuid: 2a15151dc9bb4deaab667f5e44dc963b
              name: 'VLAN: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'vlan.ifInErrors[{#IFDESCR}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: VLAN
              trigger_prototypes:
                - uuid: a62f49f6073740658b7c9b19f3d43ef4
                  expression: 'last(/Sonicwall/vlan.ifInErrors[{#IFDESCR}]) > {$SONICWALL_VLAN_WARNING}'
                  name: 'VLAN {#IFDESCR} Inbound Errors'
                  priority: WARNING
                  description: 'Inbound errors on VLAN {#IFDESCR} exceeded warning threshold ({ITEM.LASTVALUE} > {$SONICWALL_VLAN_WARNING}/s)'
            - uuid: 10866c4d787342cba3ebfa2360488962
              name: 'VLAN: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'vlan.ifInOctets[{#IFDESCR}]'
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: VLAN
            - uuid: 3ec81e3336ea4d57885ff531ad3630d0
              name: 'VLAN: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'vlan.ifOutErrors[{#IFDESCR}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: VLAN
              trigger_prototypes:
                - uuid: f9492c04fd4c42919b71178695288620
                  expression: 'last(/Sonicwall/vlan.ifOutErrors[{#IFDESCR}]) > {$SONICWALL_VLAN_WARNING}'
                  name: 'VLAN {#IFDESCR} Outbound Errors'
                  priority: WARNING
                  description: 'Outbound errors on VLAN {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_VLAN_WARNING}/s)'
            - uuid: f82c20ffb87143afb0f0606bfe47f98e
              name: 'VLAN: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'vlan.ifOutOctets[{#IFDESCR}]'
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: VLAN
          graph_prototypes:
            - uuid: 2b7646f0fbf341c2983e8d62b13562b6
              name: 'VLAN: {#IFDESCR} Traffic'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vlan.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vlan.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 66BB6A
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vlan.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: E57373
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vlan.ifOutErrors[{#IFDESCR}]'
        - uuid: 5b8828f520044cb4aee1248934790d9b
          name: 'VPN Policies'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#VPNNAME},1.3.6.1.2.1.2.2.1.2,{#VPNINDEX},1.3.6.1.2.1.2.2.1.1,{#VPNADMIN},1.3.6.1.2.1.2.2.1.7,{#MODEL},1.3.6.1.4.1.8741.2.1.1.1.0]'
          key: vpn.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#MODEL}'
                value: '^(?!.*NSa 3650).*'
                formulaid: A
              - macro: '{#VPNADMIN}'
                value: ^1$
                formulaid: B
              - macro: '{#VPNNAME}'
                value: '^(?!.*BACKEND).*'
                formulaid: C
          description: 'Discover policy-based VPN tunnels. Excluding \n - NSM based "BACKEND" tunnels \n - Tunnels administratively DISABLED \n - Firewalls with "NSa 3650" model, firmware never exposed tunnel statistics over snmp.'
          item_prototypes:
            - uuid: 3c1bb76ca478444db54d7f394e046c23
              name: 'VPN: {#VPNNAME} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'vpn.ifInErrors[{#VPNNAME}]'
              status: DISABLED
              description: 'Errors In counter not exposed during testing - Bug in the Sonicwall Firmware?'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: VPN
                  value: Traffic
              trigger_prototypes:
                - uuid: b2f59c886b324cd88518d38dca6c0244
                  expression: 'last(/Sonicwall/vpn.ifInErrors[{#VPNNAME}]) > {$SONICWALL_VPN_CRITICAL_THRESHOLD}'
                  name: 'VPN {#VPNNAME} Inbound Errors (Error)'
                  status: DISABLED
                  priority: HIGH
                  description: 'Errors In counter not exposed during testing - Bug in the Sonicwall Firmware?'
                - uuid: 0b5b79c341af4a4382c02676b245dd38
                  expression: 'last(/Sonicwall/vpn.ifInErrors[{#VPNNAME}]) > {$SONICWALL_VPN_WARNING_THRESHOLD}'
                  name: 'VPN {#VPNNAME} Inbound Errors (Warning)'
                  status: DISABLED
                  priority: AVERAGE
                  description: 'Errors In counter not exposed during testing - Bug in the Sonicwall Firmware?'
            - uuid: 4a06318935bd4a8d803dd9109db9ba7e
              name: 'VPN: {#VPNNAME} Bytes In'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.8741.1.3.2.1.1.1.6.{#VPNINDEX}'
              key: 'vpn.ifInOctets[{#VPNNAME}]'
              status: DISABLED
              units: bps
              description: 'BytesIn counter not exposed during testing - Bug in the Sonicwall Firmware?'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: VPN
                  value: Traffic
            - uuid: d203b3c848c04e94aaa799ba6af8dac0
              name: 'VPN: {#VPNNAME} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'vpn.ifOutErrors[{#VPNNAME}]'
              status: DISABLED
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: VPN
                  value: Traffic
              trigger_prototypes:
                - uuid: 1379731bc5b0416abb4fd261fac82c79
                  expression: 'last(/Sonicwall/vpn.ifOutErrors[{#VPNNAME}]) > {$SONICWALL_VPN_CRITICAL_THRESHOLD}'
                  name: 'VPN {#VPNNAME} Outbound Errors (Error)'
                  status: DISABLED
                  priority: HIGH
                  description: 'IfOutErrors In counter not exposed during testing - Bug in the Sonicwall Firmware?'
                - uuid: e8c4770f6c18443a89d3009bef1a2ce2
                  expression: 'last(/Sonicwall/vpn.ifOutErrors[{#VPNNAME}]) > {$SONICWALL_VPN_WARNING_THRESHOLD}'
                  name: 'VPN {#VPNNAME} Outbound Errors (Warning)'
                  status: DISABLED
                  priority: AVERAGE
                  description: 'IfOutErrors In counter not exposed during testing - Bug in the Sonicwall Firmware?'
            - uuid: 5c4f71c24d51433fa572275b0726f2f1
              name: 'VPN: {#VPNNAME} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.8741.1.3.2.1.1.1.7.{#VPNINDEX}'
              key: 'vpn.ifOutOctets[{#VPNNAME}]'
              status: DISABLED
              units: bps
              description: 'Bytes In counter not exposed during testing - Bug in the Sonicwall Firmware?'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: VPN
                  value: Traffic
            - uuid: 803ca2150a6940d38363649cfa3e019d
              name: 'VPN: {#VPNNAME} Status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.8741.1.3.2.1.1.1.8.{#VPNINDEX}'
              key: 'vpn.status[{#VPNNAME}]'
              status: DISABLED
              valuemap:
                name: sonicwall.vpn.status.valuemap
              tags:
                - tag: Component
                  value: VPN
              trigger_prototypes:
                - uuid: 5e016d178d42463da36607da2c11536a
                  expression: |
                    last(/Sonicwall/vpn.status[{#VPNNAME}],#1)<>last(/Sonicwall/vpn.status[{#VPNNAME}],#5)
                    and nodata(/Sonicwall/vpn.status[{#VPNNAME}],120s)=0
                  name: 'VPN Tunnel {#VPNNAME} status changed'
                  status: DISABLED
                  priority: AVERAGE
                  description: 'Status counter not exposed during testing - Bug in the Sonicwall Firmware?'
                  manual_close: 'YES'
          graph_prototypes:
            - uuid: 936c390f10d24e639097fcee6f90b939
              name: 'VPN: {#VPNNAME} Status'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vpn.status[{#VPNNAME}]'
            - uuid: dc809c23462c460ebb13a0ade5159b38
              name: 'VPN: {#VPNNAME} Traffic'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vpn.ifInOctets[{#VPNNAME}]'
                - sortorder: '1'
                  color: FF0000
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vpn.ifOutOctets[{#VPNNAME}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 66BB6A
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vpn.ifInErrors[{#VPNNAME}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: F44336
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vpn.ifOutErrors[{#VPNNAME}]'
        - uuid: f6bb4d46dd22461c83472971b98a07c2
          name: 'VPN Interfaces (VTI)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFINDEX},IF-MIB::ifIndex, {#VTINAME},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: vti.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#IFTYPE}'
                value: ^131$
                formulaid: A
          description: 'Discover route-based VPN interfaces (ifType=131)'
          item_prototypes:
            - uuid: c07868e00c92478a92098e28c7ef58fb
              name: 'VTI: {#VTINAME} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'vti.bytesIn[{#VTINAME}]'
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: VPN
                  value: Traffic
            - uuid: b50e7769e7384bc190dc24773b45a2c4
              name: 'VTI: {#VTINAME} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'vti.bytesOut[{#VTINAME}]'
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: VPN
                  value: Traffic
            - uuid: f6aee31a88024fb490f2b94098327380
              name: 'VTI: {#VTINAME} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'vti.errorsIn[{#VTINAME}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: VPN
                  value: Traffic
              trigger_prototypes:
                - uuid: 36326c71d1654a30aa3fbad79539eeda
                  expression: 'last(/Sonicwall/vti.errorsIn[{#VTINAME}]) > {$SONICWALL_VPN_ERROR}'
                  name: 'VTI: {#VTINAME} Inbound Errors'
                  priority: HIGH
                - uuid: bc04567371fe42b7839411dfc8da4f50
                  expression: 'last(/Sonicwall/vti.errorsIn[{#VTINAME}]) > {$SONICWALL_VPN_WARNING_THRESHOLD}'
                  name: 'VTI: {#VTINAME} Inbound Warning'
                  priority: AVERAGE
            - uuid: 09ffdad6ae16442a9b10ba37c2b89842
              name: 'VTI: {#VTINAME} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'vti.errorsOut[{#VTINAME}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: VPN
                  value: Traffic
              trigger_prototypes:
                - uuid: 893bc0b990d64e118039f0d8e6b6bbf0
                  expression: 'last(/Sonicwall/vti.errorsOut[{#VTINAME}]) > {$SONICWALL_VPN_ERROR}'
                  name: 'VTI: {#VTINAME} Outbound Errors'
                  priority: HIGH
                - uuid: f6c4bd1e1ccb48e9a86586b9ff5c2a5f
                  expression: 'last(/Sonicwall/vti.errorsOut[{#VTINAME}]) > {$SONICWALL_VPN_WARNING_THRESHOLD}'
                  name: 'VTI: {#VTINAME} Outbound Warning'
                  priority: AVERAGE
            - uuid: 7b173c18fc024e99a84e389f9706e21a
              name: 'VTI: {#VTINAME} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'vti.ifOperStatus[{#VTINAME}]'
              valuemap:
                name: sonicwall.interface.status.valuemap
              tags:
                - tag: Component
                  value: VTI
              trigger_prototypes:
                - uuid: f094bd2abb4a40a48fdfdf1aa71cb382
                  expression: 'last(/Sonicwall/vti.ifOperStatus[{#VTINAME}],#1)<>last(/Sonicwall/vti.ifOperStatus[{#VTINAME}],#5:now-5m)=1'
                  name: 'VTI: {#VTINAME} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: Component
                      value: VPN
          graph_prototypes:
            - uuid: 81de206a841749b797fe8581df193a6d
              name: 'VTI: {#VTINAME} Status'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vti.ifOperStatus[{#VTINAME}]'
            - uuid: ac9b24f725a5471d9f3befefa3a5f43a
              name: 'VTI: {#VTINAME} Traffic'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vti.bytesIn[{#VTINAME}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vti.bytesOut[{#VTINAME}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 66BB6A
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vti.errorsIn[{#VTINAME}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: E57373
                  calc_fnc: ALL
                  item:
                    host: Sonicwall
                    key: 'vti.errorsOut[{#VTINAME}]'
      tags:
        - tag: Author
          value: 'Simon Jackson'
      macros:
        - macro: '{$SONICWALL_ASW_SCAN_TIME_THRESHOLD}'
          value: '30'
        - macro: '{$SONICWALL_ASW_THREAT_THRESHOLD}'
          value: '10'
        - macro: '{$SONICWALL_CPU_ERROR}'
          value: '90'
        - macro: '{$SONICWALL_CPU_WARNING}'
          value: '80'
        - macro: '{$SONICWALL_DDOS_THRESHOLD}'
          value: '50000'
        - macro: '{$SONICWALL_DISK_ERROR}'
          value: '90'
        - macro: '{$SONICWALL_DISK_WARNING}'
          value: '80'
        - macro: '{$SONICWALL_GAV_VIRUS_THRESHOLD}'
          value: '5'
        - macro: '{$SONICWALL_HA_ANOMOLY_HIGH_THRESHOLD}'
          value: '10000'
        - macro: '{$SONICWALL_HA_ANOMOLY_LOW_THRESHOLD}'
          value: '100'
        - macro: '{$SONICWALL_INTERFACE_ERROR}'
          value: '10'
        - macro: '{$SONICWALL_IPS_ATTACK_THRESHOLD}'
          value: '10'
        - macro: '{$SONICWALL_MEMORY_ERROR}'
          value: '90'
        - macro: '{$SONICWALL_MEMORY_WARNING}'
          value: '80'
        - macro: '{$SONICWALL_SWAP_WARNING}'
          value: '70'
        - macro: '{$SONICWALL_TEMP_ERROR}'
          value: '70'
        - macro: '{$SONICWALL_TEMP_WARNING}'
          value: '60'
        - macro: '{$SONICWALL_VLAN_ERROR}'
          value: '10'
        - macro: '{$SONICWALL_VLAN_WARNING}'
          value: '10'
        - macro: '{$SONICWALL_VPN_ERROR}'
          value: '5'
      dashboards:
        - uuid: abbbec0248734fc58ae96712a5cf32e6
          name: SonicWALL
          pages:
            - name: HA
              widgets:
                - type: problemsbysv
                  width: '32'
                  height: '1'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: reference
                      value: YKUZB
                - type: svggraph
                  name: 'HA Member Sync'
                  'y': '1'
                  width: '36'
                  height: '3'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00FF00
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'HA Primary Status'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: 00BFFF
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'HA Secondary Status'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: STRING
                      name: reference
                      value: QKEVM
                    - type: INTEGER
                      name: righty
                      value: '0'
            - name: Interfaces
              widgets:
                - type: honeycomb
                  name: 'Interface Errors'
                  width: '25'
                  height: '8'
                  fields:
                    - type: INTEGER
                      name: interpolation
                      value: '1'
                    - type: STRING
                      name: items.0
                      value: '* Errors *'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: Interface
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^Interface: (.+) Errors (In|Out)$", "\1")}'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: STRING
                      name: reference
                      value: ZEVFJ
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: '666699'
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '2'
                - type: svggraph
                  name: 'Interface: Bytes In/Out'
                  x: '25'
                  width: '47'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface: X* Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'Interface: X* Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '8'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: XEPAL
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'Interface: Errors In/Out'
                  x: '25'
                  'y': '4'
                  width: '47'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface: X* Errors In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'Interface: X* Errors Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '8'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: SEDGX
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
            - name: VLANs
              widgets:
                - type: honeycomb
                  name: 'VLAN Errors (indicates a possible VLAN communication problem)'
                  width: '25'
                  height: '8'
                  fields:
                    - type: INTEGER
                      name: interpolation
                      value: '1'
                    - type: STRING
                      name: items.0
                      value: 'VLAN: * Errors *'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: VLAN
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^VLAN: (.+) Errors (In|Out)$", "\1")}'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: STRING
                      name: reference
                      value: SVIZL
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: '666699'
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '2'
                - type: graphprototype
                  name: 'VLAN: Traffic'
                  x: '25'
                  width: '39'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: Sonicwall
                        name: 'VLAN: {#IFDESCR} Traffic'
                    - type: STRING
                      name: reference
                      value: AGVQQ
            - name: 'VPNs (VTI)'
              widgets:
                - type: honeycomb
                  name: 'VTI Statuses'
                  width: '24'
                  height: '8'
                  fields:
                    - type: INTEGER
                      name: interpolation
                      value: '1'
                    - type: STRING
                      name: items.0
                      value: '* Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: VTI
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^VTI: (.+) Status$", "\1")}'
                    - type: STRING
                      name: reference
                      value: TFRQV
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: '666699'
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '2'
                - type: svggraph
                  name: 'VTI: Bytes In/Out'
                  x: '24'
                  width: '48'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VTI: * Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'VTI: * Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '3'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: UDDVX
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'VTI: Errors In/Out'
                  x: '24'
                  'y': '4'
                  width: '48'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VTI: Errors In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'VTI: * Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '3'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: TLIOJ
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
            - name: 'VPNs (Policy)'
              widgets:
                - type: honeycomb
                  name: 'VTI Statuses'
                  width: '24'
                  height: '8'
                  fields:
                    - type: INTEGER
                      name: interpolation
                      value: '1'
                    - type: STRING
                      name: items.0
                      value: '* Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: VPN
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^VPN: (.+) Status$", "\1")}'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: STRING
                      name: reference
                      value: TCHRH
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: '666699'
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '2'
                - type: svggraph
                  name: 'VPN: Bytes In/Out'
                  x: '24'
                  width: '48'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VPN: * Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'VPN: * Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '3'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: TGCPP
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'VPN: Errors In/Out'
                  x: '24'
                  'y': '4'
                  width: '48'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VPN: * Errors In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'VPN: * Errors Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '3'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: CWMGQ
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
      valuemaps:
        - uuid: ccaf690dc4e045c8946a7ef3e93e305b
          name: sonicwall.ha.status.valuemap
          mappings:
            - value: '0'
              newvalue: Standalone
            - value: '125000'
              newvalue: Active
            - value: '375000'
              newvalue: Active
            - value: '1000000'
              newvalue: Active
            - type: LESS_OR_EQUAL
              value: '99999'
              newvalue: Passive
            - type: GREATER_OR_EQUAL
              value: '1000001'
              newvalue: Unknown/Unexpected
        - uuid: ffd27061e43a4463acd2abe95f3f83d4
          name: sonicwall.interface.status.valuemap
          mappings:
            - value: '1'
              newvalue: Up
            - value: '2'
              newvalue: Down
            - value: '3'
              newvalue: Testing
            - value: '4'
              newvalue: Unknown
            - value: '5'
              newvalue: Dormant
            - value: '6'
              newvalue: 'Not Present'
            - value: '7'
              newvalue: 'Lower Layer Down'
        - uuid: 047402633de04c5ba71b55790ecc24ab
          name: sonicwall.vpn.status.valuemap
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
  triggers:
    - uuid: 0187ded2173647a7a1910004f02ea9e1
      expression: |
        ( avg(/Sonicwall/primary.status,10m) > {$SONICWALL_HA_ANOMOLY_HIGH_THRESHOLD} )
        or
        ( avg(/Sonicwall/secondary.status,10m) < {$SONICWALL_HA_ANOMOLY_LOW_THRESHOLD} )
      name: 'HA Anomaly Detected (Sustained Member Fault or Sync Drift)'
      priority: HIGH
      description: |
        High Availability issue detected:
        - Primary status sustained above {$SONICWALL_HA_ANOMOLY_HIGH_THRESHOLD} (possible reboot or promotion)
        - OR Secondary status dropped below {$SONICWALL_HA_ANOMOLY_LOW_THRESHOLD} (sync issues, heartbeat loss)
        
        10-minute average — 
        Primary: {avg(/Sonicwall/primary.status,10m)}
        Secondary: {avg(/Sonicwall/secondary.status,10m)}
      manual_close: 'YES'
      tags:
        - tag: Component
          value: HA
  graphs:
    - uuid: a7920ce8aaba44939c4c699d59f0759d
      name: 'Memory Utilisation'
      graph_items:
        - sortorder: '2'
          color: 00BFFF
          item:
            host: Sonicwall
            key: memory.utilisation
