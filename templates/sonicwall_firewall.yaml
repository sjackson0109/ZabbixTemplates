zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: c5381dc540504dbba10e2d300554e4cd
      name: Firewall
  templates:
    - uuid: fb23d8d3752b4d4e8d19afe70b430993
      template: 'Sonicwall Firewall'
      name: 'Sonicwall Firewall'
      description: |
        Overview
        Complete template for monitoring SonicWALL firewalls.
        Provides advanced SNMP-based monitoring of system health, interfaces, VPN tunnels, and licensed security services.
        
        Features
        - Device information: hostname, firmware, model, serials, uptime, HA status, administrator, and location.
        - Performance monitoring: CPU, memory, cache, swap, and device temperature (where available).
        - Network interfaces:
          - Ethernet, fibre, VLANs, PortShield assignments.
          - Discovery and monitoring of traffic rates, error counters, and operational status.
        - VPN tunnels:
          - Policy-based VPNs (Phase-2 IPsec SAs) monitored using {#VPNNAME} and {#VPNINDEX}.
          - Route-based VPNs (VTI interfaces) monitored separately for status, traffic, and flap detection.
        - Security services:
          - GAV, IPS, IDS, Anti-Spyware, and Mail Security statistics.
          - Detection rates, scan latency, and threat alerts.
        
        Items
        - SNMP queries for system information, interfaces, VPN tunnels, and security services.
        - Preprocessing to normalise counters (e.g., bytes to bps, change per second).
        - Value mappings for status items.
        
        Discovery rules
        - Interface discovery by type: Ethernet, fibre, VLAN, PortShield.
        - VPN policy-based tunnels discovery.
        - VPN route-based tunnels discovery.
        
        Item prototypes
        - Traffic and error counters per interface and VPN tunnel.
        - VPN SA creation times and licensed service counters.
        
        Trigger prototypes
        - Interface status changes and error thresholds.
        - VPN tunnel status changes and route-based VPN flap detection.
        - CPU, memory, and scan latency critical and warning thresholds.
        
        Graph prototypes
        - Interface and VPN tunnel traffic graphs.
        - Aggregated traffic graphs for policy-based VPN tunnels.
        
        Supported devices
        - SonicWall TZ, NSA, NSa, and SuperMassive series firewalls.
        - SonicOS 6.5.x and 7.x firmware.
        
        Notes
        - Excludes unnecessary VPN entries (e.g., "BACKEND" interfaces).
        - Untested on LAG or bonded interfaces; feedback welcome.
        - Designed to avoid legacy interface-based VPN monitoring methods.
        - Suitable for HA deployments, VPN-heavy environments, and security-focused monitoring.
        
        Author: Simon Jackson / @sjackson0109
      groups:
        - name: Firewall
      items:
        - uuid: 776cea823ebd460dac46fed8a3338892
          name: 'AntiSpyware Scan Requests ({#ASW_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.5.2.1.0
          key: 'asw.scan.requests[{#ASW_LICENSE}]'
          units: scans
          description: 'Total number of AntiSpyware scan requests'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: ASW
        - uuid: eec8f68d142b46b6b5baf0239d055d89
          name: 'AntiSpyware Scan Time ({#ASW_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.5.2.4.0
          key: 'asw.scan.time[{#ASW_LICENSE}]'
          units: ms
          description: 'Average time taken for AntiSpyware scans'
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: ASW
        - uuid: 9419bf5f668246d7be619a72363502aa
          name: 'AntiSpyware Threats Blocked ({#ASW_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.5.2.3.0
          key: 'asw.threats.blocked[{#ASW_LICENSE}]'
          units: threats
          description: 'Total number of spyware threats blocked'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: ASW
        - uuid: 580aa84226934bffa927cac6e1ca4238
          name: 'AntiSpyware Threats Detected ({#ASW_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.5.2.2.0
          key: 'asw.threats.detected[{#ASW_LICENSE}]'
          units: threats
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: ASW
        - uuid: 230a69f6142c4499a605bced9bf6e7e3
          name: 'GAV Scan Count ({#GAV_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.5.1.1.0
          key: 'gav.scan.count[{#GAV_LICENSE}]'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: GAV
        - uuid: 50f9cd82709c47ee831a5ff9749ac0ee
          name: 'GAV Virus Count ({#GAV_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.5.1.2.0
          key: 'gav.virus.count[{#GAV_LICENSE}]'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: GAV
        - uuid: ad876b04a8dd491f9a01adfad5ce71b8
          name: 'IDS Attacks Blocked ({#IDS_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.6.2.2.0
          key: 'ids.attacks.blocked[{#IDS_LICENSE}]'
          units: attacks
          description: 'Total number of attacks blocked by IDS'
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: IDS
        - uuid: 5700d4114d5849d5b714ba54dd36641d
          name: 'IDS Attacks Detected ({#IDS_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.6.2.1.0
          key: 'ids.detected[{#IDS_LICENSE}]'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: IDS
        - uuid: fabb8b1fd2284e52ab804e1b3aeba46d
          name: 'IPS Attacks Blocked ({#IPS_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.6.1.1.0
          key: 'ips.blocked.count[{#IPS_LICENSE}]'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: IPS
        - uuid: 583a9eb670824e8fbc2748bcc1902a0f
          name: 'Mail Good Allowed ({#MAIL_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.4.2.0
          key: 'mail.good.allowed[{#MAIL_LICENSE}]'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: Mail
        - uuid: f215d1044787409c8ed1d801e376781d
          name: 'Mail Spam Detected ({#MAIL_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.4.3.0
          key: 'mail.spam.count[{#MAIL_LICENSE}]'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: Mail
        - uuid: 71f2827827694e27950efdc26b648135
          name: 'Mail Total Count ({#MAIL_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.4.1.0
          key: 'mail.total.count[{#MAIL_LICENSE}]'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: Mail
        - uuid: 13e7fa716385460b8280ff5afd54537b
          name: 'Mail Virus Detected ({#MAIL_LICENSE})'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.4.5.0
          key: 'mail.virus.detected[{#MAIL_LICENSE}]'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - '3600'
          tags:
            - tag: Component
              value: Feature
            - tag: Feature
              value: Security
            - tag: Service
              value: Mail
        - uuid: ab8294f669e54a40acd47663fafb1a27
          name: 'Active Connections'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.2.0
          key: sonicwall.connections.active
          value_type: FLOAT
          units: connections
          description: 'Current active firewall connections'
          tags:
            - tag: Metrics
              value: Performance
          triggers:
            - uuid: 15badb8904af4b32bf2779791835105c
              expression: 'last(/Sonicwall Firewall/sonicwall.connections.active) > {$SONICWALL_DDOS_THRESHOLD}'
              name: 'Possible DDoS Attack'
              priority: AVERAGE
              description: 'Total connections ({ITEM.LASTVALUE}) exceeded threshold ({$SONICWALL_DDOS_THRESHOLD})'
              tags:
                - tag: Condition
                  value: 'DDOS-Attack?'
        - uuid: 10e12f7f3d434f9fa8f182223973cc09
          name: 'Device Administrator'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.4.0
          key: sonicwall.contact
          delay: 5m
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'Device Administrator'
          tags:
            - tag: Component
              value: System
        - uuid: 31e66e3942ff44fb90b81ea85abcd944
          name: 'CPU Utilisation'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.3.0
          key: sonicwall.cpu.utilisation
          units: '%'
          description: 'Instantaneous CPU Utilisation in percent'
          tags:
            - tag: Component
              value: Memory
            - tag: Metrics
              value: Performance
          triggers:
            - uuid: 9f180f268ee14701883cf6bb4aa80635
              expression: 'avg(/Sonicwall Firewall/sonicwall.cpu.utilisation,5m) > {$SONICWALL_CPU_ERROR}'
              name: 'High CPU Usage (Error)'
              priority: HIGH
              description: 'System processor usage exceeded critical threshold ({ITEM.LASTVALUE} > {$SONICWALL_CPU_ERROR%), on average over past 5 minutes'
              tags:
                - tag: Condition
                  value: Threshold
            - uuid: 7950a7db6ea94a9d981c7de4d92d56b4
              expression: 'avg(/Sonicwall Firewall/sonicwall.cpu.utilisation,5m) > {$SONICWALL_CPU_WARNING}'
              name: 'High CPU Usage (Warning)'
              priority: AVERAGE
              description: 'System processor usage exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_CPU_WARNING%), on average over past 5 minutes'
              tags:
                - tag: Condition
                  value: Threshold
        - uuid: 000e78a73db74e568cf407866d5a3113
          name: 'Device Firmware Version'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: sonicwall.firmware
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Firmware version currently running on the SonicWall device.'
          inventory_link: SOFTWARE
          preprocessing:
            - type: REGEX
              parameters:
                - '^.*\((.*)\)$'
                - \1
            - type: STR_REPLACE
              parameters:
                - 'SonicOS '
                - ''
            - type: STR_REPLACE
              parameters:
                - 'Enhanced '
                - ''
          tags:
            - tag: Component
              value: System
        - uuid: 2eba2a5d85e5428d93b7b7d307525c0d
          name: 'Device Location'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.6.0
          key: sonicwall.location
          delay: 1h
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'Location currently running on the SonicWall device.'
          inventory_link: LOCATION
          tags:
            - tag: Component
              value: System
        - uuid: a0a0aa8098a74868ac05aad45fbbe25d
          name: 'Device Model'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: sonicwall.model
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Model name or identifier of the SonicWall hardware.'
          inventory_link: MODEL
          preprocessing:
            - type: REGEX
              parameters:
                - '^(.*?)\s?\(.*\)$'
                - \1
          tags:
            - tag: Component
              value: System
        - uuid: a22a81fe13e6467197ed76a7d3a99345
          name: 'Device Name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          key: sonicwall.name
          delay: 1h
          history: 1w
          value_type: CHAR
          trends: '0'
          description: 'An administratively-assigned name for this managed node.'
          inventory_link: NAME
          tags:
            - tag: Component
              value: System
        - uuid: 636c8a8b003d4235bf3b12d76da98bf0
          name: 'Device Primary Serial'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.2.1.1.2.0
          key: sonicwall.primary.serial
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Primary Serial Number'
          inventory_link: SERIALNO_A
          tags:
            - tag: Component
              value: System
        - uuid: 39f6c0007a104949b105645debe13922
          name: 'HA Primary Status'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.1.0
          key: sonicwall.primary.status
          delay: 1h
          value_type: FLOAT
          valuemap:
            name: sonicwall.ha.status.valuemap
          tags:
            - tag: Component
              value: HA
        - uuid: 617a5722949f44a9bd47d2eb3aceaba9
          name: 'RAM Utilisation'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.4.0
          key: sonicwall.ram.utilisation
          units: '%'
          description: 'Instantaneous RAM Utilisation in percent'
          tags:
            - tag: Component
              value: Memory
            - tag: Metrics
              value: Performance
          triggers:
            - uuid: 890e6b3356f445d5b55a0e491c7d2efe
              expression: 'avg(/Sonicwall Firewall/sonicwall.ram.utilisation,5m) > {$SONICWALL_RAM_ERROR}'
              name: 'High RAM Usage (Error)'
              priority: HIGH
              description: 'System processor usage exceeded critical threshold ({ITEM.LASTVALUE} > {$SONICWALL_RAM_ERROR)%, on average over past 5 minutes'
              tags:
                - tag: Condition
                  value: Threshold
            - uuid: b3a99759295f4ed0a47d88be3b07b6a8
              expression: 'avg(/Sonicwall Firewall/sonicwall.ram.utilisation,5m) > {$SONICWALL_RAM_WARNING}'
              name: 'High RAM Usage (Warning)'
              priority: AVERAGE
              description: 'System processor usage exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_RAM_WARNING)%, on average over past 5 minutes'
              tags:
                - tag: Condition
                  value: Threshold
        - uuid: e8866dac9055439ca020af54663cdc3e
          name: 'Device ROM Version'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.2.1.1.4.0
          key: sonicwall.rom.version
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'ROM version currently running on the SonicWall device.'
          tags:
            - tag: Component
              value: System
        - uuid: b616f5b1ee8e48c384221421821c715c
          name: 'Device Secondary Serial'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.2.1.1.3.0
          key: sonicwall.secondary.serial
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Secondary Serial Number'
          inventory_link: SERIALNO_B
          tags:
            - tag: Component
              value: System
        - uuid: 95cb2764ee524b4694d0612c9e869292
          name: 'HA Secondary Status'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.2.0
          key: sonicwall.secondary.status
          value_type: FLOAT
          valuemap:
            name: sonicwall.ha.status.valuemap
          tags:
            - tag: Component
              value: HA
        - uuid: cd5a053b404448d5809621c103573a39
          name: 'WAN Interfaces'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.7.1.1.1.3.87.65.78
          key: sonicwall.wan.ports
          delay: 5m
          history: 1w
          value_type: TEXT
          trends: '0'
          description: 'Physical port assignments for WAN zone (e.g., "X1,X2")'
          preprocessing:
            - type: TRIM
              parameters:
                - '"'
          tags:
            - tag: Component
              value: Zone
            - tag: Zone
              value: WAN
        - uuid: 27ae43ee1d874829af0ced3313609d6b
          name: 'Device Temperature'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.8741.1.3.1.4.0
          key: temperature
          delay: 5m
          units: °C
          tags:
            - tag: Component
              value: Temperature
          triggers:
            - uuid: 0d47b9c4560942a6a4ffd37a2b56f777
              expression: 'last(/Sonicwall Firewall/temperature) > {$SONICWALL_TEMP_ERROR}'
              name: 'Device Temperature Critical (>{$SONICWALL_TEMP_ERROR}°C)'
              priority: HIGH
              description: 'Device temperature ({ITEM.LASTVALUE}°C) exceeded critical threshold ({$SONICWALL_TEMP_ERROR}°C)'
              tags:
                - tag: Condition
                  value: Threshold
            - uuid: 183528caeae54f58a5c4b3f086a412bd
              expression: 'last(/Sonicwall Firewall/temperature) > {$SONICWALL_TEMP_WARNING}'
              name: 'Device Temperature Warning (>{$SONICWALL_TEMP_WARNING}°C)'
              priority: WARNING
              description: 'Device temperature ({ITEM.LASTVALUE}°C) exceeded warning threshold ({$SONICWALL_TEMP_WARNING}°C)'
              tags:
                - tag: Condition
                  value: Threshold
        - uuid: 07050a4878c549e894e016a7fe24181d
          name: 'Device Uptime'
          type: SNMP_AGENT
          snmp_oid: 'SNMPv2-MIB::sysUpTime.0'
          key: uptime
          units: uptime
          description: 'The time since the network management portion of the system was last re-initialized.'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Component
              value: System
      discovery_rules:
        - uuid: 58ebb24e494d4e7eb3437d95f9abfe58
          name: Processors
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CPUFWID},HOST-RESOURCES-MIB::hrProcessorLoad]'
          key: cpu.discovery
          delay: 1h
          description: 'Discover the processors of the firewall device'
          item_prototypes:
            - uuid: 503d76e0ce784d088c7768b3e14e7ff6
              name: 'CPU Utilisation {#CPUFWID}'
              type: SNMP_AGENT
              snmp_oid: 'HOST-RESOURCES-MIB::hrProcessorLoad.{#CPUFWID}'
              key: 'hrProcessorLoad[{#CPUFWID}]'
              units: '%'
              description: 'The average, over the last minute, of the percentage of time that this processor was not idle. Implementations may approximate this one minute smoothing period if necessary.'
              tags:
                - tag: Component
                  value: System
                - tag: CPU
                  value: Utilisation
              trigger_prototypes:
                - uuid: 891cd55755a648caba85846b80759bee
                  expression: |
                    avg(/Sonicwall Firewall/hrProcessorLoad[{#CPUFWID}],5m)>{$SONICWALL_CPU_ERROR}
                    and
                    count(/Sonicwall Firewall/hrProcessorLoad[{#CPUFWID}],5m,"gt",{$SONICWALL_CPU_ERROR}) > 3
                  name: 'CPU {#CPUFWID} Utilisation over {$SONICWALL_CPU_ERROR}%'
                  priority: HIGH
                  description: 'CPU {#CPUFWID} on {HOST.NAME} is over {$SONICWALL_CPU_ERROR}%'
                  tags:
                    - tag: Condition
                      value: Threshold
          graph_prototypes:
            - uuid: 282f59dcf7854b6cab11bde4636e56f5
              name: 'Processor Utilisation{#CPUFWID}'
              width: '600'
              height: '340'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'hrProcessorLoad[{#CPUFWID}]'
        - uuid: e6e32eb374ea4517871ab696cb2917b6
          name: 'Interfaces (Ethernet)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: ethernet.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFDESCR}'
                value: '.*HA-Link*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#IFDESCR}'
                value: '^.*\(Unassigned\)$'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#IFTYPE}'
                value: ^(6|117|127|128|161|560|561|800)$
                formulaid: C
          description: |
            Discover physical Ethernet interfaces on the firewall.
            
            This includes standard RJ-45 interfaces and some vendor-specific virtual Ethernet types.
            Interface detection is based on:
             - `ifType = 6` (ethernetCsmacd)
             - Extended types such as `117`, `127`, `128`, `161`, `560–561`, `800` (used on various SonicWall models)
            
            Filtering is applied to:
             - Exclude HA-link interfaces
             - Exclude unassigned or "Portshield(ed) To Host" pseudo-interfaces
            
            Note:
             - This rule does not detect LAG (Link Aggregation) interfaces — see `Interfaces (LAG/Bonded)` for that.
             - SonicWall sometimes reports bonded or VLAN-tagged interfaces under `ifType=6`; rely on `ifDescr` + interface naming to classify appropriately.
          item_prototypes:
            - uuid: ea03a12ce8ce47b0aa0cf8d91ebb623a
              name: 'Interface: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'ethernet.ifInErrors[{#IFDESCR}]'
              description: 'Inbound errors on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Ethernet
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: 1ea5c9dfb4cd47fab81c6174bd81fa26
                  expression: 'count(/Sonicwall Firewall/ethernet.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR}) > 2'
                  name: 'Interface {#IFDESCR} Inbound Errors'
                  priority: WARNING
                  description: 'Inbound errors on interface {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_INTERFACE_ERROR} over the past 5 mins)'
                  tags:
                    - tag: Condition
                      value: Threshold
                - uuid: c5fdc6304b3b4b24a51668859dded4ef
                  expression: 'count(/Sonicwall Firewall/ethernet.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR}) > 2'
                  name: 'Interface {#IFDESCR} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: 975303619c04411bb9bf189f4c535c5e
              name: 'Interface: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'ethernet.ifInOctets[{#IFDESCR}]'
              units: Bps
              description: 'Incoming traffic on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Ethernet
                - tag: Metrics
                  value: Traffic
            - uuid: 96fb55e64c97475d80a610214520e718
              name: 'Interface: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'ethernet.ifOutErrors[{#IFDESCR}]'
              description: 'Outbound errors on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Ethernet
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: ddc2036479e042f69748eb221cf1aa26
                  expression: 'count(/Sonicwall Firewall/ethernet.ifOutErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR}) > 2'
                  name: 'Interface {#IFDESCR} Outbound Errors'
                  priority: WARNING
                  description: 'Outbound errors on interface {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_INTERFACE_ERROR} over the past 5 mins)'
                  tags:
                    - tag: Condition
                      value: Flap/Disconnect/SwitchPort
            - uuid: 690b15f964de4ab7af94c963249d2816
              name: 'Interface: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'ethernet.ifOutOctets[{#IFDESCR}]'
              units: Bps
              description: 'Outgoing traffic on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Ethernet
                - tag: Metrics
                  value: Traffic
            - uuid: 36adeb4a0ab14a4ab2daefc352ed1ef5
              name: 'Interface: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'ethernet.status[{#IFDESCR}]'
              description: 'Operational status of interface {#IFDESCR}'
              valuemap:
                name: sonicwall.interface.status.valuemap
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Ethernet
                - tag: Metrics
                  value: State
          graph_prototypes:
            - uuid: 45a4bba63890410ba1e796a7319d08c7
              name: 'Ethernet Interface: {#IFDESCR} Traffic'
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'ethernet.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'ethernet.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 4CAF50
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'ethernet.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: EF5350
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'ethernet.ifOutErrors[{#IFDESCR}]'
        - uuid: 0187ded2173647a7a1910004f02ea9e1
          name: 'Interfaces (Fibre)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: fibre.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFDESCR}'
                value: '.*HA-Link*'
                operator: NOT_MATCHES_REGEX
                formulaid: A
              - macro: '{#IFDESCR}'
                value: '.*Portshield(ed)? (To|Host).*'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#IFDESCR}'
                value: '^.*\(Unassigned\)$'
                operator: NOT_MATCHES_REGEX
                formulaid: C
              - macro: '{#IFTYPE}'
                value: ^(39|48|56|195|243|244|559|562)$
                formulaid: D
          description: |
            Discover fibre-optic or high-speed physical interfaces, typically SFP/SFP+ ports, used for WAN uplinks, interconnects, or high-throughput LAN segments.
            
            Fibre interface detection is based on `ifType` values such as:
             - `39`, `48`, `56` (various Optical types)
             - `195`, `243`, `244` (SONET/SDH, VDSL2, GPON)
             - `559`, `562` (SonicWall-specific or reserved high-speed interface types)
            
            Filters are applied to exclude:
             - HA-link ports
             - PortShield(ed) pseudo-interfaces
             - Unassigned ports
            
            Note:
             - SonicWall does not consistently separate copper vs fibre via `ifType` — verify against `ifDescr` when interface mapping is critical.
             - Some bonded fibre interfaces may appear here if not caught by the LAG discovery rule.
          item_prototypes:
            - uuid: 80a6509934c042d18d44c2321c7029a6
              name: 'Interface: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'fibre.ifInErrors[{#IFDESCR}]'
              description: 'Inbound errors on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Fibre
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: 7050d75c76f5494daa70252deaa640c6
                  expression: 'count(/Sonicwall Firewall/fibre.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR})>2'
                  name: 'Interface {#IFDESCR} Inbound Errors'
                  priority: WARNING
                  description: 'Inbound errors on interface {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_INTERFACE_ERROR}/s)'
                  tags:
                    - tag: Condition
                      value: Threshold
                - uuid: 0fe58fa2581a4def957450ad5878f92d
                  expression: 'count(/Sonicwall Firewall/fibre.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR}) > 2'
                  name: 'Interface {#IFDESCR} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: 08dee29cfa0848e48b06fc2bb4dd932a
              name: 'Interface: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'fibre.ifInOctets[{#IFDESCR}]'
              units: Bps
              description: 'Incoming traffic on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Fibre
                - tag: Metrics
                  value: Traffic
            - uuid: 33e7a969fbae4305a394d10564bc8e12
              name: 'Interface: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'fibre.ifOutErrors[{#IFDESCR}]'
              description: 'Outbound errors on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Fibre
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: 45e15536b2fb4f2e9b0078d305d6d4e8
                  expression: 'count(/Sonicwall Firewall/fibre.ifOutErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR})>2'
                  name: 'Interface {#IFDESCR} Outbound Errors'
                  priority: WARNING
                  description: 'Outbound errors on interface {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_INTERFACE_ERROR}/s)'
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: 34d6bdd82895488bba990f6ebdbda2ed
              name: 'Interface: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'fibre.ifOutOctets[{#IFDESCR}]'
              units: Bps
              description: 'Outgoing traffic on interface {#IFDESCR}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Fibre
                - tag: Metrics
                  value: Traffic
            - uuid: 332c1f8ff06248a08e8f619b98729f82
              name: 'Interface: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'fibre.status[{#IFDESCR}]'
              description: 'Operational status of interface {#IFDESCR}'
              valuemap:
                name: sonicwall.interface.status.valuemap
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: Fibre
                - tag: Metrics
                  value: State
          graph_prototypes:
            - uuid: da4b3b51b35840b7a72ff35943048c5c
              name: 'Fibre Interface: {#IFDESCR} Traffic'
              graph_items:
                - color: 1A7C11
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'fibre.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'fibre.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 4CAF50
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'fibre.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: EF5350
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'fibre.ifOutErrors[{#IFDESCR}]'
        - uuid: 723e5f33af2e4701984d02c9f927ba26
          name: 'Firewall Stats (FwStats)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#INDEX},1.3.6.1.2.1.2.2.1.1.1,{#MODEL},1.3.6.1.2.1.1.1.0]'
          key: fwstats.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#INDEX}'
                value: ^1$
                formulaid: A
              - macro: '{#MODEL}'
                value: '^(?!.*NSa|NSA).*$'
                formulaid: B
          lifetime: 1d
          description: 'Collects scalar firewall metrics from sonicwallFwStats using synthetic discovery. Only available on some models of firewall'
          item_prototypes:
            - uuid: 1bd50e81a3644f8b9a1240320dcd555e
              name: 'Content Filtering Hits [{#INDEX}]'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.3.9.0
              key: 'fwstats.sonicCFS[{#INDEX}]'
              description: 'Metrics returned from the sonicwallFwStats table'
              tags:
                - tag: Component
                  value: Firewall
                - tag: Service
                  value: CF
            - uuid: 88215cb400a44578ae9c9ce5899d2d17
              name: 'Connnection Cache Entries [{#INDEX}]'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.3.2.0
              key: 'fwstats.sonicCurrentConnCacheEntries[{#INDEX}]'
              description: 'Metrics returned from the sonicwallFwStats table'
              tags:
                - tag: Component
                  value: Firewall
                - tag: Metrics
                  value: Performance
            - uuid: 8075dddd2d4e4ceba3ca21a255c96d2e
              name: 'CPU Utilisation [{#INDEX}]'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.3.3.0
              key: 'fwstats.sonicCurrentCPUUtil[{#INDEX}]'
              description: 'Metrics returned from the sonicwallFwStats table'
              tags:
                - tag: Component
                  value: System
                - tag: Metrics
                  value: Performance
            - uuid: df750f31668449b09e55c22544c7eb2e
              name: 'CPU Utilisation [{#INDEX}] - Forward And Inspect'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.3.8.0
              key: 'fwstats.sonicCurrentFwdAndInspectCPUUtil[{#INDEX}]'
              description: 'Metrics returned from the sonicwallFwStats table'
              tags:
                - tag: Component
                  value: System
                - tag: Metrics
                  value: Performance
            - uuid: 5af6a549048349efa150c9b33a643d97
              name: 'CPU Utilisation [{#INDEX}] - Management Plane'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.3.7.0
              key: 'fwstats.sonicCurrentManagementCPUUtil[{#INDEX}]'
              description: 'Metrics returned from the sonicwallFwStats table'
              tags:
                - tag: Component
                  value: System
                - tag: Metrics
                  value: Performance
            - uuid: 3e39c1102a09435da7def1f6f7c82d0b
              name: 'RAM Utilisation [{#INDEX}]'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.3.5.0
              key: 'fwstats.sonicCurrentRAMUtil[{#INDEX}]'
              description: 'Metrics returned from the sonicwallFwStats table'
              tags:
                - tag: Component
                  value: System
                - tag: Metrics
                  value: Performance
              trigger_prototypes:
                - uuid: 52f99c32e8f1491691e40c31c519f5d2
                  expression: 'avg(/Sonicwall Firewall/fwstats.sonicCurrentRAMUtil[{#INDEX}],5m) > {$SONICWALL_MEMORY_ERROR}'
                  name: 'High Memory Usage (Error) [{#INDEX}]'
                  priority: HIGH
                  description: 'System memory usage exceeded critical threshold ({ITEM.LASTVALUE} > {$SONICWALL_MEMORY_ERROR}%)'
                  tags:
                    - tag: Condition
                      value: Threshold
                - uuid: 7c566e3d0d584c1889b9cd468485ecf4
                  expression: 'avg(/Sonicwall Firewall/fwstats.sonicCurrentRAMUtil[{#INDEX}],5m) > {$SONICWALL_MEMORY_WARNING}'
                  name: 'High Memory Usage (Warning) [{#INDEX}]'
                  priority: AVERAGE
                  description: 'System memory usage exceeded warning threshold ({ITEM.LASTVALUE} > {$SONICWALL_MEMORY_WARNING}%)'
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: 68433a0bf31442139f9c588683b84825
              name: 'Max Connection Cache Entries [{#INDEX}]'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.3.1.0
              key: 'fwstats.sonicMaxConnCacheEntries[{#INDEX}]'
              description: 'Metrics returned from the sonicwallFwStats table'
              tags:
                - tag: Component
                  value: System
                - tag: Metrics
                  value: Performance
            - uuid: 91dd0953373049f186a0472510eba808
              name: 'NAT Translation Count [{#INDEX}]'
              type: SNMP_AGENT
              snmp_oid: 1.3.6.1.4.1.8741.1.3.6.0
              key: 'fwstats.sonicNatTranslationCount[{#INDEX}]'
              description: 'Metrics returned from the sonicwallFwStats table'
              tags:
                - tag: Component
                  value: Firewall
                - tag: Metrics
                  value: Performance
        - uuid: 8857ec72720e45ae9b3c0badc3d8e5f1
          name: 'Interfaces (LAG/Bonded)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr,{#IFTYPE},IF-MIB::ifType]'
          key: lag.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#IFTYPE}'
                value: ^(161|166)$
                formulaid: A
          description: |
            Discover bonded or aggregated interfaces on the firewall, such as Link Aggregation Groups (LAGs) or PortChannel interfaces.
              
            This rule targets interfaces with:
             - `ifType = 161` (IEEE 802.3ad Link Aggregation)
             - `ifType = 166` (MPLS Tunnel — occasionally used for VPN encapsulation in LAG contexts)
              
            These interfaces:
             - Represent logical bundles of physical links
             - Are often used for uplinks, high-availability paths, or VPN redundancy  - Report aggregate traffic and error metrics across all member ports
            
             Note:
             - LAG interfaces may coexist with Ethernet or Fibre entries; no deduplication is applied.
             - SonicWall interface naming is inconsistent across models — validate `ifDescr` labels per deployment.
          item_prototypes:
            - uuid: c72f0151f79c418e89c8838f2d961678
              name: 'LAG: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'lag.ifInErrors[{#IFDESCR}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: LAG
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: 70c4c487c4bf47fbbfa9ef726caec3bc
                  expression: 'count(/Sonicwall Firewall/lag.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR})>2'
                  name: 'LAG {#IFDESCR} Inbound Errors'
                  priority: AVERAGE
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: 0ed5af57dfe04b55afc3e7e0db859163
              name: 'LAG: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'lag.ifInOctets[{#IFDESCR}]'
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: LAG
                - tag: Metrics
                  value: Traffic
            - uuid: 069d7489a9f244758cc7b6cda5ffa535
              name: 'LAG: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'lag.ifOutErrors[{#IFDESCR}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: LAG
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: 33ed21d43f414eb5a2948c79c0b79c26
                  expression: 'count(/Sonicwall Firewall/lag.ifOutErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_INTERFACE_ERROR})>2'
                  name: 'LAG {#IFDESCR} Outbound Errors'
                  priority: AVERAGE
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: b4ba7bc8fbf746cabe9e45187e7410ce
              name: 'LAG: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'lag.ifOutOctets[{#IFDESCR}]'
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: LAG
                - tag: Metrics
                  value: Traffic
            - uuid: 196f611499b94fb894049bc6cd2eda70
              name: 'LAG: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'lag.status[{#IFDESCR}]'
              valuemap:
                name: sonicwall.interface.status.valuemap
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: LAG
                - tag: Metrics
                  value: State
              trigger_prototypes:
                - uuid: e9c18edffa4f4676a9326199a9f828c6
                  expression: 'count(/Sonicwall Firewall/lag.status[{#IFDESCR}],5m,"ne")>2 and nodata(/Sonicwall Firewall/lag.status[{#IFDESCR}],120s)=0'
                  name: 'LAG {#IFDESCR} status changed'
                  priority: WARNING
                  manual_close: 'YES'
                  tags:
                    - tag: Condition
                      value: Flap/Config
          graph_prototypes:
            - uuid: 931a7ef6afcc4b9aaa149555942b8df1
              name: 'LAG: {#IFDESCR} Traffic'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'lag.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: 00BFFF
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'lag.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: FF8000
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'lag.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: FF0000
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'lag.ifOutErrors[{#IFDESCR}]'
        - uuid: d2640a528715449a88ff9ecbcd2086e5
          name: 'Interfaces (VLAN)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFDESCR},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: vlan.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFTYPE}'
                value: ^(53|135)$
                formulaid: A
          description: |
            Discover VLAN-tagged interfaces, including both Layer 2 and Layer 3 subinterfaces configured on physical or virtual ports.
            
            This rule targets:
             - `ifType = 53` (propVirtual — common for VLAN-tagged Layer 2)
             - `ifType = 135` (l3ipvlan — Layer 3 subinterface with VLAN ID)
            
            These interfaces typically appear as:
             - `X0.V10`, `X2.V50`, etc. (e.g., `interface.vlan`)
             - Tagged subinterfaces used for segmentation, guest networks, or zone isolation
            
            Notes:
             - SonicWall reports some VLANs as independent `ifIndex` values, allowing direct SNMP polling
             - If these interfaces are not routable, traffic counters may show zero despite being active
             - This rule does not apply to VLANs on VTI tunnels or PortShield bridges — use dedicated discovery rules for those
          item_prototypes:
            - uuid: 2a15151dc9bb4deaab667f5e44dc963b
              name: 'VLAN: {#IFDESCR} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'vlan.ifInErrors[{#IFDESCR}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: VLAN
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: a62f49f6073740658b7c9b19f3d43ef4
                  expression: 'count(/Sonicwall Firewall/vlan.ifInErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_VLAN_WARNING})>2'
                  name: 'VLAN {#IFDESCR} Inbound Errors'
                  priority: WARNING
                  description: 'Inbound errors on VLAN {#IFDESCR} exceeded warning threshold ({ITEM.LASTVALUE} > {$SONICWALL_VLAN_WARNING}/s)'
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: 10866c4d787342cba3ebfa2360488962
              name: 'VLAN: {#IFDESCR} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'vlan.ifInOctets[{#IFDESCR}]'
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: VLAN
                - tag: Metrics
                  value: Traffic
              trigger_prototypes:
                - uuid: 84dad1350c2740a1b3e4c298ba98dbee
                  expression: 'avg(/Sonicwall Firewall/vlan.ifInOctets[{#IFDESCR}],5m) <= {$SONICWALL_VLAN_NO_TRAFFIC} and nodata(/Sonicwall Firewall/vlan.ifInOctets[{#IFDESCR}],120s)=0'
                  name: 'VLAN {#IFDESCR} No Data In'
                  priority: INFO
                  description: 'The VLAN {#IFDESCR} has had {$SONICWALL_VLAN_NO_TRAFFIC} bytes of traffic Inbound over the past 5mins'
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: 3ec81e3336ea4d57885ff531ad3630d0
              name: 'VLAN: {#IFDESCR} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'vlan.ifOutErrors[{#IFDESCR}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: VLAN
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: f9492c04fd4c42919b71178695288620
                  expression: 'count(/Sonicwall Firewall/vlan.ifOutErrors[{#IFDESCR}],5m,"gt",{$SONICWALL_VLAN_WARNING})>2'
                  name: 'VLAN {#IFDESCR} Outbound Errors'
                  priority: WARNING
                  description: 'Outbound errors on VLAN {#IFDESCR} exceeded threshold ({ITEM.LASTVALUE} > {$SONICWALL_VLAN_WARNING}/s)'
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: f82c20ffb87143afb0f0606bfe47f98e
              name: 'VLAN: {#IFDESCR} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'vlan.ifOutOctets[{#IFDESCR}]'
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: VLAN
                - tag: Metrics
                  value: Traffic
              trigger_prototypes:
                - uuid: 7f0f471f05204627b58b4017b45c6573
                  expression: 'avg(/Sonicwall Firewall/vlan.ifOutOctets[{#IFDESCR}],5m) <= {$SONICWALL_VLAN_NO_TRAFFIC} and nodata(/Sonicwall Firewall/vlan.ifOutOctets[{#IFDESCR}],120s)=0'
                  name: 'VLAN {#IFDESCR} No Data Out'
                  priority: INFO
                  description: 'The VLAN {#IFDESCR} has had {$SONICWALL_VLAN_NO_TRAFFIC} bytes of traffic Outbound over the past 5mins'
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: 8d5922eadc904e529e9c8f5499c8832c
              name: 'VLAN: {#IFDESCR} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'vlan.status[{#IFDESCR}]'
              valuemap:
                name: sonicwall.interface.status.valuemap
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: VLAN
                - tag: Metrics
                  value: State
          graph_prototypes:
            - uuid: 2b7646f0fbf341c2983e8d62b13562b6
              name: 'VLAN: {#IFDESCR} Traffic'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vlan.ifInOctets[{#IFDESCR}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vlan.ifOutOctets[{#IFDESCR}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 66BB6A
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vlan.ifInErrors[{#IFDESCR}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: E57373
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vlan.ifOutErrors[{#IFDESCR}]'
        - uuid: 138687730455496a870eace2a5994848
          name: 'VPN Tunnels (Policy Based)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#VPNINDEX},1.3.6.1.4.1.8741.1.3.2.1.1.1.1,{#VPNNAME},1.3.6.1.4.1.8741.1.3.2.1.1.1.14]'
          key: vpn.policy.discovery
          delay: 15m
          filter:
            evaltype: AND
            conditions:
              - macro: '{#VPNNAME}'
                value: '{$SONICWALL_VPN_IGNORE_REGEX}'
                operator: NOT_MATCHES_REGEX
                formulaid: A
          description: |
            Discover active IPsec Phase-2 Security Associations (SAs) for policy-based VPNs.
              
            Each discovered entity corresponds to a live SA, indexed by a dynamic SNMP index ({#VPNINDEX}), with an associated tunnel identifier ({#VPNNAME}) pulled from `sonicSAStatUserName`.
            
            Policy-based VPNs:
             - Define explicit encryption domains (local/remote subnets)
             - Do not create interface representations in SNMP
             - Are represented only while an SA is active
              
            Important:
             - SonicWall does not expose static VPN definitions via SNMP
             - SAs expire and rekey frequently — this discovery can yield hundreds of short-lived entries
             - Use strict regex filters and reduced retention to control template scale and history growth
          item_prototypes:
            - uuid: ddd196ba48194cf0a8c5e66222ef3e5d
              name: 'VPN Policy: {#VPNNAME} Bytes In'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.8741.1.3.2.1.1.1.9.{#VPNINDEX}'
              key: 'vpn.policy.bytesIn[{#VPNNAME},{#VPNINDEX}]'
              history: 1d
              trends: 1d
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: VPN
                - tag: Metrics
                  value: Traffic
                - tag: VPN
                  value: Policy
            - uuid: 9882b0fbcf2c42daa1a030cf75c97b28
              name: 'VPN Policy: {#VPNNAME} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.8741.1.3.2.1.1.1.11.{#VPNINDEX}'
              key: 'vpn.policy.bytesOut[{#VPNNAME},{#VPNINDEX}]'
              history: 1d
              trends: 1d
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: VPN
                - tag: Metrics
                  value: Traffic
                - tag: VPN
                  value: Policy
            - uuid: 806f0adc13cd469f9117c3deff1a6bc1
              name: 'VPN Policy: {#VPNNAME} SA {#VPNINDEX}'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.8741.1.3.2.1.1.1.7.{#VPNINDEX}'
              key: 'vpn.policy.sa.create_time[{#VPNNAME},{#VPNINDEX}]'
              history: 1d
              value_type: CHAR
              trends: '0'
              tags:
                - tag: Component
                  value: VPN
                - tag: VPN
                  value: Policy
          trigger_prototypes:
            - uuid: a0ea00382b334bedb5483277d7aab49f
              expression: |
                avg(/Sonicwall Firewall/vpn.policy.bytesIn[{#VPNNAME},{#VPNINDEX}],3h) < {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD} and
                avg(/Sonicwall Firewall/vpn.policy.bytesOut[{#VPNNAME},{#VPNINDEX}],3h) < {$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}
              name: 'VPN Policy: {#VPNNAME} SA {#VPNINDEX} - Low Traffic (Idle)'
              priority: INFO
              description: |
                This trigger monitors individual Phase-2 IPsec Security Associations (SAs) under the VPN tunnel "{#VPNNAME}".
                It fires when both inbound and outbound traffic for this SA have been zero for a continuous 3-hour period.
                  
                Note: Some tunnels may be configured with keepalives or rekey intervals that do not generate traffic. 
                This trigger is informational and intended to highlight long-idle SAs for review.
              manual_close: 'YES'
              tags:
                - tag: Condition
                  value: Idle
        - uuid: 5b8828f520044cb4aee1248934790d9b
          name: 'VPN Tunnels (Route Based)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#VPNNAME},1.3.6.1.2.1.2.2.1.2,{#VPNADMINSTATE},1.3.6.1.2.1.2.2.1.7,{#IFTYPE},1.3.6.1.2.1.2.2.1.3,{#VPNOPERSTATE},IF-MIB::ifOperStatus]'
          key: vpn.route.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFTYPE}'
                value: ^131$
                formulaid: A
              - macro: '{#VPNADMINSTATE}'
                value: ^1$
                formulaid: B
              - macro: '{#VPNNAME}'
                value: '{$SONICWALL_VPN_IGNORE_REGEX}'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          description: |
            Discover dynamically instantiated route-based VPN TUNNEL interfaces (ifType=131).
              
            These represent the runtime IPsec tunnel state associated with route-based VPN SAs. The encryption domain is always 0.0.0.0/0 (match any), and SAs are tied to these tunnels.
              
            These interfaces provide:
             - Real-time flap monitoring
             - Byte and error counters
             - Accurate tunnel usage insights
              
            This intentionally overlaps with VTI monitoring. Each layer serves a different purpose:
             - VTI: persistent configuration and routing layer
             - TUNNEL: dynamic SA interface for traffic visibility
          item_prototypes:
            - uuid: 3c1bb76ca478444db54d7f394e046c23
              name: 'VPN Route: {#VPNNAME} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'vpn.route.ifInErrors[{#VPNNAME}]'
              description: 'Errors In counter not exposed during testing - Bug in the Sonicwall Firmware?'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: VPN
                - tag: Metrics
                  value: Errors
                - tag: VPN
                  value: Route
              trigger_prototypes:
                - uuid: b2f59c886b324cd88518d38dca6c0244
                  expression: 'avg(/Sonicwall Firewall/vpn.route.ifInErrors[{#VPNNAME}],3m) > {$SONICWALL_VPN_CRITICAL_THRESHOLD}'
                  name: 'VPN Route: {#VPNNAME} Inbound Errors (Error)'
                  priority: HIGH
                  description: 'Errors In counter not exposed during testing - Bug in the Sonicwall Firmware?'
                  tags:
                    - tag: Condition
                      value: Threshold
                - uuid: 0b5b79c341af4a4382c02676b245dd38
                  expression: 'avg(/Sonicwall Firewall/vpn.route.ifInErrors[{#VPNNAME}],3m) > {$SONICWALL_VPN_WARNING_THRESHOLD}'
                  name: 'VPN Route: {#VPNNAME} Inbound Errors (Warning)'
                  priority: AVERAGE
                  description: 'Errors In counter not exposed during testing - Bug in the Sonicwall Firmware?'
                  tags:
                    - tag: Component
                      value: VPN
                    - tag: VPN
                      value: Route
            - uuid: 4a06318935bd4a8d803dd9109db9ba7e
              name: 'VPN Route: {#VPNNAME} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'vpn.route.ifInOctets[{#VPNNAME}]'
              units: bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: VPN
                - tag: Metrics
                  value: Traffic
                - tag: VPN
                  value: Route
            - uuid: d203b3c848c04e94aaa799ba6af8dac0
              name: 'VPN Route: {#VPNNAME} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'vpn.route.ifOutErrors[{#VPNNAME}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: VPN
                - tag: Metrics
                  value: Errors
                - tag: VPN
                  value: Route
              trigger_prototypes:
                - uuid: 1379731bc5b0416abb4fd261fac82c79
                  expression: 'last(/Sonicwall Firewall/vpn.route.ifOutErrors[{#VPNNAME}]) > {$SONICWALL_VPN_CRITICAL_THRESHOLD}'
                  name: 'VPN Route: {#VPNNAME} Outbound Errors (Error)'
                  priority: HIGH
                  description: 'IfOutErrors In counter not exposed during testing - Bug in the Sonicwall Firmware?'
                  tags:
                    - tag: Condition
                      value: Threshold
                - uuid: e8c4770f6c18443a89d3009bef1a2ce2
                  expression: 'last(/Sonicwall Firewall/vpn.route.ifOutErrors[{#VPNNAME}]) > {$SONICWALL_VPN_WARNING_THRESHOLD}'
                  name: 'VPN Route: {#VPNNAME} Outbound Errors (Warning)'
                  priority: AVERAGE
                  description: 'IfOutErrors In counter not exposed during testing - Bug in the Sonicwall Firmware?'
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: 5c4f71c24d51433fa572275b0726f2f1
              name: 'VPN Route: {#VPNNAME} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'vpn.route.ifOutOctets[{#VPNNAME}]'
              units: bps
              description: 'Bytes Out counter not exposed during testing - Bug in the Sonicwall Firmware?'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: VPN
                - tag: Metrics
                  value: Traffic
                - tag: VPN
                  value: Route
            - uuid: 803ca2150a6940d38363649cfa3e019d
              name: 'VPN Route: {#VPNNAME} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'vpn.route.status[{#VPNNAME}]'
              valuemap:
                name: sonicwall.vpn.status.valuemap
              tags:
                - tag: Component
                  value: VPN
                - tag: VPN
                  value: Route
              trigger_prototypes:
                - uuid: 5e016d178d42463da36607da2c11536a
                  expression: |
                    count(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}],300,"ne")>2
                    and nodata(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}],120s)=0
                  name: 'VPN Route: Tunnel {#VPNNAME} status changed'
                  priority: AVERAGE
                  description: 'Status counter not exposed during testing - Bug in the Sonicwall Firmware?'
                  manual_close: 'YES'
                  tags:
                    - tag: Condition
                      value: Threshold
                - uuid: 7e5b193f9d734c2ea2745793eebfe8fc
                  expression: |
                    count(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}],300,"ne")>2
                    and nodata(/Sonicwall Firewall/vpn.route.status[{#VPNNAME}],120s)=0
                  name: 'VPN Route: {#VPNNAME} Flapping Detected'
                  priority: WARNING
                  description: |
                    The VTI reports DOWN, but traffic is actively flowing. Possible tunnel flap, or incorrect operational state.
                    Investigate VPN tunnel stability and SonicWall firmware behaviour, BGP/Static Route configuration etc.
                  manual_close: 'YES'
                  tags:
                    - tag: Component
                      value: VPN
                    - tag: VPN
                      value: Route
          graph_prototypes:
            - uuid: dc809c23462c460ebb13a0ade5159b38
              name: 'VPN Route: {#VPNNAME} Traffic (Bytes/Errors In/Out)'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vpn.route.ifInOctets[{#VPNNAME}]'
                - sortorder: '1'
                  color: FF0000
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vpn.route.ifOutOctets[{#VPNNAME}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 66BB6A
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vpn.route.ifInErrors[{#VPNNAME}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: F44336
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vpn.route.ifOutErrors[{#VPNNAME}]'
        - uuid: f6bb4d46dd22461c83472971b98a07c2
          name: 'Interfaces (VTI)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#VTINAME},IF-MIB::ifDescr, {#IFTYPE},IF-MIB::ifType]'
          key: vti.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#IFTYPE}'
                value: ^(131)$
                formulaid: A
          description: |
            Discover route-based VPN interfaces (ifType=131).
              
            These interfaces represent Virtual Tunnel Interfaces (VTI) — persistent Layer-3 interfaces configured with IPs and routed using static or dynamic protocols (e.g., BGP).
              
            VTIs are the configuration layer and always exist. However, traffic counters may be idle if tunnels are unused.
              
            Note: These are distinct from the tunnel interfaces associated with active IPsec Security Associations (SAs).
            Do not assume this discovery overlaps with route-based TUNNEL metrics; especially with more than one Phase 2 SA.
          item_prototypes:
            - uuid: c07868e00c92478a92098e28c7ef58fb
              name: 'VTI: {#VTINAME} Bytes In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInOctets.{#SNMPINDEX}'
              key: 'vti.bytesIn[{#VTINAME}]'
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: VTI
                - tag: Metrics
                  value: Traffic
            - uuid: b50e7769e7384bc190dc24773b45a2c4
              name: 'VTI: {#VTINAME} Bytes Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutOctets.{#SNMPINDEX}'
              key: 'vti.bytesOut[{#VTINAME}]'
              units: Bps
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: VTI
                - tag: Metrics
                  value: Traffic
            - uuid: f6aee31a88024fb490f2b94098327380
              name: 'VTI: {#VTINAME} Errors In'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifInErrors.{#SNMPINDEX}'
              key: 'vti.errorsIn[{#VTINAME}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: VTI
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: 36326c71d1654a30aa3fbad79539eeda
                  expression: 'count(/Sonicwall Firewall/vti.errorsIn[{#VTINAME}],5m,"gt",{$SONICWALL_VPN_ERROR})>2'
                  name: 'VTI: {#VTINAME} Inbound Errors'
                  priority: HIGH
                  tags:
                    - tag: Condition
                      value: Threshold
                - uuid: bc04567371fe42b7839411dfc8da4f50
                  expression: 'count(/Sonicwall Firewall/vti.errorsIn[{#VTINAME}],5m,"gt",{$SONICWALL_VPN_WARNING_THRESHOLD})>2'
                  name: 'VTI: {#VTINAME} Inbound Warning'
                  priority: AVERAGE
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: 09ffdad6ae16442a9b10ba37c2b89842
              name: 'VTI: {#VTINAME} Errors Out'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOutErrors.{#SNMPINDEX}'
              key: 'vti.errorsOut[{#VTINAME}]'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: VTI
                - tag: Metrics
                  value: Errors
              trigger_prototypes:
                - uuid: 893bc0b990d64e118039f0d8e6b6bbf0
                  expression: 'count(/Sonicwall Firewall/vti.errorsOut[{#VTINAME}],5m,"gt",{$SONICWALL_VPN_ERROR})>2'
                  name: 'VTI: {#VTINAME} Outbound Errors'
                  priority: HIGH
                  tags:
                    - tag: Condition
                      value: Threshold
                - uuid: f6c4bd1e1ccb48e9a86586b9ff5c2a5f
                  expression: 'count(/Sonicwall Firewall/vti.errorsOut[{#VTINAME}],5m,"gt",{$SONICWALL_VPN_WARNING_THRESHOLD})>2'
                  name: 'VTI: {#VTINAME} Outbound Warning'
                  priority: AVERAGE
                  tags:
                    - tag: Condition
                      value: Threshold
            - uuid: 7b173c18fc024e99a84e389f9706e21a
              name: 'VTI: {#VTINAME} Status'
              type: SNMP_AGENT
              snmp_oid: 'IF-MIB::ifOperStatus.{#SNMPINDEX}'
              key: 'vti.ifOperStatus[{#VTINAME}]'
              valuemap:
                name: sonicwall.interface.status.valuemap
              tags:
                - tag: Component
                  value: Interface
                - tag: Interface
                  value: VTI
                - tag: Metrics
                  value: State
              trigger_prototypes:
                - uuid: f094bd2abb4a40a48fdfdf1aa71cb382
                  expression: 'count(/Sonicwall Firewall/vti.ifOperStatus[{#VTINAME}],5m,"ne")>2 and nodata(/Sonicwall Firewall/vti.ifOperStatus[{#VTINAME}],120s)=0'
                  name: 'VTI: {#VTINAME} status changed'
                  priority: AVERAGE
                  manual_close: 'YES'
                  tags:
                    - tag: Condition
                      value: Config
          graph_prototypes:
            - uuid: ac9b24f725a5471d9f3befefa3a5f43a
              name: 'VTI: {#VTINAME} Traffic'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vti.bytesIn[{#VTINAME}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vti.bytesOut[{#VTINAME}]'
                - sortorder: '2'
                  drawtype: FILLED_REGION
                  color: 66BB6A
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vti.errorsIn[{#VTINAME}]'
                - sortorder: '3'
                  drawtype: FILLED_REGION
                  color: E57373
                  calc_fnc: ALL
                  item:
                    host: 'Sonicwall Firewall'
                    key: 'vti.errorsOut[{#VTINAME}]'
      tags:
        - tag: Author
          value: 'Simon Jackson'
      macros:
        - macro: '{$SONICWALL_ASW_SCAN_TIME_THRESHOLD}'
          value: '30'
          description: 'Trigger threshold for Gateway Anti-Spyware scan time (seconds).'
        - macro: '{$SONICWALL_ASW_THREAT_THRESHOLD}'
          value: '10'
          description: 'Threshold for detected Gateway Anti-Spyware threat count.'
        - macro: '{$SONICWALL_CPU_ERROR}'
          value: '90'
          description: 'CPU usage (%) that triggers an error-level alert.'
        - macro: '{$SONICWALL_CPU_WARNING}'
          value: '80'
          description: 'CPU usage (%) that triggers a warning-level alert.'
        - macro: '{$SONICWALL_DDOS_THRESHOLD}'
          value: '50000'
          description: 'Threshold for total detected DDoS packets before triggering an alert.'
        - macro: '{$SONICWALL_DISK_ERROR}'
          value: '90'
          description: 'Disk usage (%) that triggers an error-level alert.'
        - macro: '{$SONICWALL_DISK_WARNING}'
          value: '80'
          description: 'Disk usage (%) that triggers a warning-level alert.'
        - macro: '{$SONICWALL_GAV_VIRUS_THRESHOLD}'
          value: '5'
          description: 'Threshold for detected viruses by Gateway Anti-Virus before triggering an alert.'
        - macro: '{$SONICWALL_HA_ANOMOLY_HIGH_THRESHOLD}'
          value: '375000'
          description: 'Minimum expected cluster role status value to indicate active HA state. Adjust per firewall model.'
        - macro: '{$SONICWALL_HA_ANOMOLY_LOW_THRESHOLD}'
          value: '500'
          description: 'Threshold below which HA secondary state is considered anomalous.'
        - macro: '{$SONICWALL_INTERFACE_ERROR}'
          value: '10'
          description: 'Threshold for interface input/output errors before triggering an alert.'
        - macro: '{$SONICWALL_IPS_ATTACK_THRESHOLD}'
          value: '10'
          description: 'Threshold for Intrusion Prevention System (IPS) detected attacks.'
        - macro: '{$SONICWALL_MEMORY_ERROR}'
          value: '90'
          description: 'Memory usage (%) that triggers an error-level alert.'
        - macro: '{$SONICWALL_MEMORY_WARNING}'
          value: '80'
          description: 'Memory usage (%) that triggers a warning-level alert.'
        - macro: '{$SONICWALL_SWAP_WARNING}'
          value: '70'
          description: 'Swap usage (%) that triggers a warning-level alert.'
        - macro: '{$SONICWALL_TEMP_ERROR}'
          value: '70'
          description: 'Temperature (°C) that triggers an error-level alert.'
        - macro: '{$SONICWALL_TEMP_WARNING}'
          value: '60'
          description: 'Temperature (°C) that triggers a warning-level alert.'
        - macro: '{$SONICWALL_VLAN_ERROR}'
          value: '10'
          description: 'Threshold for input/output errors on VLAN interfaces.'
        - macro: '{$SONICWALL_VLAN_WARNING}'
          value: '10'
          description: 'Threshold for input/output warnings on VLAN interfaces.'
        - macro: '{$SONICWALL_VPN_ERROR}'
          value: '5'
          description: 'Threshold for input/output errors on VPN interfaces before triggering an error-level alert.'
        - macro: '{$SONICWALL_VPN_IGNORE_REGEX}'
          value: '^(?i:BACKEND|TEST|MONITORING).*'
          description: 'Regex to exclude VPN tunnels (by name) from discovery. Adjust for tunnel naming conventions.'
        - macro: '{$SONICWALL_VPN_TRAFFIC_IDLE_THRESHOLD}'
          value: '100'
          description: 'Minimum expected average VPN traffic (bps) over 3 hours before considering a tunnel idle.'
        - macro: '{$SONICWALL_VPN_WARNING_THRESHOLD}'
          value: '2'
          description: 'Threshold for VPN tunnel errors that triggers a warning alert.'
      dashboards:
        - uuid: abbbec0248734fc58ae96712a5cf32e6
          name: 'SonicWALL Firewalls'
          pages:
            - name: Cluster
              widgets:
                - type: problemsbysv
                  width: '36'
                  hide_header: 'YES'
                  fields:
                    - type: STRING
                      name: reference
                      value: YKUZB
                - type: svggraph
                  name: Activity
                  'y': '2'
                  width: '36'
                  height: '3'
                  fields:
                    - type: INTEGER
                      name: ds.0.aggregate_function
                      value: '5'
                    - type: INTEGER
                      name: ds.0.aggregate_grouping
                      value: '1'
                    - type: STRING
                      name: ds.0.aggregate_interval
                      value: 1m
                    - type: STRING
                      name: ds.0.color
                      value: 00FFBF
                    - type: STRING
                      name: ds.0.data_set_label
                      value: 'Traffic: Inbound'
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface: * Bytes In'
                    - type: STRING
                      name: ds.0.items.1
                      value: 'LAG: * Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: INTEGER
                      name: ds.1.aggregate_function
                      value: '5'
                    - type: INTEGER
                      name: ds.1.aggregate_grouping
                      value: '1'
                    - type: STRING
                      name: ds.1.aggregate_interval
                      value: 1m
                    - type: STRING
                      name: ds.1.color
                      value: 0080FF
                    - type: STRING
                      name: ds.1.data_set_label
                      value: 'Traffic: Outbound'
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'Interface: * Bytes Out'
                    - type: STRING
                      name: ds.1.items.1
                      value: 'LAG: * Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '2'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: NEFMN
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                - type: item
                  name: Primary
                  'y': '5'
                  width: '10'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Sonicwall Firewall'
                        key: sonicwall.primary.status
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                - type: item
                  name: Secondary
                  'y': '7'
                  width: '10'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Sonicwall Firewall'
                        key: sonicwall.secondary.status
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                - type: svggraph
                  name: 'HA Member Sync'
                  x: '10'
                  'y': '5'
                  width: '26'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00FF00
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'HA Primary Status'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: 00BFFF
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'HA Secondary Status'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '2'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: QKEVM
                    - type: INTEGER
                      name: righty
                      value: '0'
                - type: honeycomb
                  name: 'Important Info'
                  x: '36'
                  width: '26'
                  height: '3'
                  fields:
                    - type: STRING
                      name: items.0
                      value: 'Device Firmware Version'
                    - type: STRING
                      name: items.1
                      value: 'Device Model'
                    - type: STRING
                      name: items.2
                      value: 'Device ROM Version'
                    - type: STRING
                      name: items.3
                      value: 'Device Temperature'
                    - type: STRING
                      name: primary_label
                      value: '{ITEM.NAME}'
                    - type: STRING
                      name: reference
                      value: BFIFR
                - type: gauge
                  x: '36'
                  'y': '3'
                  width: '13'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Sonicwall Firewall'
                        key: sonicwall.cpu.utilisation
                    - type: STRING
                      name: max
                      value: '100'
                    - type: STRING
                      name: min
                      value: '0'
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: INTEGER
                      name: show.2
                      value: '5'
                - type: gauge
                  x: '36'
                  'y': '6'
                  width: '13'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Sonicwall Firewall'
                        key: temperature
                    - type: STRING
                      name: max
                      value: '80'
                    - type: STRING
                      name: min
                      value: '20'
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: STRING
                      name: thresholds.0.color
                      value: 0080FF
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '25'
                    - type: STRING
                      name: thresholds.1.color
                      value: 00FF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '45'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '70'
                - type: gauge
                  x: '49'
                  'y': '3'
                  width: '13'
                  height: '3'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Sonicwall Firewall'
                        key: sonicwall.ram.utilisation
                    - type: STRING
                      name: max
                      value: '100'
                    - type: STRING
                      name: min
                      value: '0'
                    - type: INTEGER
                      name: show.0
                      value: '2'
                    - type: INTEGER
                      name: show.1
                      value: '4'
                    - type: INTEGER
                      name: show.2
                      value: '5'
            - name: Interfaces
              widgets:
                - type: honeycomb
                  name: Interfaces
                  width: '47'
                  fields:
                    - type: INTEGER
                      name: evaltype_item
                      value: '2'
                    - type: INTEGER
                      name: interpolation
                      value: '1'
                    - type: STRING
                      name: items.0
                      value: 'Interface: * Status'
                    - type: STRING
                      name: items.1
                      value: 'LAG: * Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: Interface
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^(VPN|VTI|VLAN|Interface|PortShield): (.+?) (Bytes|Errors|Status).*$", "\2")}'
                    - type: INTEGER
                      name: primary_label_bold
                      value: '1'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: STRING
                      name: reference
                      value: ZEVFJ
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: '666699'
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '2'
                - type: svggraph
                  name: 'Interface: Bytes In/Out'
                  'y': '2'
                  width: '47'
                  height: '7'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface: X* Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'Interface: X* Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: STRING
                      name: ds.2.color
                      value: 0EC9AC
                    - type: INTEGER
                      name: ds.2.fill
                      value: '1'
                    - type: STRING
                      name: ds.2.items.0
                      value: 'LAG: * Bytes In'
                    - type: INTEGER
                      name: ds.2.transparency
                      value: '3'
                    - type: STRING
                      name: ds.3.color
                      value: 524BBC
                    - type: INTEGER
                      name: ds.3.fill
                      value: '1'
                    - type: STRING
                      name: ds.3.items.0
                      value: 'LAG: * Bytes Out'
                    - type: INTEGER
                      name: ds.3.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '8'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: XEPAL
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'Interface: Errors In/Out'
                  'y': '9'
                  width: '47'
                  height: '3'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'Interface: X* Errors In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'Interface: X* Errors Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: STRING
                      name: ds.2.color
                      value: 0EC9AC
                    - type: INTEGER
                      name: ds.2.fill
                      value: '1'
                    - type: STRING
                      name: ds.2.items.0
                      value: 'LAG: * Errors In'
                    - type: INTEGER
                      name: ds.2.transparency
                      value: '3'
                    - type: STRING
                      name: ds.3.color
                      value: 524BBC
                    - type: INTEGER
                      name: ds.3.fill
                      value: '1'
                    - type: STRING
                      name: ds.3.items.0
                      value: 'LAG: * Errors Out'
                    - type: INTEGER
                      name: ds.3.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines_mode
                      value: '1'
                    - type: STRING
                      name: reference
                      value: SEDGX
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
            - name: VLANs
              widgets:
                - type: honeycomb
                  name: 'VLAN Errors'
                  width: '10'
                  height: '13'
                  fields:
                    - type: INTEGER
                      name: interpolation
                      value: '1'
                    - type: STRING
                      name: items.0
                      value: 'VLAN: * Errors *'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Interface
                    - type: STRING
                      name: item_tags.0.value
                      value: VLAN
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^(VPN|VTI|VLAN|Interface|PortShield): (.+?) (Bytes|Errors|Status).*$", "\2")}'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: STRING
                      name: reference
                      value: SVIZL
                    - type: STRING
                      name: secondary_label_color
                      value: '666699'
                    - type: INTEGER
                      name: secondary_label_decimal_places
                      value: '0'
                    - type: INTEGER
                      name: secondary_label_units_show
                      value: '0'
                    - type: STRING
                      name: thresholds.0.color
                      value: 00FF00
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: FFFF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF8000
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '10'
                    - type: STRING
                      name: thresholds.3.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.3.threshold
                      value: '100'
                    - type: STRING
                      name: thresholds.4.color
                      value: FF0000
                    - type: STRING
                      name: thresholds.4.threshold
                      value: '1000'
                - type: graphprototype
                  name: 'VLAN: Traffic'
                  x: '10'
                  width: '39'
                  height: '13'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Sonicwall Firewall'
                        name: 'VLAN: {#IFDESCR} Traffic'
                    - type: STRING
                      name: reference
                      value: AGVQQ
                    - type: INTEGER
                      name: rows
                      value: '4'
            - name: 'VPNs (VTI)'
              widgets:
                - type: honeycomb
                  name: 'VPN Tunnels (unsupported)'
                  width: '21'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: interpolation
                      value: '1'
                    - type: STRING
                      name: items.0
                      value: '* Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: VPN
                    - type: STRING
                      name: item_tags.0.value
                      value: Route
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^(VPN|VTI|VLAN|Interface|PortShield|): (.+?) (Bytes|Errors|Status).*$", "\2")}'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: STRING
                      name: reference
                      value: TFRQV
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: '666699'
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '2'
                - type: honeycomb
                  name: 'Tunnel Interfaces'
                  'y': '5'
                  width: '21'
                  height: '6'
                  fields:
                    - type: INTEGER
                      name: interpolation
                      value: '1'
                    - type: STRING
                      name: items.0
                      value: '* Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: VTI
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^(VPN|VTI|VLAN|Interface|PortShield|): (.+?) (Bytes|Errors|Status).*$", "\2")}'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: STRING
                      name: reference
                      value: DDBCC
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: '666699'
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '2'
                - type: svggraph
                  name: 'VPN Route: Bytes In/Out'
                  x: '21'
                  width: '51'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VPN Route: * Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'VPN Route: * Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '3'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: YCUWV
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'VTI: Bytes In/Out'
                  x: '21'
                  'y': '4'
                  width: '51'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VTI: * Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'VTI: * Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '3'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: UDDVX
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'VTI: Errors In/Out'
                  x: '21'
                  'y': '8'
                  width: '51'
                  height: '3'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VTI: Errors In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'VTI: * Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: STRING
                      name: reference
                      value: TLIOJ
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
            - name: 'VPNs (Policy)'
              widgets:
                - type: honeycomb
                  name: 'VPN Statuses (unsupported)'
                  width: '21'
                  height: '8'
                  fields:
                    - type: INTEGER
                      name: interpolation
                      value: '1'
                    - type: STRING
                      name: items.0
                      value: '* Status'
                    - type: INTEGER
                      name: item_tags.0.operator
                      value: '1'
                    - type: STRING
                      name: item_tags.0.tag
                      value: Component
                    - type: STRING
                      name: item_tags.0.value
                      value: VPN
                    - type: STRING
                      name: primary_label
                      value: '{{ITEM.NAME}.regsub("^(VPN|VTI|VLAN|Interface|PortShield|): (.+?) (Bytes|Errors|Status).*$", "\2")}'
                    - type: STRING
                      name: primary_label_color
                      value: '666699'
                    - type: STRING
                      name: reference
                      value: TCHRH
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: STRING
                      name: thresholds.0.color
                      value: '666699'
                    - type: STRING
                      name: thresholds.0.threshold
                      value: '0'
                    - type: STRING
                      name: thresholds.1.color
                      value: 80FF00
                    - type: STRING
                      name: thresholds.1.threshold
                      value: '1'
                    - type: STRING
                      name: thresholds.2.color
                      value: FF465C
                    - type: STRING
                      name: thresholds.2.threshold
                      value: '2'
                - type: svggraph
                  name: 'VPN Policy: Decrypt/Encrypt Bytes In/Out'
                  x: '21'
                  width: '51'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: 00FF00
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VPN Policy: * Encrypt Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: 00BFFF
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'VPN Policy: * Encrypt Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '3'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: TGCPP
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
                - type: svggraph
                  name: 'VPN: Bytes In/Out'
                  x: '21'
                  'y': '4'
                  width: '51'
                  height: '4'
                  fields:
                    - type: STRING
                      name: ds.0.color
                      value: FF465C
                    - type: INTEGER
                      name: ds.0.fill
                      value: '1'
                    - type: STRING
                      name: ds.0.items.0
                      value: 'VPN: * Bytes In'
                    - type: INTEGER
                      name: ds.0.transparency
                      value: '3'
                    - type: STRING
                      name: ds.1.color
                      value: FFD54F
                    - type: INTEGER
                      name: ds.1.fill
                      value: '1'
                    - type: STRING
                      name: ds.1.items.0
                      value: 'VPN: * Bytes Out'
                    - type: INTEGER
                      name: ds.1.transparency
                      value: '3'
                    - type: INTEGER
                      name: legend_lines
                      value: '3'
                    - type: INTEGER
                      name: legend_statistic
                      value: '1'
                    - type: STRING
                      name: reference
                      value: WVSXV
                    - type: INTEGER
                      name: righty
                      value: '0'
                    - type: INTEGER
                      name: simple_triggers
                      value: '1'
                    - type: INTEGER
                      name: working_time
                      value: '1'
      valuemaps:
        - uuid: ccaf690dc4e045c8946a7ef3e93e305b
          name: sonicwall.ha.status.valuemap
          mappings:
            - value: '0'
              newvalue: Standalone
            - value: '125000'
              newvalue: Active
            - value: '375000'
              newvalue: Active
            - value: '1000000'
              newvalue: Active
            - type: LESS_OR_EQUAL
              value: '99999'
              newvalue: Passive
            - type: GREATER_OR_EQUAL
              value: '1000001'
              newvalue: Unknown/Unexpected
        - uuid: ffd27061e43a4463acd2abe95f3f83d4
          name: sonicwall.interface.status.valuemap
          mappings:
            - value: '1'
              newvalue: Up
            - value: '2'
              newvalue: Down
            - value: '3'
              newvalue: Testing
            - value: '4'
              newvalue: Unknown
            - value: '5'
              newvalue: Dormant
            - value: '6'
              newvalue: 'Not Present'
            - value: '7'
              newvalue: 'Lower Layer Down'
        - uuid: 047402633de04c5ba71b55790ecc24ab
          name: sonicwall.vpn.status.valuemap
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
  triggers:
    - uuid: 0187ded2173647a7a1910004f02ea9e1
      expression: |
        (
         avg(/Sonicwall Firewall/sonicwall.primary.status,10m) > {$SONICWALL_HA_ANOMOLY_HIGH_THRESHOLD}
        )
        or
        (
         avg(/Sonicwall Firewall/sonicwall.secondary.status,10m) > {$SONICWALL_HA_ANOMOLY_HIGH_THRESHOLD}
        )
      name: 'HA Anomaly Detected'
      priority: HIGH
      description: |
        High Availability issue detected:
        - Primary status sustained above {$SONICWALL_HA_ANOMOLY_HIGH_THRESHOLD} (possible reboot or promotion)
        - OR Secondary status dropped below {$SONICWALL_HA_ANOMOLY_LOW_THRESHOLD} (sync issues, heartbeat loss)
        
        10-minute average — 
        Primary: {avg(/Sonicwall Firewall/sonicwall.primary.status,10m)}
        Secondary: {avg(/Sonicwall Firewall/sonicwall.secondary.status,10m)}
      manual_close: 'YES'
      tags:
        - tag: Condition
          value: Threshold
