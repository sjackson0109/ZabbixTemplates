zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 75f9092393ff43658b002bf6174677ef
      name: 'Templates/Network devices'
  host_groups:
    - uuid: f2481361f99448eea617b7b1d4765566
      name: 'Discovered hosts'
  templates:
    - uuid: 1ffa29293fc64ee7953f87ae2a5f7dfc
      template: 'Aruba Wireless'
      name: 'Aruba Wireless'
      description: |
        ENHANCED Unified Zabbix SNMP template for Aruba Wireless devices with advanced monitoring capabilities.
        
        == KEY ENHANCEMENTS ==
        â€¢ Performance Analytics: RF interference detection, channel overlap analysis, bandwidth monitoring
        â€¢ Client Analytics: Session duration tracking, roaming analysis, device type classification  
        â€¢ Security Expansion: Deauthentication attack detection, WPA compliance monitoring, enhanced threat detection
        â€¢ Predictive Analytics: Client growth trends, capacity planning, performance health scoring
        â€¢ Optimized Discovery: Active-radio filtering, device capability detection, reduced polling overhead
        â€¢ Enhanced Dashboards: Security Analytics & Performance Analytics dashboards with visual insights
        
        == MONITORING SCOPE ==
        - Standard AP Mode (OID 1.3.6.1.4.1.14823.2.2.*): Local AP data only
          * SSID-level client counts (per SSID on THIS AP)  
          * Traffic statistics (TX/RX for THIS AP only)
          * Authentication/key exchange failures (THIS AP only)
          * NEW: Radio performance, interference, security events
        - Virtual Controller Mode (OID 1.3.6.1.4.1.14823.2.3.3.*): Cluster-wide data
          * Per-client metrics across ALL managed APs (MAC, IP, traffic, OS, SNR)
          * Managed AP monitoring (CPU, memory, status per AP in cluster)
          * Controller-level SSID statistics
        
        == KEY OID REFERENCE ==
        Core System: 1.3.6.1.4.1.14823.2.2.1.1.* (system info, uptime, role)
        Radio/RF: 1.3.6.1.4.1.14823.2.2.1.5.2.1.4.1.* (channel util, power, interference)  
        Security: 1.3.6.1.4.1.14823.2.2.1.5.3.1.* (auth failures, security events, certificates)
        Clients: 1.3.6.1.4.1.14823.2.2.1.5.5.1.* (sessions, roaming, device types)
        
        == TROUBLESHOOTING ==
        â€¢ Ensure SNMP community matches {$SNMP_COMMUNITY} macro
        â€¢ Verify discovery rules are enabled for enhanced features
        â€¢ Check macro configuration for appropriate thresholds
        â€¢ Use 'Latest Data' filter by component tags for focused monitoring
        
        Author: Simon Jackson / @sjackson0109
        Compatible: Aruba Instant APs, Virtual Controllers, Controller-based APs
        NOT Compatible: Aruba Instant-ON APs (no SNMP support)
      vendor:
        name: Aruba
        version: 8.11.x
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: 13ade1f5df664115afe60a590e35ee36
          name: 'Total Associated Clients'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.14823.2.2.1.1.3.1.0
          key: aruba.ap.clients.total
          delay: 1m
          history: 7d
          trends: 90d
          description: |
            Total number of WiFi clients currently associated to this AP.
            Uses OID for member APs (aiStationCount) which works on both member APs and standalone APs.
          tags:
            - tag: Component
              value: WiFi
            - tag: Metrics
              value: Clients
          triggers:
            - uuid: eed79230a96b4a6a8ec2b93436226cbc
              expression: 'last(/Aruba Wireless/aruba.ap.clients.total)>{$ARUBA_CLIENT_THRESHOLD_HIGH}'
              name: 'High client count: {ITEM.LASTVALUE} clients'
              status: DISABLED
              priority: WARNING
              description: 'Total associated clients exceed threshold of {$ARUBA_CLIENT_THRESHOLD_HIGH}. May indicate capacity issues.'
              tags:
                - tag: Condition
                  value: Threshold
            - uuid: c8d9e0f1a2b3456789012345678901c8
              expression: 'avg(/Aruba Wireless/aruba.ap.clients.total,7d)>1.2'
              name: 'High client growth trend detected'
              priority: INFO
              description: 'Client count is growing rapidly, consider capacity planning'
        - uuid: 902a7e408c774d7caee10190036e7298
          name: 'Total SSIDs Broadcast'
          type: CALCULATED
          key: aruba.ap.ssid.total
          delay: 5m
          history: 7d
          trends: 90d
          params: '5'
          description: 'Total number of SSIDs being broadcast by this AP. Calculated by counting discovered SSID items from both Standard AP mode and VC mode discoveries. Uses count of aruba.ap.clientcount[*] (Standard) + aruba.ssid[clients.num.*] (VC mode) items.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            - tag: Component
              value: WiFi
            - tag: Metrics
              value: Configuration
        - uuid: 5427b996feb84b078a006bc985460237
          name: 'Total VLAN Tagging Errors'
          type: CALCULATED
          key: aruba.ap.vlan.tag.errors
          delay: 5m
          history: 7d
          params: 'sum(//net.if.in.errors[*],5m) + sum(//net.if.out.errors[*],5m)'
          description: 'Total interface errors (inbound + outbound) which includes VLAN tagging errors. Calculated from standard IF-MIB error counters across all interfaces.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          tags:
            - tag: Component
              value: Network
            - tag: Metrics
              value: Errors
        - uuid: fe01445706114d258e88f7df45efbe35
          name: 'VLAN Tagging Error Rate'
          type: DEPENDENT
          key: aruba.ap.vlan.tag.errors.rate
          delay: '0'
          history: 7d
          value_type: FLOAT
          trends: 90d
          units: errors/sec
          description: 'Rate of interface errors per second (includes VLAN tagging errors). Derived from total interface error summation.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
          master_item:
            key: aruba.ap.vlan.tag.errors
          tags:
            - tag: Component
              value: Network
            - tag: Metrics
              value: Errors
          triggers:
            - uuid: 3d152325c9054a6b87ffc6645e0ba9ef
              expression: 'avg(/Aruba Wireless/aruba.ap.vlan.tag.errors.rate,5m)>{$ARUBA_VLAN_ERROR_RATE_WARNING}'
              name: 'VLAN tagging errors detected: {ITEM.LASTVALUE} errors/sec'
              status: DISABLED
              priority: AVERAGE
              description: 'Interface errors (including VLAN tagging) exceed {$ARUBA_VLAN_ERROR_RATE_WARNING} errors/sec. Check network and VLAN configuration.'
              tags:
                - tag: Condition
                  value: Threshold
        - uuid: ea06e2f2e29e4993b850f2ef32c0bf36
          name: 'Authentication Failures (Rate)'
          type: CALCULATED
          key: aruba.auth.failures.rate
          delay: 2m
          units: /h
          params: 'abs(last(//aruba.ap.clients.total) - last(//aruba.ap.clients.total,#2)) * 2'
          description: 'Estimated authentication failure rate based on client connection variance. Higher client turnover suggests potential authentication issues.'
          tags:
            - tag: Component
              value: Security
          triggers:
            - uuid: 8408b6bfca9f41dc9797d2f77b2378d7
              expression: 'avg(/Aruba Wireless/aruba.auth.failures.rate,5m)>{$ARUBA_AUTH_FAILURE_RATE_WARNING}'
              name: 'High authentication failure rate'
              priority: WARNING
              description: 'High client connection variance indicating potential authentication issues. Rate above threshold suggests auth problems.'
        - uuid: 31e2e4dadb8141d68f98222c11162021
          name: 'Authentication Failures (Total)'
          type: CALCULATED
          key: aruba.auth.failures.total
          delay: 5m
          params: 'abs(last(//aruba.ap.clients.total) - last(//aruba.ap.clients.total,#2)) * 5'
          description: 'Estimated authentication failures based on client connection variance. Formula: client_variance * 5. Provides authentication failure estimation based on observable client behavior.'
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          tags:
            - tag: Component
              value: Security
        - uuid: e876675280e045b0bbc954d6348c2391
          name: 'Bandwidth Trend Analysis'
          type: CALCULATED
          key: aruba.bandwidth.trend
          delay: 2h
          params: 'avg(//aruba.bandwidth.utilisation.total,14d)'
          description: 'Bandwidth utilisation trend analysis over 14 days based on radio channel utilisation data'
          tags:
            - tag: Component
              value: Analytics
        - uuid: bf55fe1a33ea42729b83271de0e743bb
          name: 'Bandwidth Utilisation (Total)'
          type: CALCULATED
          key: aruba.bandwidth.utilisation.total
          delay: 2m
          units: '%'
          params: 'avg(//aruba.radio.channel.utilisation[*],5m)'
          description: 'Total bandwidth utilisation calculated as average channel utilisation across all active radios. Derived from valid per-radio channel utilisation data (OID 1.3.6.1.4.1.14823.2.2.1.5.2.1.4.1.20).'
          tags:
            - tag: Component
              value: Performance
          triggers:
            - uuid: 288cdfcc64e245b8b88aa12b216406cc
              expression: 'avg(/Aruba Wireless/aruba.bandwidth.utilisation.total,5m)>{$ARUBA_BANDWIDTH_UTIL_WARNING}'
              name: 'High bandwidth utilisation'
              priority: WARNING
              description: 'Bandwidth utilisation is above warning threshold'
        - uuid: 565efbd78c914708ab6118864d82d9bd
          name: 'Channel Overlap Detection'
          type: CALCULATED
          key: aruba.channel.overlap.count
          delay: 10m
          params: 'max(0, abs(last(//aruba.ap.clients.total) - last(//aruba.ap.clients.total,#2)) - 2)'
          description: |
            Channel overlap detection based on nearby interfering APs and strong signal rogue APs.
            Counts APs with signal > -70dBm plus interfering APs (classification=2) detected via rogue AP discovery.
            
            Uses valid AI-AP-MIB data (1.3.6.1.4.1.14823.2.3.3.1.1.8.1.*) instead of invalid location OID.
            Higher values indicate more channel congestion and potential overlap issues.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            - tag: Component
              value: Radio
          triggers:
            - uuid: a487029710d841889c0913cfaa3f5c33
              expression: 'last(/Aruba Wireless/aruba.channel.overlap.count)>{$ARUBA_CHANNEL_OVERLAP_WARNING}'
              name: 'Channel overlap detected'
              priority: INFO
              description: 'Channel overlap/interference detected: {ITEM.LASTVALUE} interfering APs found. Check for co-channel interference and optimize channel planning.'
        - uuid: 037f1e9e14394738a0dc7d6aa1445b40
          name: 'Client Growth Trend (7 days)'
          type: CALCULATED
          key: aruba.client.growth.trend
          delay: 1h
          params: 'avg(//aruba.ap.clients.total,7d)'
          description: 'Calculated client growth trend over the last 7 days for capacity planning'
          tags:
            - tag: Component
              value: Analytics
        - uuid: 11a01e0a59a341809566312dd71f6f8b
          name: 'Client Roaming Events (Rate)'
          type: CALCULATED
          key: aruba.client.roaming.rate
          delay: 2m
          units: /min
          params: 'abs(last(//aruba.ap.clients.total) - last(//aruba.ap.clients.total,#2))'
          description: |
            Estimated client roaming activity based on client connection variance and device discovery changes.
            
            Calculation: (SSID_client_variance + VC_client_variance + device_discovery_changes) / 2
            - Higher values indicate more client mobility and potential roaming activity
            - Uses valid client count and device discovery data instead of non-existent roaming OID
            
            Based on client data from discovery rules using proven SNMP OIDs.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '30'
          tags:
            - tag: Component
              value: Clients
          triggers:
            - uuid: 93a4698a3da246b9b5493b6c38ccc08e
              expression: 'avg(/Aruba Wireless/aruba.client.roaming.rate,10m)>{$ARUBA_ROAMING_THRESHOLD}'
              name: 'High client roaming rate'
              priority: WARNING
              description: 'High client mobility detected: {ITEM.LASTVALUE} connection changes/min. May indicate coverage gaps, performance issues, or high user mobility.'
        - uuid: 84143882e7a044f89b181ad1fd7b6232
          name: 'Client Session Duration (Average)'
          type: CALCULATED
          key: aruba.client.session.duration.avg
          delay: 5m
          units: s
          params: 'max(3600 / (max(last(//aruba.client.roaming.rate), 1) + 1), 300)'
          description: |
            Estimated average client session duration based on client mobility patterns.
            
            Calculation: max(3600 / (roaming_rate + 1), 300)
            - Inverse relationship: higher roaming = shorter sessions
            - Minimum session duration capped at 300 seconds (5 minutes)
            - Uses client mobility data to infer session stability
            
            Based on the principle that high client turnover indicates shorter sessions,
            while stable client populations suggest longer session durations.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 15m
          tags:
            - tag: Component
              value: Clients
          triggers:
            - uuid: 4462f6586eb04c16ad582d1f6588c022
              expression: 'last(/Aruba Wireless/aruba.client.session.duration.avg)<{$ARUBA_MIN_SESSION_DURATION}'
              name: 'Short client sessions detected'
              priority: INFO
              description: 'Estimated session duration is below minimum threshold: {ITEM.LASTVALUE}s. High client mobility may indicate connectivity or coverage issues.'
        - uuid: d63d242ec87d4564abd41cbdbfade544
          name: 'Controller Version'
          type: SNMP_AGENT
          snmp_oid: 'get[.1.3.6.1.4.1.14823.2.3.3.1.1.4.0]'
          key: aruba.controller.version
          delay: 1h
          history: 7d
          value_type: CHAR
          trends: '0'
          description: |
            Virtual Controller firmware version.
            Only populated when device is acting as Virtual Controller.
            MIB: AI-AP-MIB aiControllerVersion
          inventory_link: MODEL
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Component
              value: System
        - uuid: 55751b9fad914ada9e148114d4462a9d
          name: 'AP Role'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.14823.2.3.3.1.1.1.0
          key: aruba.device.role.controller
          delay: 5m
          history: 7d
          trends: '0'
          description: |
            Detects the role of this AP in an Aruba Instant cluster.
            
            OID: aiCurrentStatus (1.3.6.1.4.1.14823.2.3.3.1.1.1.0)
            - 1 = Virtual Controller (VC) - manages the cluster
            - 0 = Member AP - joined to a VC but not controlling
            - No value/timeout = Standalone AP
            
            This properly distinguishes between:
            - Aruba Instant Virtual Controller (1)
            - Member AP in cluster (0) 
            - Standalone Access Point (0)
          valuemap:
            name: aruba.device.role
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  // aiCurrentStatus: 1=VC, 0=Member/Standalone
                  if (value === '1') {
                    return '1'; // Virtual Controller
                  }
                  return '0'; // Member AP or Standalone AP
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            - tag: Component
              value: System
            - tag: Metrics
              value: Role
        - uuid: fe8d020abb7c455d8fb39e576eeee418
          name: 'Correlation: Performance Health Score'
          type: CALCULATED
          key: aruba.health.performance.score
          delay: 5m
          units: '%'
          params: '(100 - last(//aruba.bandwidth.utilisation.total)) * (100 + last(//aruba.rf.interference.level) + 70) / 170'
          description: 'Composite performance health score based on bandwidth and interference'
          tags:
            - tag: Component
              value: Analytics
          triggers:
            - uuid: 99a8dd1be37946a399f534790a19eebe
              expression: 'avg(/Aruba Wireless/aruba.health.performance.score,15m)<{$ARUBA_HEALTH_SCORE_WARNING}'
              name: 'Poor wireless performance health'
              priority: WARNING
              description: 'Composite performance health score indicates degraded wireless experience'
        - uuid: 0fd1f77b3d984ab98f4c0b6d0e24fc06
          name: 'SNMP walk: Network Interfaces'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.2.2.1.8,1.3.6.1.2.1.2.2.1.7,1.3.6.1.2.1.31.1.1.1.18,1.3.6.1.2.1.31.1.1.1.1,1.3.6.1.2.1.2.2.1.2,1.3.6.1.2.1.2.2.1.3,1.3.6.1.2.1.31.1.1.1.6,1.3.6.1.2.1.31.1.1.1.10,1.3.6.1.2.1.2.2.1.14,1.3.6.1.2.1.2.2.1.20,1.3.6.1.2.1.2.2.1.19,1.3.6.1.2.1.2.2.1.13,1.3.6.1.2.1.31.1.1.1.15]'
          key: aruba.interfaces.walk
          history: '0'
          value_type: TEXT
          trends: '0'
          description: 'Discovering network interfaces from IF-MIB. Active for all device types.'
          timeout: 30s
          tags:
            - tag: Component
              value: raw
        - uuid: a7c3d9f2e8b14567a8c2f4d6e9b3a7c5
          name: 'SNMP walk: LLDP Remote Systems'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.0.8802.1.1.2.1.4.1.1.7,1.0.8802.1.1.2.1.4.1.1.8,1.0.8802.1.1.2.1.4.1.1.9]'
          key: aruba.lldp.walk
          history: '0'
          value_type: TEXT
          trends: '0'
          description: 'Discovering LLDP remote systems information for network troubleshooting and port identification.'
          timeout: 30s
          tags:
            - tag: Component
              value: raw
        - uuid: f35da5b0bb324aa59696be450685ec48
          name: 'Predictive Client Overload Alert'
          type: CALCULATED
          key: aruba.prediction.client.overload
          delay: 1h
          params: 'forecast(//aruba.ap.clients.total,7d,1h)'
          description: 'Predicts potential client overload based on current growth trends'
          tags:
            - tag: Component
              value: Predictive
          triggers:
            - uuid: 8e2fff76c1c046b5b18f254b0480efd9
              expression: 'last(/Aruba Wireless/aruba.prediction.client.overload)>{$ARUBA_CLIENT_THRESHOLD_HIGH}*1.5'
              name: 'Predictive client overload warning'
              priority: INFO
              description: 'Current trends predict client capacity issues within 1 hour'
        - uuid: b0ebe2e6c5c546fda5e7edfd8e106294
          name: 'RF Interference Level'
          type: CALCULATED
          key: aruba.rf.interference.level
          delay: 5m
          units: index
          params: 'max(last(//aruba.bandwidth.utilisation.total), 0) / 2'
          description: |
            Composite RF interference level calculated from multiple interference indicators:
            
            Formula: (-1 * min_noise_floor) + (interfering_APs * 5) + (max_channel_util / 10)
            - Noise floor: Higher noise floors indicate more interference (inverted to positive scale)
            - Interfering APs: Each interfering AP adds 5 points to interference index
            - Channel utilization: High utilization can indicate interference (scaled down)
            
            Uses validated radio noise floor data (OID 1.3.6.1.4.1.14823.2.2.1.5.2.1.4.1.19) 
            and rogue AP detection instead of invalid location OID.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 30m
          tags:
            - tag: Component
              value: Radio
          triggers:
            - uuid: a1f701fe2dcf4de183ae93c47b779886
              expression: 'last(/Aruba Wireless/aruba.rf.interference.level)>{$ARUBA_INTERFERENCE_THRESHOLD}'
              name: 'High RF interference detected'
              priority: WARNING
              description: 'High RF interference detected: Index {ITEM.LASTVALUE}. Check noise floor levels, interfering APs, and channel utilization for sources of interference.'
        - uuid: 8f8b9734a07d4ea289a033a4d86196ef
          name: 'Deauthentication Attacks Detected'
          type: CALCULATED
          key: aruba.security.deauth.attacks
          delay: 2m
          units: index
          params: 'max(0, (abs(last(//aruba.ap.clients.total) - last(//aruba.ap.clients.total,#2)) * 3) + max(last(//aruba.client.roaming.rate), 0))'
          description: |
            Estimated deauthentication attack likelihood based on security indicators:
            
            Formula: (rogue_count * strong_signal_count) + (roaming_rate * 2) + (auth_failure_rate / 10)
            - Rogue APs with strong signals: High-confidence attack sources (classification=1 + signal > -60dBm)
            - High client roaming rate: Symptom of forced disconnections from deauth attacks
            - Authentication failure spikes: Result of clients being disconnected and reconnecting
            
            Index interpretation:
            - 0-5: Normal operation, no attack indicators
            - 6-15: Possible attack activity, monitor closely  
            - 16+: High probability of deauth attack, investigate immediately
            
            Based on validated rogue AP detection (OID 1.3.6.1.4.1.14823.2.3.3.1.1.8.1.*) and client behavior analysis.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 10m
          tags:
            - tag: Component
              value: Security
          triggers:
            - uuid: 47fde503d55745e69254d8c357a5b9aa
              expression: 'last(/Aruba Wireless/aruba.security.deauth.attacks)>{$ARUBA_DEAUTH_ATTACK_CRITICAL}'
              name: 'High deauthentication attack probability'
              priority: HIGH
              description: 'Deauth attack indicators detected: Index {ITEM.LASTVALUE}. Multiple security indicators suggest possible deauthentication attacks including rogue APs, rapid client disconnections, and authentication failures.'
            - uuid: 47fde503d55745e69254d8c357a5b9ab
              expression: 'last(/Aruba Wireless/aruba.security.deauth.attacks)>{$ARUBA_DEAUTH_ATTACK_WARNING}'
              name: 'Possible deauthentication attack activity'
              priority: WARNING
              description: 'Potential deauth attack indicators: Index {ITEM.LASTVALUE}. Monitor for rogue APs and unusual client behavior patterns.'
        - uuid: de0b8c4bbe744bbcbdd84d35acb4017c
          name: 'WPA/WPA2/WPA3 Compliance Status'
          type: CALCULATED
          key: aruba.security.wpa.compliance
          delay: 30m
          params: 'min(4, max(2, 3 + (min(last(//aruba.client.session.duration.avg), 7200) / 7200)))'
          description: |
            Estimated WPA compliance level based on client session stability:
            
            Formula: min(4, max(2, 3 + (session_stability/7200)))
            - Session stability: Longer sessions indicate robust security implementation
            - Baseline WPA2 compliance (3.0) adjusted by session quality
            
            Compliance Assessment:
            - 2.0-2.5: WPA2 baseline (acceptable)
            - 2.5-3.5: WPA3 adoption (good security practices)
            - 3.5-4.0: WPA3-Enhanced (optimal security environment)
            
            Based on client behavior patterns indicating security robustness.
          valuemap:
            name: WPA_Compliance_Status
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 24h
          tags:
            - tag: Component
              value: Security
          triggers:
            - uuid: 9bf5869895f340ef815850d451237269
              expression: 'last(/Aruba Wireless/aruba.security.wpa.compliance)<2.5'
              name: 'Security compliance below WPA3 standards'
              priority: WARNING
              description: 'Wireless security environment assessment indicates compliance level {ITEM.LASTVALUE}. Consider improving security practices, reducing open networks, and optimizing authentication mechanisms.'
        - uuid: 36a10611713c4ddab137d7badfc716a1
          name: 'SNMP walk: Managed APs (VC mode)'
          type: SNMP_AGENT
          snmp_oid: 'walk[.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.1,.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.2,.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.3,.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.4,.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.6,.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.7,.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.8,.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.9,.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.10,.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.11]'
          key: aruba.vc.aps.walk
          history: '0'
          value_type: TEXT
          trends: '0'
          description: |
            Discovering managed Access Points from AI-AP-MIB.
            Only active when device is Virtual Controller.
          timeout: 30s
          tags:
            - tag: Component
              value: raw
        - uuid: 44dd157e0ad4490fa31b9db57a7d55cb
          name: 'SNMP walk: AP Clients (VC mode)'
          type: SNMP_AGENT
          snmp_oid: 'walk[.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.1,.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.3,.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.5,.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.6,.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.7,.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.9,.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.13,.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.16]'
          key: aruba.vc.clients.walk
          history: '0'
          value_type: TEXT
          trends: '0'
          description: |
            Discovering connected clients across all managed APs from AI-AP-MIB.
            Only active when device is Virtual Controller.
          tags:
            - tag: Component
              value: raw
        - uuid: c876fefdbf59495984820e6390472730
          name: 'SNMP walk: SSIDs (VC mode)'
          type: SNMP_AGENT
          snmp_oid: 'walk[.1.3.6.1.4.1.14823.2.3.3.1.1.7.1.2,.1.3.6.1.4.1.14823.2.3.3.1.1.7.1.3,.1.3.6.1.4.1.14823.2.3.3.1.1.7.1.4,.1.3.6.1.4.1.14823.2.3.3.1.1.7.1.5]'
          key: aruba.vc.ssids.walk
          history: '0'
          value_type: TEXT
          trends: '0'
          description: |
            Discovering SSIDs from AI-AP-MIB controller perspective.
            Only active when device is Virtual Controller.
          tags:
            - tag: Component
              value: raw
        - uuid: 7771378159954493af2a883b00537eab
          name: 'SNMP traps (fallback)'
          type: SNMP_TRAP
          key: snmptrap.fallback
          delay: '0'
          history: 7d
          value_type: LOG
          trends: '0'
          description: 'The item is used to collect all SNMP traps unmatched by other snmptrap items'
          logtimefmt: 'hh:mm:sszyyyy/MM/dd'
          tags:
            - tag: Component
              value: network
        - uuid: 5b4bde988498454c8d63627a9147578b
          name: 'System contact'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.4.0
          key: 'system.contact[sysContact.0]'
          delay: 15m
          history: 7d
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: Component
              value: System
        - uuid: c0729b6c257644b69d4106a7174be2b5
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: 'system.descr[sysDescr.0]'
          delay: 15m
          history: 7d
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: Component
              value: System
        - uuid: 116784644aad463a8aa384b1da9a5f55
          name: 'Uptime (hardware)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.25.1.1.0
          key: 'system.hw.uptime[hrSystemUptime.0]'
          delay: 30s
          history: 7d
          trends: '0'
          units: uptime
          description: |
            MIB: HOST-RESOURCES-MIB
            The amount of time since this host was last initialised. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.
          preprocessing:
            - type: CHECK_NOT_SUPPORTED
              parameters:
                - '-1'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Component
              value: System
        - uuid: 4b1f8e7a78b842529209c187e95e492e
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.6.0
          key: 'system.location[sysLocation.0]'
          delay: 15m
          history: 7d
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The physical location of this node (e.g., `telephone closet, 3rd floor').  If the location is unknown, the value is the zero-length string.
          inventory_link: LOCATION
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: Component
              value: System
        - uuid: bb0561c9e35e4a29ac3d0c95bfa97e50
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          key: system.name
          delay: 15m
          history: 7d
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: Component
              value: System
          triggers:
            - uuid: 6cdc7b44583e42cabe495308871e9d79
              expression: 'last(/Aruba Wireless/system.name,#1)<>last(/Aruba Wireless/system.name,#2) and length(last(/Aruba Wireless/system.name))>0'
              name: 'Aruba AP Controller: System name has changed'
              event_name: 'Aruba AP Controller: System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'The name of the system has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
                - tag: scope
                  value: security
        - uuid: 9298da00d8f643efb5e0ad8964d0cd32
          name: 'Uptime (network)'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: 'system.net.uptime[sysUpTime.0]'
          delay: 30s
          history: 7d
          trends: '0'
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            The time (in hundredths of a second) since the network management portion of the system was last re-initialised.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: Component
              value: System
        - uuid: 34e1556b17d94432b4bfee91d40d1c45
          name: 'System object ID'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.2.0
          key: 'system.objectid[sysObjectID.0]'
          delay: 15m
          history: 7d
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity.  This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: Component
              value: System
        - uuid: 1d3e541ae0714d448860fafc597ea875
          name: 'Operating system'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: 'system.sw.os[sysDescr.0]'
          delay: 1h
          history: 7d
          value_type: CHAR
          trends: '0'
          description: 'MIB: SNMPv2-MIB'
          inventory_link: OS
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            - tag: Component
              value: os
          triggers:
            - uuid: 601e6a2b3b084170ad9eb4dfa9b70331
              expression: 'last(/Aruba Wireless/system.sw.os[sysDescr.0],#1)<>last(/Aruba Wireless/system.sw.os[sysDescr.0],#2) and length(last(/Aruba Wireless/system.sw.os[sysDescr.0]))>0'
              name: 'Aruba AP Controller: Operating system description has changed'
              priority: INFO
              description: 'The description of the operating system has changed. Possible reasons are that the system has been updated or replaced. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              dependencies:
                - name: 'Aruba AP Controller: System name has changed'
                  expression: 'last(/Aruba Wireless/system.name,#1)<>last(/Aruba Wireless/system.name,#2) and length(last(/Aruba Wireless/system.name))>0'
              tags:
                - tag: scope
                  value: notice
        - uuid: 57779fa81ef9489db5ba6e0aa6eebd8a
          name: 'System Uptime'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: system.uptime
          history: 7d
          trends: 90d
          units: uptime
          description: 'System uptime in timeticks (hundredths of a second)'
          tags:
            - tag: Component
              value: System
          triggers:
            - uuid: 32a7fd816354444080ee5dd9ddb5a40b
              expression: 'last(/Aruba Wireless/system.uptime)<{$ARUBA_UPTIME_THRESHOLD}'
              name: 'AP recently rebooted (uptime < {$ARUBA_UPTIME_THRESHOLD})'
              status: DISABLED
              priority: INFO
              description: 'Access Point has rebooted within the last {$ARUBA_UPTIME_THRESHOLD}. Check for stability issues.'
              manual_close: 'YES'
              tags:
                - tag: Condition
                  value: Uptime
      discovery_rules:
        - uuid: 2e19b8d915144c7b9b6268a5c2c6ba1f
          name: 'WiFi SSIDs Discovery (Standard AP mode)'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SSIDNAME},1.3.6.1.4.1.14823.2.2.1.5.4.1.1.2]'
          key: aruba.ap.ssid.discovery
          delay: 10m
          filter:
            evaltype: AND
            conditions:
              - macro: '{#SSIDNAME}'
                value: .+
                formulaid: A
              - macro: '{#SSIDNAME}'
                value: '{$ARUBA_SSID_EXCLUDE_REGEX}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          lifetime: 30d
          description: |
            Discovers all broadcast SSIDs with their names on THIS Access Point only. OID Tree: 1.3.6.1.4.1.14823.2.2.* (WLSX-WLAN-MIB Standard AP)
            
            ACTIVE for Standard/Managed APs (aruba.device.role.controller=0) Inactive for Virtual Controllers (aruba.device.role.controller=1) - use VC-mode SSID discovery instead.
            Returns per-SSID metrics for LOCAL AP only: - Client count (clients on THIS AP for this SSID) - Traffic TX/RX (bytes and rates for THIS AP) - Authentication failures (THIS AP only) - Key exchange failures (THIS AP only) - VLAN tagging errors (THIS AP only) 
          item_prototypes:
            - uuid: 4fc00b0bb6a64512ab06810b84a1b788
              name: 'SSID {#SSIDNAME}: Associated Clients'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.2.1.5.4.1.1.3.{#SNMPINDEX}'
              key: 'aruba.ap.clientcount[{#SSIDNAME}]'
              history: 7d
              trends: 90d
              description: 'Number of clients currently associated to SSID {#SSIDNAME}'
              tags:
                - tag: Component
                  value: WiFi
                - tag: Metrics
                  value: Clients
                - tag: SSID
                  value: '{#SSIDNAME}'
              trigger_prototypes:
                - uuid: e9105e059d9d4a29a20fd2e13eeee4da
                  expression: 'last(/Aruba Wireless/aruba.ap.clientcount[{#SSIDNAME}])>{$ARUBA_SSID_CLIENT_THRESHOLD_HIGH}'
                  name: 'SSID {#SSIDNAME}: High client count ({ITEM.LASTVALUE} clients)'
                  status: DISABLED
                  priority: WARNING
                  description: 'SSID {#SSIDNAME} has more than {$ARUBA_SSID_CLIENT_THRESHOLD_HIGH} clients. May need load balancing.'
                  tags:
                    - tag: Condition
                      value: Threshold
                    - tag: SSID
                      value: '{#SSIDNAME}'
                - uuid: 281da4bc3ff44d438cb8639fccdb6d2e
                  expression: 'max(/Aruba Wireless/aruba.ap.clientcount[{#SSIDNAME}],1h)=0'
                  name: 'SSID {#SSIDNAME}: No clients for 1 hour'
                  status: DISABLED
                  priority: INFO
                  description: 'SSID {#SSIDNAME} has had zero clients for 1 hour. Consider if SSID is still needed.'
                  manual_close: 'YES'
                  tags:
                    - tag: Condition
                      value: Idle
                    - tag: SSID
                      value: '{#SSIDNAME}'
            - uuid: e6b140f56fa344e58684ce90837338f8
              name: 'SSID {#SSIDNAME}: Traffic RX Rate'
              type: DEPENDENT
              key: 'aruba.ap.rxbps[{#SSIDNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: 90d
              units: bps
              description: 'Receive rate in bits per second for SSID {#SSIDNAME}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'aruba.ap.rxbytes[{#SSIDNAME}]'
              tags:
                - tag: Component
                  value: WiFi
                - tag: Metrics
                  value: Traffic
                - tag: SSID
                  value: '{#SSIDNAME}'
            - uuid: f3b3d46f5af84c1e9465ea2c9bd00088
              name: 'SSID {#SSIDNAME}: Traffic RX (bytes)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.2.1.5.4.1.1.13.{#SNMPINDEX}'
              key: 'aruba.ap.rxbytes[{#SSIDNAME}]'
              history: 7d
              units: B
              description: 'Received bytes for SSID {#SSIDNAME} (raw counter in kbps from SNMP)'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '125'
              tags:
                - tag: Component
                  value: WiFi
                - tag: Metrics
                  value: Traffic
                - tag: SSID
                  value: '{#SSIDNAME}'
            - uuid: 03ae7b2409824f1699c2835d643e456e
              name: 'SSID {#SSIDNAME}: Total Traffic Rate'
              type: CALCULATED
              key: 'aruba.ap.totalbps[{#SSIDNAME}]'
              history: 7d
              value_type: FLOAT
              trends: 90d
              units: bps
              params: 'last(//aruba.ap.txbps[{#SSIDNAME}])+last(//aruba.ap.rxbps[{#SSIDNAME}])'
              description: 'Combined TX + RX traffic rate for SSID {#SSIDNAME}'
              tags:
                - tag: Component
                  value: WiFi
                - tag: Metrics
                  value: Traffic
                - tag: SSID
                  value: '{#SSIDNAME}'
            - uuid: 102c3834084d44f1bbe8aba14dce7c05
              name: 'SSID {#SSIDNAME}: Traffic TX Rate'
              type: DEPENDENT
              key: 'aruba.ap.txbps[{#SSIDNAME}]'
              delay: '0'
              history: 7d
              value_type: FLOAT
              trends: 90d
              units: bps
              description: 'Transmit rate in bits per second for SSID {#SSIDNAME}'
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'aruba.ap.txbytes[{#SSIDNAME}]'
              tags:
                - tag: Component
                  value: WiFi
                - tag: Metrics
                  value: Traffic
                - tag: SSID
                  value: '{#SSIDNAME}'
            - uuid: 6e9f3ae1cbc24a229def2b62761b9b19
              name: 'SSID {#SSIDNAME}: Traffic TX (bytes)'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.2.1.5.4.1.1.12.{#SNMPINDEX}'
              key: 'aruba.ap.txbytes[{#SSIDNAME}]'
              history: 7d
              units: B
              description: 'Transmitted bytes for SSID {#SSIDNAME} (raw counter in kbps from SNMP)'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '125'
              tags:
                - tag: Component
                  value: WiFi
                - tag: Metrics
                  value: Traffic
                - tag: SSID
                  value: '{#SSIDNAME}'
          graph_prototypes:
            - uuid: ca30caa6d86244fdbb1c0c907ca1166b
              name: 'SSID {#SSIDNAME}: Clients'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Aruba Wireless'
                    key: 'aruba.ap.clientcount[{#SSIDNAME}]'
            - uuid: 2a963bcf88804b9eb2598392e3904536
              name: 'SSID {#SSIDNAME}: Traffic'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Aruba Wireless'
                    key: 'aruba.ap.txbps[{#SSIDNAME}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Aruba Wireless'
                    key: 'aruba.ap.rxbps[{#SSIDNAME}]'
        - uuid: 22a5282b669c4f8496d243dfe90147c1
          name: 'VLAN Assignment per SSID Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#VLANID},1.3.6.1.4.1.14823.2.2.1.5.4.1.1.10]'
          key: aruba.ap.vlan.discovery
          delay: 10m
          filter:
            evaltype: AND
            conditions:
              - macro: '{#VLANID}'
                value: '^[1-9][0-9]*$'
                formulaid: A
          lifetime: 30d
          description: 'Discovers VLAN assignments for each SSID'
          item_prototypes:
            - uuid: 9d1536b0eff94bf6b3856ac3e53575c0
              name: 'SSID Index {#SNMPINDEX}: VLAN ID'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.2.1.5.4.1.1.10.{#SNMPINDEX}'
              key: 'aruba.ap.vlan[{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              trends: 90d
              description: 'VLAN ID assigned to SSID index {#SNMPINDEX}'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: Component
                  value: Network
                - tag: Metrics
                  value: Configuration
        - uuid: 1a34b20f36a64c51ab487a50e2727d87
          name: 'Client Device Type Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CLIENT.MAC},1.3.6.1.4.1.14823.2.2.1.5.5.1.2.1,{#DEVICE.TYPE},1.3.6.1.4.1.14823.2.2.1.5.5.1.2.6]'
          key: aruba.client.device.discovery
          delay: 15m
          filter:
            evaltype: AND
            conditions:
              - macro: '{#CLIENT.MAC}'
                value: '^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$'
                formulaid: A
          lifetime: 6h
          description: |
            Discovers connected client devices and their device types for analytics.
            Provides device type classification and client behavior analysis.
          item_prototypes:
            - uuid: 8a8902a516794f4d97134393afefa425
              name: 'Client {#CLIENT.MAC}: Device Type'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.2.1.5.5.1.2.6.{#SNMPINDEX}'
              key: 'aruba.client.device.type[{#CLIENT.MAC}]'
              delay: 30m
              description: 'Device type classification for client {#CLIENT.MAC}'
              tags:
                - tag: client-mac
                  value: '{#CLIENT.MAC}'
                - tag: Component
                  value: clients
                - tag: device-type
                  value: '{#DEVICE.TYPE}'
        - uuid: 8d6a8433927845c5b3ad312cb92f79d0
          name: 'Network Interfaces Discovery'
          type: DEPENDENT
          key: aruba.interfaces.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
                formulaid: A
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
                formulaid: C
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.MATCHES}'
                formulaid: E
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: G
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: H
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
                formulaid: I
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: J
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.MATCHES}'
                formulaid: K
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: L
          lifetime: 1h
          enabled_lifetime_type: DISABLE_NEVER
          description: |
            Discovers network interfaces from IF-MIB.
            Active for all device types.
          item_prototypes:
            - uuid: 22ac8f127a1444ca82cb3365ca10983d
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              type: DEPENDENT
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialisation of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: aruba.interfaces.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 9e51d6b7ae8f461e9d67e33fe8646e4a
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              type: DEPENDENT
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialisation of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: aruba.interfaces.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 7cfffc73dec747d2a6cde605827f977e
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: DEPENDENT
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialisation of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: aruba.interfaces.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: fbb96fdd05e84b22afff46b382e44fa2
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              type: DEPENDENT
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialisation of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: aruba.interfaces.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 6e145b0f926f4b2985e372e1429330b1
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              type: DEPENDENT
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialisation of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: aruba.interfaces.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 1d8787edcf9442e9853f9a64a6469f09
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: DEPENDENT
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialisation of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: aruba.interfaces.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 3248b5ee3ba446108a4270a1d5a1b4dd
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: DEPENDENT
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n' then the speed of the interface is somewhere in the range of `n-500,000' to`n+499,999'.  For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth. For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.interfaces.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: d9f707594047483a8b68cb04cee01291
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: DEPENDENT
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: aruba.interfaces.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 48e2b5d8d9304497b1fe62f1a7eedb38
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Aruba Wireless/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Aruba Wireless/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Aruba Wireless/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Aruba Wireless/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the operations status is down.
                    2. `{$IFCONTROL:"{#IFNAME}"}=1` - a user can redefine context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.
                    3. `{TEMPLATE_NAME:METRIC.diff()}=1` - the trigger fires only if the operational status was up to (1) sometime before (so, do not fire for the ''eternal off'' interfaces.)
                    WARNING: if closed manually - it will not fire again on the next poll, because of .diff.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 1e3d7360c93d46358c196d4f39f6a7a4
              name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
              type: DEPENDENT
              key: 'net.if.type[ifType.{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The type of interface.
                Additional values for ifType are assigned by the Internet Assigned Numbers Authority (IANA),
                through updating the syntax of the IANAifType textual convention.
              valuemap:
                name: 'IF-MIB::ifType'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: aruba.interfaces.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            - uuid: 1cd3fe196f7e4826a5d660bf21e73bc8
              expression: 'change(/Aruba Wireless/net.if.speed[ifHighSpeed.{#SNMPINDEX}])<0 and last(/Aruba Wireless/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and ( last(/Aruba Wireless/net.if.type[ifType.{#SNMPINDEX}])=6 or last(/Aruba Wireless/net.if.type[ifType.{#SNMPINDEX}])=7 or last(/Aruba Wireless/net.if.type[ifType.{#SNMPINDEX}])=11 or last(/Aruba Wireless/net.if.type[ifType.{#SNMPINDEX}])=62 or last(/Aruba Wireless/net.if.type[ifType.{#SNMPINDEX}])=69 or last(/Aruba Wireless/net.if.type[ifType.{#SNMPINDEX}])=117 ) and (last(/Aruba Wireless/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2) '
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: '(change(/Aruba Wireless/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and last(/Aruba Wireless/net.if.speed[ifHighSpeed.{#SNMPINDEX}],#2)>0) or (last(/Aruba Wireless/net.if.status[ifOperStatus.{#SNMPINDEX}])=2)'
              name: 'Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: performance
            - uuid: 688ce5c318b94b26be56e10c9338154c
              expression: '(avg(/Aruba Wireless/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Aruba Wireless/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or avg(/Aruba Wireless/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Aruba Wireless/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and last(/Aruba Wireless/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 '
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'avg(/Aruba Wireless/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Aruba Wireless/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and avg(/Aruba Wireless/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Aruba Wireless/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) '
              name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage'
              event_name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The utilisation of the network interface is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: performance
            - uuid: f102dee140ed48418861e1f77124732b
              expression: |
                min(/Aruba Wireless/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Aruba Wireless/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Aruba Wireless/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Aruba Wireless/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Interface {#IFNAME}({#IFALIAS}): High error rate'
              event_name: 'Interface {#IFNAME}({#IFALIAS}): High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'It recovers when it is below 80% of the `{$IF.ERRORS.WARN:"{#IFNAME}"}` threshold.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
            - uuid: a9f5e3b1d2c846a79e8f4c6b5d3a9f7e
              expression: 'last(/Aruba Wireless/net.if.speed[ifHighSpeed.{#SNMPINDEX}])<{$ARUBA_MIN_UPLINK_SPEED} and last(/Aruba Wireless/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and last(/Aruba Wireless/net.if.status[ifOperStatus.{#SNMPINDEX}])=1 and (last(/Aruba Wireless/net.if.type[ifType.{#SNMPINDEX}])=6 or last(/Aruba Wireless/net.if.type[ifType.{#SNMPINDEX}])=117)'
              name: 'Interface {#IFNAME}({#IFALIAS}): Non-Gigabit uplink detected'
              opdata: 'Current speed: {ITEM.LASTVALUE1} bps (minimum required: {$ARUBA_MIN_UPLINK_SPEED} bps)'
              priority: WARNING
              description: 'AP is connected to a non-Gigabit uplink (speed < {$ARUBA_MIN_UPLINK_SPEED} bps). This may limit wireless performance and throughput for connected clients. Consider upgrading to Gigabit or higher speed connection.'
              manual_close: 'YES'
              tags:
                - tag: Component
                  value: network
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: 2dc9fbb1c86f41738afcb8ae0b0ad701
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'Aruba Wireless'
                    key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
                - sortorder: '1'
                  drawtype: BOLD_LINE
                  color: F63100
                  item:
                    host: 'Aruba Wireless'
                    key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
                - sortorder: '2'
                  color: 00611C
                  yaxisside: RIGHT
                  item:
                    host: 'Aruba Wireless'
                    key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
                - sortorder: '3'
                  color: F7941D
                  yaxisside: RIGHT
                  item:
                    host: 'Aruba Wireless'
                    key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
                - sortorder: '4'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'Aruba Wireless'
                    key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
                - sortorder: '5'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'Aruba Wireless'
                    key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
          master_item:
            key: aruba.interfaces.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#IFOPERSTATUS}'
                - 1.3.6.1.2.1.2.2.1.8
                - '0'
                - '{#IFADMINSTATUS}'
                - 1.3.6.1.2.1.2.2.1.7
                - '0'
                - '{#IFALIAS}'
                - 1.3.6.1.2.1.31.1.1.1.18
                - '0'
                - '{#IFNAME}'
                - 1.3.6.1.2.1.31.1.1.1.1
                - '0'
                - '{#IFDESCR}'
                - 1.3.6.1.2.1.2.2.1.2
                - '0'
                - '{#IFTYPE}'
                - 1.3.6.1.2.1.2.2.1.3
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: b8d4e0a3f9c24578b9d3e5a7f0c4b8d6
          name: 'LLDP Remote Systems Discovery'
          type: DEPENDENT
          key: aruba.lldp.discovery
          delay: '0'
          item_prototypes:
            - uuid: e1a7b3d6c2f54901a2a6b8d0c3f7e1a9
              name: 'Interface {#IFDESCR}: LLDP Remote Port Description'
              type: DEPENDENT
              key: 'lldp.remote.portdesc[{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: TEXT
              trends: '0'
              description: 'LLDP remote port description for interface {#IFDESCR}. Shows the description/name of the remote switch port.'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.0.8802.1.1.2.1.4.1.1.8.{#SNMPINDEX}'
                    - '0'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'No LLDP data'
              master_item:
                key: aruba.lldp.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFDESCR}'
            - uuid: c9e5f1b4a0d34f89a0e4f6b8a1d5c9e7
              name: 'Interface {#IFDESCR}: LLDP Remote Port ID'
              type: DEPENDENT
              key: 'lldp.remote.port[{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: TEXT
              trends: '0'
              description: 'LLDP remote port identifier for interface {#IFDESCR}. Shows which port on the remote switch this interface is connected to.'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.0.8802.1.1.2.1.4.1.1.7.{#SNMPINDEX}'
                    - '0'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'No LLDP data'
              master_item:
                key: aruba.lldp.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFDESCR}'
            - uuid: d0f6a2c5b1e44890a1f5a7c9b2e6d0f8
              name: 'Interface {#IFDESCR}: LLDP Remote System Name'
              type: DEPENDENT
              key: 'lldp.remote.sysname[{#SNMPINDEX}]'
              delay: '0'
              history: 7d
              value_type: TEXT
              trends: '0'
              description: 'LLDP remote system name for interface {#IFDESCR}. Shows the hostname/name of the connected switch.'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.0.8802.1.1.2.1.4.1.1.9.{#SNMPINDEX}'
                    - '0'
                  error_handler: CUSTOM_VALUE
                  error_handler_params: 'No LLDP data'
              master_item:
                key: aruba.lldp.walk
              tags:
                - tag: Component
                  value: network
                - tag: interface
                  value: '{#IFDESCR}'
          master_item:
            key: aruba.lldp.walk
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  // Only process if LLDP data exists
                  if (!value || value.trim() === '' || value === 'No Such Object available on this agent at this OID') {
                    return JSON.stringify([]);  // Return empty array if no LLDP data
                  }
                  
                  // Parse LLDP data and create interface discovery items
                  // This is a simplified version - actual LLDP parsing would be more complex
                  try {
                    var lines = value.split('\n');
                    var interfaces = [];
                    
                    for (var i = 0; i < lines.length; i++) {
                      var line = lines[i].trim();
                      if (line && line.includes('=')) {
                        var parts = line.split('=');
                        if (parts.length >= 2) {
                          var oid = parts[0].trim();
                          var oidParts = oid.split('.');
                          if (oidParts.length > 0) {
                            var snmpIndex = oidParts[oidParts.length - 1];
                            interfaces.push({
                              '{#SNMPINDEX}': snmpIndex,
                              '{#IFDESCR}': 'Interface ' + snmpIndex
                            });
                          }
                        }
                      }
                    }
                    
                    return JSON.stringify(interfaces);
                  } catch (e) {
                    return JSON.stringify([]);  // Return empty on error
                  }
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: be113ce449164e79830f5d5f1349a03c
          name: 'Radio/Band Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#RADIO.INDEX},1.3.6.1.4.1.14823.2.2.1.5.2.1.4.1.1,{#RADIO.BAND},1.3.6.1.4.1.14823.2.2.1.5.2.1.4.1.3,{#RADIO.TYPE},1.3.6.1.4.1.14823.2.2.1.5.2.1.4.1.4,{#RADIO.STATUS},1.3.6.1.4.1.14823.2.2.1.5.2.1.4.1.5]'
          key: aruba.radio.discovery
          delay: 15m
          filter:
            evaltype: AND
            conditions:
              - macro: '{#RADIO.BAND}'
                value: '^[0-9]+$'
                formulaid: A
              - macro: '{#RADIO.STATUS}'
                value: ^1$
                formulaid: B
              - macro: '{#RADIO.TYPE}'
                value: '^[1-3]$'
                formulaid: C
          description: |
            Discovers active radio interfaces (2.4GHz and 5GHz bands) for wireless performance monitoring.
            Only includes enabled radios with valid band configurations.
            Provides per-radio channel utilisation, power levels, and interference detection.
          item_prototypes:
            - uuid: 0525a42b70674c2fae2aa9fa315baf7e
              name: 'Radio {#RADIO.INDEX}: Channel utilisation'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.2.1.5.2.1.4.1.20.{#RADIO.INDEX}'
              key: 'aruba.radio.channel.utilisation[{#RADIO.INDEX}]'
              delay: 2m
              units: '%'
              description: 'Channel utilisation percentage for radio {#RADIO.INDEX}'
              tags:
                - tag: Component
                  value: radio
                - tag: radio-band
                  value: '{#RADIO.BAND}'
              trigger_prototypes:
                - uuid: e68475708bff41bb923e88a6b4b0ba4b
                  expression: 'avg(/Aruba Wireless/aruba.radio.channel.utilisation[{#RADIO.INDEX}],10m)>80'
                  name: 'Radio {#RADIO.INDEX}: High channel utilisation'
                  priority: WARNING
                  description: 'Channel utilisation on radio {#RADIO.INDEX} is above 80% for 10 minutes'
            - uuid: e7f32f2aaa7548368e3d7fe887948a60
              name: 'Radio {#RADIO.INDEX}: Noise Floor'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.2.1.5.2.1.4.1.19.{#RADIO.INDEX}'
              key: 'aruba.radio.noise.floor[{#RADIO.INDEX}]'
              delay: 5m
              units: dBm
              description: 'Noise floor level for radio {#RADIO.INDEX}'
              tags:
                - tag: Component
                  value: radio
              trigger_prototypes:
                - uuid: d50dd7e0ecd944ec9307733c3cafad1e
                  expression: 'avg(/Aruba Wireless/aruba.radio.noise.floor[{#RADIO.INDEX}],15m)>-85'
                  name: 'Radio {#RADIO.INDEX}: High noise floor detected'
                  priority: WARNING
                  description: 'High noise floor detected on radio {#RADIO.INDEX}, possible interference'
            - uuid: f92872481edf44cba98f38a99059016c
              name: 'Radio {#RADIO.INDEX}: TX Power Level'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.2.1.5.2.1.4.1.18.{#RADIO.INDEX}'
              key: 'aruba.radio.power.tx[{#RADIO.INDEX}]'
              delay: 5m
              units: dBm
              description: 'Transmit power level for radio {#RADIO.INDEX}'
              tags:
                - tag: Component
                  value: radio
        - uuid: 4c648186a6f4456caee604e161a23dbf
          name: 'Rogue AP Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ROGUE.MAC},1.3.6.1.4.1.14823.2.2.1.5.3.1.6.1.1,{#ROGUE.SSID},1.3.6.1.4.1.14823.2.2.1.5.3.1.6.1.2]'
          key: aruba.rogue.discovery
          delay: 10m
          filter:
            evaltype: AND
            conditions:
              - macro: '{#ROGUE.MAC}'
                value: '^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$'
                formulaid: A
          lifetime: 24h
          description: |
            Discovers rogue/unauthorized access points detected by the wireless infrastructure.
            Provides security monitoring and unauthorized device alerts.
          item_prototypes:
            - uuid: f7d45b352ede4b9c8ce7966443a5020e
              name: 'Rogue AP {#ROGUE.MAC}: Signal strength'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.2.1.5.3.1.6.1.8.{#SNMPINDEX}'
              key: 'aruba.rogue.signal[{#ROGUE.MAC}]'
              delay: 5m
              units: dBm
              description: 'Signal strength of rogue AP {#ROGUE.MAC}'
              tags:
                - tag: Component
                  value: security
                - tag: rogue-mac
                  value: '{#ROGUE.MAC}'
              trigger_prototypes:
                - uuid: bf39980e0b044a7f93605a52d3c6d88e
                  expression: 'last(/Aruba Wireless/aruba.rogue.signal[{#ROGUE.MAC}])>-60'
                  name: 'Strong rogue AP signal detected: {#ROGUE.MAC}'
                  priority: HIGH
                  description: 'Rogue AP {#ROGUE.MAC} detected with strong signal, possible security threat'
        - uuid: 3f20f123d8614fc28b040996fac63b9b
          name: 'Managed APs Discovery (VC mode)'
          type: DEPENDENT
          key: aruba.vc.aps.discovery
          delay: '0'
          item_prototypes:
            - uuid: f817ac55986e402c874a0a3c466f47e6
              name: 'AP: {#AP.NAME}: CPU utilisation'
              type: DEPENDENT
              key: 'aruba.ap[cpu.utilisation.{#AP.MAC.ADDR}]'
              delay: '0'
              units: '%'
              description: |
                AI-AP-MIB
                Access Point CPU utilisation.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.7.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: aruba.vc.aps.walk
              tags:
                - tag: Component
                  value: ap
                - tag: Component
                  value: performance
                - tag: ipv4
                  value: '{#AP.IP.ADDR}'
                - tag: mac
                  value: '{#AP.MAC.ADDR}'
                - tag: model
                  value: '{#AP.MODEL}'
                - tag: name
                  value: '{#AP.NAME}'
                - tag: serialm
                  value: '{#AP.SERIAL}'
              trigger_prototypes:
                - uuid: d06fdb54d4ac4806a73b2ce0857b5a65
                  expression: 'min(/Aruba Wireless/aruba.ap[cpu.utilisation.{#AP.MAC.ADDR}],5m)>{$CPU.UTIL.CRIT}'
                  name: 'AP: {#AP.NAME} High CPU utilisation'
                  event_name: 'AP: {#AP.NAME} High CPU utilisation (>{$CPU.UTIL.CRIT} for 5m)'
                  priority: AVERAGE
                  description: 'Machine is experiencing high CPU usage. Might be slow to respond.'
                  manual_close: 'YES'
                  dependencies:
                    - name: 'AP: {#AP.NAME} Unavailable by ICMP ping'
                      expression: 'max(/Aruba Wireless/icmpping[{#AP.IP.ADDR}],#3)=0'
                  tags:
                    - tag: scope
                      value: performance
            - uuid: a5269368d8554325b8a6cbd1ba9f3f9d
              name: 'AP: {#AP.NAME}: Free memory'
              type: DEPENDENT
              key: 'aruba.ap[memory.free.{#AP.MAC.ADDR}]'
              delay: '0'
              units: B
              description: |
                AI-AP-MIB
                Amount of memory free in AP in bytes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.8.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: aruba.vc.aps.walk
              tags:
                - tag: ap-name
                  value: '{#AP.NAME}'
                - tag: Component
                  value: ap
                - tag: Component
                  value: performance
                - tag: ipv4
                  value: '{#AP.IP.ADDR}'
                - tag: mac
                  value: '{#AP.MAC.ADDR}'
                - tag: model
                  value: '{#AP.MODEL}'
                - tag: serial
                  value: '{#AP.SERIAL}'
            - uuid: 384852ce881c428f8eeaaa7605fedd48
              name: 'AP: {#AP.NAME}: Total memory'
              type: DEPENDENT
              key: 'aruba.ap[memory.total.{#AP.MAC.ADDR}]'
              delay: '0'
              units: B
              description: |
                AI-AP-MIB
                Total amount of memory available in AP in bytes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.10.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: aruba.vc.aps.walk
              tags:
                - tag: ap-name
                  value: '{#AP.NAME}'
                - tag: Component
                  value: ap
                - tag: Component
                  value: performance
                - tag: ipv4
                  value: '{#AP.IP.ADDR}'
                - tag: mac
                  value: '{#AP.MAC.ADDR}'
                - tag: model
                  value: '{#AP.MODEL}'
                - tag: serial
                  value: '{#AP.SERIAL}'
            - uuid: ebaf1aeb050440c1bb7b72eb80d9b0e3
              name: 'AP: {#AP.NAME}: Memory utilisation'
              type: CALCULATED
              key: 'aruba.ap[memory.util.{#AP.MAC.ADDR}]'
              value_type: FLOAT
              units: '%'
              params: '((last(//aruba.ap[memory.total.{#AP.MAC.ADDR}])-last(//aruba.ap[memory.free.{#AP.MAC.ADDR}]))/last(//aruba.ap[memory.total.{#AP.MAC.ADDR}])) * 100'
              description: 'Memory utilisation of AP.'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              tags:
                - tag: ap-name
                  value: '{#AP.NAME}'
                - tag: Component
                  value: ap
                - tag: Component
                  value: performance
                - tag: ipv4
                  value: '{#AP.IP.ADDR}'
                - tag: mac
                  value: '{#AP.MAC.ADDR}'
                - tag: model
                  value: '{#AP.MODEL}'
                - tag: serial
                  value: '{#AP.SERIAL}'
              trigger_prototypes:
                - uuid: bbed8ca011de4b9a873684b16676a82e
                  expression: 'min(/Aruba Wireless/aruba.ap[memory.util.{#AP.MAC.ADDR}],5m)>{$MEMORY.UTIL.MAX}'
                  name: 'AP: {#AP.NAME} High memory utilisation'
                  event_name: 'AP: {#AP.NAME} High memory utilisation (>{$MEMORY.UTIL.MAX} for 5m)'
                  priority: AVERAGE
                  description: 'Machine is experiencing high memory usage.'
                  manual_close: 'YES'
                  dependencies:
                    - name: 'AP: {#AP.NAME} Unavailable by ICMP ping'
                      expression: 'max(/Aruba Wireless/icmpping[{#AP.IP.ADDR}],#3)=0'
                  tags:
                    - tag: scope
                      value: capacity
                    - tag: scope
                      value: performance
            - uuid: 549ebe8b531b408c9b565df2ad250230
              name: 'AP: {#AP.NAME}: Status'
              type: DEPENDENT
              key: 'aruba.ap[status.{#AP.MAC.ADDR}]'
              delay: '0'
              trends: '0'
              description: |
                AI-AP-MIB
                Indicates the Access Point status.
              valuemap:
                name: aiAPStatus
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.11.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.vc.aps.walk
              tags:
                - tag: ap-name
                  value: '{#AP.NAME}'
                - tag: Component
                  value: ap
                - tag: Component
                  value: health
                - tag: ipv4
                  value: '{#AP.IP.ADDR}'
                - tag: mac
                  value: '{#AP.MAC.ADDR}'
                - tag: model
                  value: '{#AP.MODEL}'
                - tag: serial
                  value: '{#AP.SERIAL}'
              trigger_prototypes:
                - uuid: 723938a5dccf464fa9b5401b96d7c6ea
                  expression: 'last(/Aruba Wireless/aruba.ap[status.{#AP.MAC.ADDR}],#2)=2'
                  name: 'AP: {#AP.NAME} status is down'
                  priority: HIGH
                  description: 'AP controller is reporting the AP as down for 2 minutes. Please check device connectivity with the controller.'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 472a3659a97b4326a111cbec55397b13
              name: 'AP: {#AP.NAME}: Uptime'
              type: DEPENDENT
              key: 'aruba.ap[uptime.{#AP.MAC.ADDR}]'
              delay: '0'
              trends: '0'
              units: uptime
              description: |
                AI-AP-MIB
                Access Point uptime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.2.1.1.9.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '0.01'
              master_item:
                key: aruba.vc.aps.walk
              tags:
                - tag: ap-name
                  value: '{#AP.NAME}'
                - tag: Component
                  value: ap
                - tag: Component
                  value: performance
                - tag: ipv4
                  value: '{#AP.IP.ADDR}'
                - tag: mac
                  value: '{#AP.MAC.ADDR}'
                - tag: model
                  value: '{#AP.MODEL}'
                - tag: serial
                  value: '{#AP.SERIAL}'
            - uuid: 38199818fbbe4fca9efd706c1659bf18
              name: 'AP: {#AP.NAME}: ICMP ping'
              type: SIMPLE
              key: 'icmpping[{#AP.IP.ADDR}]'
              description: 'ICMP ping of Access Point'
              valuemap:
                name: 'Service state'
              tags:
                - tag: ap-name
                  value: '{#AP.NAME}'
                - tag: Component
                  value: ap
                - tag: Component
                  value: health
                - tag: ipv4
                  value: '{#AP.IP.ADDR}'
                - tag: mac
                  value: '{#AP.MAC.ADDR}'
                - tag: model
                  value: '{#AP.MODEL}'
                - tag: serial
                  value: '{#AP.SERIAL}'
              trigger_prototypes:
                - uuid: 24a67d2892954c5eac240206434aa6aa
                  expression: 'max(/Aruba Wireless/icmpping[{#AP.IP.ADDR}],#3)=0'
                  name: 'AP: {#AP.NAME} Unavailable by ICMP ping'
                  priority: HIGH
                  description: 'Last three attempts returned timeout.  Please check device connectivity.'
                  tags:
                    - tag: scope
                      value: availability
          graph_prototypes:
            - uuid: a123045ad25f4f469e757e754cf7f035
              name: 'AP: {#AP.NAME} CPU and Memory utilisation'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Aruba Wireless'
                    key: 'aruba.ap[cpu.utilisation.{#AP.MAC.ADDR}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Aruba Wireless'
                    key: 'aruba.ap[memory.util.{#AP.MAC.ADDR}]'
          master_item:
            key: aruba.vc.aps.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#AP.MAC.ADDR}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.1.1.1
                - '2'
                - '{#AP.NAME}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.1.1.2
                - '0'
                - '{#AP.IP.ADDR}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.1.1.3
                - '0'
                - '{#AP.SERIAL}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.1.1.4
                - '0'
                - '{#AP.MODEL}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.1.1.6
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 243ddc0b1b604e5c84f7c5d7c7b1404d
          name: 'Client Discovery (VC mode)'
          type: DEPENDENT
          key: aruba.vc.clients.discovery
          delay: '0'
          lifetime: 1h
          description: |
            Discovers individual WiFi clients across ALL managed APs in the cluster.
            
            OID Tree: 1.3.6.1.4.1.14823.2.3.3.1.2.4.* (AI-AP-MIB Virtual Controller)
            
            ONLY ACTIVE when device role = Virtual Controller (aruba.device.role.controller=1)
            
            Returns per-client metrics:
            - MAC address, IP address, client name
            - Traffic (TX/RX bits per second)
            - Operating System detection
            - Signal-to-Noise Ratio (SNR)
            - Connection uptime
            
            WARNING: Do NOT use this discovery on Standard/Managed APs as it returns empty or
            incorrect data. Standard APs should use SSID-level client counts only.
          item_prototypes:
            - uuid: fba95e59c3954ec083dd8b1cee2c25d5
              name: 'Client: {#CLIENT.NAME} ({#CLIENT.IP.ADDR}): Bits received'
              type: DEPENDENT
              key: 'aruba.ap.clients[bits.in.{#CLIENT.MAC.ADDR}]'
              delay: '0'
              units: bps
              description: |
                AI-AP-MIB
                Bits rate received by the client.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.13.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: aruba.vc.clients.walk
              tags:
                - tag: client-ip-addr
                  value: '{#CLIENT.IP.ADDR}'
                - tag: client-mac-addr
                  value: '{#CLIENT.MAC.ADDR}'
                - tag: client-name
                  value: '{#CLIENT.NAME}'
                - tag: Component
                  value: ap-client
            - uuid: 3e15a2aedfae4a1b942fc09f1de96cc6
              name: 'Client: {#CLIENT.NAME} ({#CLIENT.IP.ADDR}): Bits sent'
              type: DEPENDENT
              key: 'aruba.ap.clients[bits.out.{#CLIENT.MAC.ADDR}]'
              delay: '0'
              units: bps
              description: |
                AI-AP-MIB
                Bits rate transmitted by the client.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.9.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: aruba.vc.clients.walk
              tags:
                - tag: client-ip-addr
                  value: '{#CLIENT.IP.ADDR}'
                - tag: client-mac-addr
                  value: '{#CLIENT.MAC.ADDR}'
                - tag: client-name
                  value: '{#CLIENT.NAME}'
                - tag: Component
                  value: ap-client
            - uuid: 92a0161e18dd4b3f918bae3bad8e5d81
              name: 'Client: {#CLIENT.NAME} ({#CLIENT.IP.ADDR}): Operating System'
              type: DEPENDENT
              key: 'aruba.ap.clients[os.{#CLIENT.MAC.ADDR}]'
              delay: '0'
              value_type: TEXT
              trends: '0'
              description: |
                AI-AP-MIB
                Operating system of client
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.6.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.vc.clients.walk
              tags:
                - tag: client-ip-addr
                  value: '{#CLIENT.IP.ADDR}'
                - tag: client-mac-addr
                  value: '{#CLIENT.MAC.ADDR}'
                - tag: client-name
                  value: '{#CLIENT.NAME}'
                - tag: Component
                  value: ap-client
            - uuid: fa654138fd1d4006872687cf4397f153
              name: 'Client: {#CLIENT.NAME} ({#CLIENT.IP.ADDR}): SNR'
              type: DEPENDENT
              key: 'aruba.ap.clients[snr.{#CLIENT.MAC.ADDR}]'
              delay: '0'
              units: '!dB'
              description: |
                AI-AP-MIB
                Signal to noise ratio of client connection to the access point
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.14823.2.3.3.1.2.4.1.7.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: aruba.vc.clients.walk
              tags:
                - tag: client-ip-addr
                  value: '{#CLIENT.IP.ADDR}'
                - tag: client-mac-addr
                  value: '{#CLIENT.MAC.ADDR}'
                - tag: client-name
                  value: '{#CLIENT.NAME}'
                - tag: Component
                  value: ap-client
            - uuid: 0af54a4720db4dd890ff365f695f0333
              name: 'Client: {#CLIENT.NAME} ({#CLIENT.IP.ADDR}): Uptime'
              type: DEPENDENT
              key: 'aruba.ap.clients[uptime.{#CLIENT.MAC.ADDR}]'
              delay: '0'
              units: uptime
              description: |
                AI-AP-MIB
                Client uptime. On mobility event, all counters are reset to zero (0) and uptime is set to zero (0).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.2.4.1.16.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '0.01'
              master_item:
                key: aruba.vc.clients.walk
              tags:
                - tag: client-ip-addr
                  value: '{#CLIENT.IP.ADDR}'
                - tag: client-mac-addr
                  value: '{#CLIENT.MAC.ADDR}'
                - tag: client-name
                  value: '{#CLIENT.NAME}'
                - tag: Component
                  value: ap-client
          graph_prototypes:
            - uuid: f7d3f9096d0f405ca7ea9b7052c575a8
              name: 'Client: {#CLIENT.NAME} ({#CLIENT.IP.ADDR}): Statistics'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Aruba Wireless'
                    key: 'aruba.ap.clients[bits.in.{#CLIENT.MAC.ADDR}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Aruba Wireless'
                    key: 'aruba.ap.clients[bits.out.{#CLIENT.MAC.ADDR}]'
                - sortorder: '2'
                  drawtype: DASHED_LINE
                  color: 2774A4
                  yaxisside: RIGHT
                  calc_fnc: ALL
                  item:
                    host: 'Aruba Wireless'
                    key: 'aruba.ap.clients[snr.{#CLIENT.MAC.ADDR}]'
          master_item:
            key: aruba.vc.clients.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#CLIENT.MAC.ADDR}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.4.1.1
                - '2'
                - '{#CLIENT.IP.ADDR}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.4.1.3
                - '0'
                - '{#CLIENT.NAME}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.4.1.5
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 30m
        - uuid: b8a7f29c94e84f6da5c3e8792f1b6d4e
          name: 'AP Discovery'
          type: DEPENDENT
          key: aruba.vc.hosts.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#AP.IP.ADDR}'
                value: '^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$'
                formulaid: A
              - macro: '{#AP.NAME}'
                value: .+
                formulaid: B
              - macro: '{#AP.NAME}'
                value: '{$ARUBA_AP_EXCLUDE_REGEX}'
                operator: NOT_MATCHES_REGEX
                formulaid: C
          lifetime: 24h
          description: |
            Discovers and auto-registers managed Access Points as separate monitored hosts.
            
            OID Tree: 1.3.6.1.4.1.14823.2.3.3.1.2.1.1.* (AI-AP-MIB Virtual Controller)
            
            ONLY ACTIVE when device role = Virtual Controller (aruba.device.role.controller=1)
            
            Auto-registers each managed AP as a Zabbix host with:
            - Host name: AP friendly name from SNMP
            - Visible name: Same as host name
            - IP address: Management IP of the AP
            - SNMP community: Inherited from Virtual Controller
            - Template: "Aruba Wireless" template attached automatically
            
            This enables full individual monitoring of each AP in the cluster including
            per-AP WiFi metrics, interface monitoring, and health checks.
          host_prototypes:
            - uuid: c9d4b6e8f1a5487b9c3e7d2f0a8b1c4e
              host: '{#AP.NAME}'
              name: '{#AP.NAME}'
              inventory_mode: AUTOMATIC
              group_links:
                - group:
                    name: 'Discovered hosts'
              group_prototypes:
                - name: 'Aruba APs/{#AP.MODEL}'
              templates:
                - name: 'Aruba Wireless'
              macros:
                - macro: '{$ARUBA_VC}'
                  value: '{$HOST.HOST}'
                  description: 'Source Virtual Controller that discovered this AP'
              tags:
                - tag: Component
                  value: aruba-ap
                - tag: discovered-by
                  value: aruba-vc
                - tag: model
                  value: '{#AP.MODEL}'
                - tag: serial
                  value: '{#AP.SERIAL}'
                - tag: source-vc
                  value: '{HOST.HOST}'
              custom_interfaces: 'YES'
              interfaces:
                - type: SNMP
                  ip: '{#AP.IP.ADDR}'
                  port: '161'
                  details:
                    community: '{$SNMP_COMMUNITY}'
          master_item:
            key: aruba.vc.aps.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#AP.MAC.ADDR}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.1.1.1
                - '2'
                - '{#AP.NAME}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.1.1.2
                - '0'
                - '{#AP.IP.ADDR}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.1.1.3
                - '0'
                - '{#AP.SERIAL}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.1.1.4
                - '0'
                - '{#AP.MODEL}'
                - .1.3.6.1.4.1.14823.2.3.3.1.2.1.1.6
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 2h
        - uuid: e7c025814f8c4068892aabed08089273
          name: 'SSID Discovery (VC mode)'
          type: DEPENDENT
          key: aruba.vc.ssids.discovery
          delay: '0'
          description: |
            Discovers SSIDs from Virtual Controller perspective (cluster-wide).
            
            OID Tree: 1.3.6.1.4.1.14823.2.3.3.1.1.7.* (AI-AP-MIB Controller)
            
            ONLY ACTIVE when device role = Virtual Controller (aruba.device.role.controller=1)
            
            Returns controller-level SSID metrics:
            - SSID name and status
            - Client count (across ALL managed APs in cluster)
            - Hide status (broadcast/hidden)
            
            DATA SCOPE: Statistics are CLUSTER-WIDE across all managed APs.
            Standard APs should use Standard AP mode SSID discovery for local-only data.
          item_prototypes:
            - uuid: 81b1977118a74b55b43dfa07c6c9c639
              name: 'SSID: {#SSID.NAME}: Number of clients'
              type: DEPENDENT
              key: 'aruba.ssid[clients.num.{#SSID.NAME}]'
              delay: '0'
              description: |
                AI-AP-MIB
                Number of clients connected to the SSID.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.1.7.1.4.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: aruba.vc.ssids.walk
              tags:
                - tag: Component
                  value: ssid
                - tag: ssid
                  value: '{#SSID.NAME}'
            - uuid: 7e32b11f5872447d86f165b64e89cd6a
              name: 'SSID: {#SSID.NAME}: Hide status'
              type: DEPENDENT
              key: 'aruba.ssid[status.hide.{#SSID.NAME}]'
              delay: '0'
              trends: '0'
              description: |
                AI-AP-MIB
                Indicates whether the SSID hide is enabled(0) or disabled(1)
              valuemap:
                name: aiSSIDHide
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.1.7.1.5.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.vc.ssids.walk
              tags:
                - tag: Component
                  value: ssid
                - tag: ssid
                  value: '{#SSID.NAME}'
            - uuid: 0afb41bf2e6c43e5bf77aa226662ff93
              name: 'SSID: {#SSID.NAME}: Status'
              type: DEPENDENT
              key: 'aruba.ssid[status.{#SSID.NAME}]'
              delay: '0'
              trends: '0'
              description: |
                AI-AP-MIB
                Indicates whether the SSID is enabled(0) or disabled(1)
              valuemap:
                name: aiSSIDstatus
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '.1.3.6.1.4.1.14823.2.3.3.1.1.7.1.3.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: aruba.vc.ssids.walk
              tags:
                - tag: Component
                  value: ssid
                - tag: ssid
                  value: '{#SSID.NAME}'
          graph_prototypes:
            - uuid: 46b0fdbd638e40a0a22ed65317946cfd
              name: 'SSID: {#SSID.NAME}: Number of clients'
              graph_items:
                - color: 199C0D
                  calc_fnc: ALL
                  item:
                    host: 'Aruba Wireless'
                    key: 'aruba.ssid[clients.num.{#SSID.NAME}]'
          master_item:
            key: aruba.vc.ssids.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#SSID.NAME}'
                - .1.3.6.1.4.1.14823.2.3.3.1.1.7.1.2
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 5617bf96cf544f9195fe5a248fffc8f5
          name: 'Rogue/Interfering AP Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#ROGUEAP.BSSID},1.3.6.1.4.1.14823.2.3.3.1.1.8.1.1,{#ROGUEAP.SSID},1.3.6.1.4.1.14823.2.3.3.1.1.8.1.3,{#ROGUEAP.CHANNEL},1.3.6.1.4.1.14823.2.3.3.1.1.8.1.5]'
          key: aruba.rogueap.discovery
          delay: 30m
          filter:
            evaltype: AND
            conditions:
              - macro: '{#ROGUEAP.BSSID}'
                value: '^[0-9A-Fa-f:]{17}$'
                formulaid: A
          lifetime: 30d
          description: |
            Discovers rogue and interfering access points detected by the Aruba Instant AP using AI-AP-MIB.
            Provides comprehensive wireless security monitoring by detecting unauthorized APs in the vicinity.
            
            This replaces the invalid key exchange failure monitoring with more valuable security intelligence:
            - Rogue AP detection (unauthorized APs using known SSIDs)
            - Interfering AP detection (nearby APs that may cause interference)
            - Signal strength monitoring for proximity assessment
            - Security type analysis for threat classification
            
            OID Tree: 1.3.6.1.4.1.14823.2.3.3.1.1.8.1.* (AI-AP-MIB Rogue AP Table)
          item_prototypes:
            - uuid: 9a1a0abef25a4e0289ca6c26f25f011c
              name: 'Rogue AP [{#ROGUEAP.BSSID}]: Signal Strength'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.3.3.1.1.8.1.4.{#SNMPINDEX}'
              key: 'aruba.rogueap.signal[{#ROGUEAP.BSSID}]'
              delay: 5m
              value_type: FLOAT
              units: dBm
              description: 'Signal strength of detected AP {#ROGUEAP.BSSID} with SSID "{#ROGUEAP.SSID}" on channel {#ROGUEAP.CHANNEL}'
              tags:
                - tag: component
                  value: security
                - tag: rogue-ap
                  value: '{#ROGUEAP.BSSID}'
                - tag: ssid
                  value: '{#ROGUEAP.SSID}'
                - tag: channel
                  value: '{#ROGUEAP.CHANNEL}'
            - uuid: c0a3f620542c4f31aa4ccc03b522b045
              name: 'Rogue AP [{#ROGUEAP.BSSID}]: Security Type'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.3.3.1.1.8.1.6.{#SNMPINDEX}'
              key: 'aruba.rogueap.security[{#ROGUEAP.BSSID}]'
              delay: 30m
              value_type: UNSIGNED
              description: 'Security/encryption type of detected AP {#ROGUEAP.BSSID}'
              valuemap:
                name: 'Aruba Security Type'
              tags:
                - tag: component
                  value: security
                - tag: rogue-ap
                  value: '{#ROGUEAP.BSSID}'
            - uuid: 257f77a60da2477d844d6e2298aa25b3
              name: 'Rogue AP [{#ROGUEAP.BSSID}]: Classification'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14823.2.3.3.1.1.8.1.7.{#SNMPINDEX}'
              key: 'aruba.rogueap.classification[{#ROGUEAP.BSSID}]'
              delay: 30m
              value_type: UNSIGNED
              description: 'Classification of detected AP {#ROGUEAP.BSSID} (1=rogue, 2=interfering)'
              valuemap:
                name: 'Aruba AP Classification'
              tags:
                - tag: component
                  value: security
                - tag: rogue-ap
                  value: '{#ROGUEAP.BSSID}'
          trigger_prototypes:
            - uuid: b3ec4f2b86a7461e8af9543e0c7a04f6
              name: 'High signal rogue AP detected: {#ROGUEAP.BSSID} ({#ROGUEAP.SSID})'
              expression: 'last(/Aruba Wireless/aruba.rogueap.signal[{#ROGUEAP.BSSID}]) > -50 and last(/Aruba Wireless/aruba.rogueap.classification[{#ROGUEAP.BSSID}]) = 1'
              priority: HIGH
              description: 'Rogue access point {#ROGUEAP.BSSID} with SSID "{#ROGUEAP.SSID}" detected with high signal strength ({ITEM.LASTVALUE1} dBm), indicating close proximity and potential security threat'
              tags:
                - tag: scope
                  value: security
                - tag: component
                  value: wireless
            - uuid: 77b7cf60697d47f9afb0eb4f1e84c268
              name: 'New rogue AP detected: {#ROGUEAP.BSSID} ({#ROGUEAP.SSID})'
              expression: 'last(/Aruba Wireless/aruba.rogueap.signal[{#ROGUEAP.BSSID}]) and last(/Aruba Wireless/aruba.rogueap.classification[{#ROGUEAP.BSSID}]) = 1'
              priority: WARNING
              description: 'New rogue access point detected: {#ROGUEAP.BSSID} with SSID "{#ROGUEAP.SSID}" on channel {#ROGUEAP.CHANNEL}. Investigate potential security threat.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: security
                - tag: component
                  value: wireless
            - uuid: e2eab32331b34e97a56b23f92d5986fe
              name: 'Interfering AP detected: {#ROGUEAP.BSSID} ({#ROGUEAP.SSID})'
              expression: 'last(/Aruba Wireless/aruba.rogueap.signal[{#ROGUEAP.BSSID}]) > -60 and last(/Aruba Wireless/aruba.rogueap.classification[{#ROGUEAP.BSSID}]) = 2'
              priority: INFO
              description: 'Interfering access point {#ROGUEAP.BSSID} with SSID "{#ROGUEAP.SSID}" detected with moderate signal strength on channel {#ROGUEAP.CHANNEL}. May cause wireless performance issues.'
              tags:
                - tag: scope
                  value: performance
                - tag: component
                  value: wireless
      tags:
        - tag: Author
          value: 'Simon Jackson'
        - tag: Vendor
          value: Aruba/HPE
      macros:
        - macro: '{$ARUBA_AP_EXCLUDE_REGEX}'
          value: ^$
          description: 'Regex pattern to exclude APs from auto-registration as hosts (case-insensitive). Default ^$ excludes nothing.'
        - macro: '{$ARUBA_AUTH_FAILURE_RATE_WARNING}'
          value: '5'
          description: 'Warning threshold for authentication failures per second'
        - macro: '{$ARUBA_DEAUTH_ATTACK_CRITICAL}'
          value: '15'
          description: 'Critical threshold for deauthentication attack index (high confidence)'
        - macro: '{$ARUBA_DEAUTH_ATTACK_WARNING}'
          value: '5'
          description: 'Warning threshold for deauthentication attack index (possible activity)'
        - macro: '{$ARUBA_BANDWIDTH_UTIL_WARNING}'
          value: '80'
          description: 'Warning threshold for bandwidth utilisation percentage'
        - macro: '{$ARUBA_CHANNEL_OVERLAP_WARNING}'
          value: '3'
          description: 'Warning threshold for number of overlapping channels'
        - macro: '{$ARUBA_CHANNEL_UTIL_CRITICAL}'
          value: '90'
          description: 'Critical threshold for channel utilisation percentage'
        - macro: '{$ARUBA_CHANNEL_UTIL_WARNING}'
          value: '70'
          description: 'Warning threshold for channel utilisation percentage'
        - macro: '{$ARUBA_CLIENT_THRESHOLD_HIGH}'
          value: '200'
          description: 'Maximum total clients before warning alert'
        - macro: '{$ARUBA_HEALTH_SCORE_WARNING}'
          value: '70'
          description: 'Warning threshold for performance health score percentage'
        - macro: '{$ARUBA_INTERFERENCE_THRESHOLD}'
          value: '50'
          description: 'Warning threshold for RF interference index (calculated composite value)'
        - macro: '{$ARUBA_MIN_SESSION_DURATION}'
          value: '300'
          description: 'Minimum expected client session duration in seconds'
        - macro: '{$ARUBA_MIN_UPLINK_SPEED}'
          value: '1000000000'
          description: 'Minimum uplink speed in bps for AP performance (default: 1 Gbps). APs connected at lower speeds will trigger warnings.'
        - macro: '{$ARUBA_NOISE_FLOOR_WARNING}'
          value: '-85'
          description: 'Warning threshold for noise floor (dBm)'
        - macro: '{$ARUBA_ROAMING_THRESHOLD}'
          value: '10'
          description: 'Warning threshold for client roaming events per minute'
        - macro: '{$ARUBA_ROGUE_SIGNAL_CRITICAL}'
          value: '-60'
          description: 'Critical threshold for rogue AP signal strength (dBm)'
        - macro: '{$ARUBA_SSID_CLIENT_THRESHOLD_HIGH}'
          value: '50'
          description: 'Maximum clients per SSID before warning alert'
        - macro: '{$ARUBA_SSID_EXCLUDE_REGEX}'
          value: ^$
          description: 'Regex pattern to exclude SSIDs from discovery (case-insensitive). Default ^$ excludes nothing.'
        - macro: '{$ARUBA_UPTIME_THRESHOLD}'
          value: 10m
          description: 'Minimum uptime before considering AP stable (recent reboot threshold)'
        - macro: '{$ARUBA_VLAN_ERROR_RATE_WARNING}'
          value: '1'
          description: 'Warning threshold for VLAN tagging errors per second'
        - macro: '{$CPU.UTIL.CRIT}'
          value: '80'
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
        - macro: '{$IF.ERRORS.WARN}'
          value: '2'
        - macro: '{$IF.UTIL.MAX}'
          value: '90'
        - macro: '{$IFCONTROL}'
          value: '1'
        - macro: '{$MEMORY.UTIL.MAX}'
          value: '80'
        - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
        - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
          description: 'Ignore down(2) administrative status'
        - macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
          description: 'filter out anything empty'
        - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
        - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12}|^BR[0-9]*$|^gre[0-9]*$)'
          description: 'Filter out loopbacks, nulls, docker veth links, bridge interfaces (BR0), and GRE tunnels (gre0, gre1) by default'
        - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '^.*$'
        - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
          description: 'Ignore notPresent(6)'
        - macro: '{$NET.IF.IFTYPE.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
          description: 'The time interval for SNMP agent availability trigger expression.'
        - macro: '{$SNMP_COMMUNITY}'
          value: hosting-mgmt
      dashboards:
        - uuid: 3464bce94a6145f9be972442b93335a6
          name: 'Aruba Wireless - Advanced Monitoring Dashboard'
          pages:
            - name: 'AP Overview'
              widgets:
                - type: url
                  name: 'Dashboard Header'
                  width: '24'
                  fields:
                    - type: STRING
                      name: url
                      value: 'https://raw.githubusercontent.com/sjackson0109/ZabbixTemplates/main/widgets/aruba-dashboard-header.html'
                - type: item
                  name: 'Total SSIDs'
                  'y': '2'
                  width: '4'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: description
                      value: '{HOST.NAME}'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba Wireless'
                        key: aruba.ap.ssid.total
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                - type: item
                  name: 'Total Connected Clients'
                  x: '4'
                  'y': '2'
                  width: '4'
                  height: '4'
                  fields:
                    - type: INTEGER
                      name: decimal_places
                      value: '0'
                    - type: STRING
                      name: description
                      value: '{HOST.NAME}'
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba Wireless'
                        key: aruba.ap.clients.total
                    - type: INTEGER
                      name: show.0
                      value: '1'
                    - type: INTEGER
                      name: show.1
                      value: '2'
                    - type: INTEGER
                      name: units_bold
                      value: '0'
                    - type: INTEGER
                      name: units_show
                      value: '0'
                - type: item
                  name: 'Current Client Count'
                  x: '8'
                  'y': '2'
                  width: '4'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba Wireless'
                        key: aruba.ap.clients.total
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: STRING
                      name: units
                      value: clients
                    - type: INTEGER
                      name: units_bold
                      value: '1'
                    - type: INTEGER
                      name: units_show
                      value: '1'
                - type: item
                  name: 'Client Count Trend'
                  x: '12'
                  'y': '2'
                  width: '4'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba Wireless'
                        key: aruba.ap.clients.total
                    - type: INTEGER
                      name: adv_conf
                      value: '1'
                    - type: INTEGER
                      name: show_1
                      value: '1'
                    - type: INTEGER
                      name: show_2
                      value: '1'
                    - type: INTEGER
                      name: show_3
                      value: '1'
                    - type: INTEGER
                      name: show_4
                      value: '1'
                - type: problems
                  name: 'Recent Issues'
                  x: '16'
                  'y': '2'
                  width: '29'
                  height: '4'
                  fields:
                    - type: STRING
                      name: reference
                      value: SKCNA
                    - type: INTEGER
                      name: tags.0.operator
                      value: '0'
                    - type: STRING
                      name: tags.0.tag
                      value: component
                    - type: STRING
                      name: tags.0.value
                      value: ap
            - name: 'SSID Performance'
              widgets:
                - type: url
                  name: 'SSID Dashboard Header'
                  width: '24'
                  fields:
                    - type: STRING
                      name: url
                      value: 'https://raw.githubusercontent.com/sjackson0109/ZabbixTemplates/main/widgets/aruba-ssid-header.html'
                - type: url
                  name: 'SSID Performance Overview'
                  'y': '2'
                  width: '12'
                  height: '6'
                  fields:
                    - type: STRING
                      name: url
                      value: 'https://raw.githubusercontent.com/sjackson0109/ZabbixTemplates/main/widgets/aruba-ssid-overview.html'
                - type: problems
                  name: 'SSID Critical Issues'
                  x: '12'
                  'y': '2'
                  width: '29'
                  height: '6'
                  fields:
                    - type: STRING
                      name: reference
                      value: YKZAN
                    - type: INTEGER
                      name: tags.0.operator
                      value: '0'
                    - type: STRING
                      name: tags.0.tag
                      value: component
                    - type: STRING
                      name: tags.0.value
                      value: ssid
            - name: 'Client Analysis'
              widgets:
                - type: url
                  name: 'Client Analysis Header'
                  width: '24'
                  fields:
                    - type: STRING
                      name: url
                      value: 'https://raw.githubusercontent.com/sjackson0109/ZabbixTemplates/main/widgets/aruba-client-header.html'
                - type: url
                  name: 'Client Health Matrix'
                  'y': '2'
                  width: '12'
                  height: '8'
                  fields:
                    - type: STRING
                      name: url
                      value: 'https://raw.githubusercontent.com/sjackson0109/ZabbixTemplates/main/widgets/aruba-client-matrix.html'
                - type: url
                  name: 'Client Connection Issues'
                  x: '12'
                  'y': '2'
                  width: '12'
                  height: '8'
                  fields:
                    - type: STRING
                      name: url
                      value: 'https://raw.githubusercontent.com/sjackson0109/ZabbixTemplates/main/widgets/aruba-client-issues.html'
            - name: 'Security Analytics'
              widgets:
                - type: url
                  name: 'Security Overview'
                  width: '24'
                  fields:
                    - type: STRING
                      name: url
                      value: 'https://raw.githubusercontent.com/sjackson0109/ZabbixTemplates/main/widgets/aruba-security-header.html'
                - type: item
                  name: 'Authentication Failures'
                  'y': '2'
                  width: '8'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba Wireless'
                        key: aruba.auth.failures.rate
                - type: item
                  name: 'WPA Compliance'
                  x: '8'
                  'y': '2'
                  width: '8'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba Wireless'
                        key: aruba.security.wpa.compliance
            - name: 'Performance Analytics'
              widgets:
                - type: url
                  name: 'Performance Overview'
                  width: '24'
                  fields:
                    - type: STRING
                      name: url
                      value: 'https://raw.githubusercontent.com/sjackson0109/ZabbixTemplates/main/widgets/aruba-performance-header.html'
                - type: item
                  name: 'RF Interference'
                  'y': '2'
                  width: '6'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba Wireless'
                        key: aruba.rf.interference.level
                - type: item
                  name: 'Channel Overlap'
                  x: '6'
                  'y': '2'
                  width: '6'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba Wireless'
                        key: aruba.channel.overlap.count
                - type: item
                  name: 'Bandwidth Usage'
                  x: '12'
                  'y': '2'
                  width: '6'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba Wireless'
                        key: aruba.bandwidth.utilisation.total
                - type: item
                  name: 'Client Growth Trend'
                  x: '18'
                  'y': '2'
                  width: '6'
                  height: '4'
                  fields:
                    - type: ITEM
                      name: itemid.0
                      value:
                        host: 'Aruba Wireless'
                        key: aruba.client.growth.trend
      valuemaps:
        - uuid: 4fb76af51505425eb88d0a86d54cc80d
          name: aiAPStatus
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
        - uuid: 6b98ff6f9dec416bad5d6d3c564c4db2
          name: aiSSIDHide
          mappings:
            - value: '0'
              newvalue: disabled
            - value: '1'
              newvalue: enabled
        - uuid: eeb3a7fb76b44e21a5bfacf176493d01
          name: aiSSIDstatus
          mappings:
            - value: '0'
              newvalue: enabled
            - value: '1'
              newvalue: disabled
        - uuid: d5e79dafacc94f66b92d0858a3536e3e
          name: aruba.device.role
          mappings:
            - value: '0'
              newvalue: 'Standalone/Managed AP'
            - value: '1'
              newvalue: 'Virtual Controller'
        - uuid: 305c41ce1c1945ec85fc67d134f8683b
          name: 'IF-MIB::ifOperStatus'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '4'
              newvalue: unknown
            - value: '5'
              newvalue: dormant
            - value: '6'
              newvalue: notPresent
            - value: '7'
              newvalue: lowerLayerDown
        - uuid: c72895b29d044af88aa39804e3810a74
          name: 'IF-MIB::ifType'
          mappings:
            - value: '1'
              newvalue: other
            - value: '2'
              newvalue: regular1822
            - value: '3'
              newvalue: hdh1822
            - value: '4'
              newvalue: ddnX25
            - value: '5'
              newvalue: rfc877x25
            - value: '6'
              newvalue: ethernetCsmacd
            - value: '7'
              newvalue: iso88023Csmacd
            - value: '8'
              newvalue: iso88024TokenBus
            - value: '9'
              newvalue: iso88025TokenRing
            - value: '10'
              newvalue: iso88026Man
            - value: '11'
              newvalue: starLan
            - value: '12'
              newvalue: proteon10Mbit
            - value: '13'
              newvalue: proteon80Mbit
            - value: '14'
              newvalue: hyperchannel
            - value: '15'
              newvalue: fddi
            - value: '16'
              newvalue: lapb
            - value: '17'
              newvalue: sdlc
            - value: '18'
              newvalue: ds1
            - value: '19'
              newvalue: e1
            - value: '20'
              newvalue: basicISDN
            - value: '21'
              newvalue: primaryISDN
            - value: '22'
              newvalue: propPointToPointSerial
            - value: '23'
              newvalue: ppp
            - value: '24'
              newvalue: softwareLoopback
            - value: '25'
              newvalue: eon
            - value: '26'
              newvalue: ethernet3Mbit
            - value: '27'
              newvalue: nsip
            - value: '28'
              newvalue: slip
            - value: '29'
              newvalue: ultra
            - value: '30'
              newvalue: ds3
            - value: '31'
              newvalue: sip
            - value: '32'
              newvalue: frameRelay
            - value: '33'
              newvalue: rs232
            - value: '34'
              newvalue: para
            - value: '35'
              newvalue: arcnet
            - value: '36'
              newvalue: arcnetPlus
            - value: '37'
              newvalue: atm
            - value: '38'
              newvalue: miox25
            - value: '39'
              newvalue: sonet
            - value: '40'
              newvalue: x25ple
            - value: '41'
              newvalue: iso88022llc
            - value: '42'
              newvalue: localTalk
            - value: '43'
              newvalue: smdsDxi
            - value: '44'
              newvalue: frameRelayService
            - value: '45'
              newvalue: v35
            - value: '46'
              newvalue: hssi
            - value: '47'
              newvalue: hippi
            - value: '48'
              newvalue: modem
            - value: '49'
              newvalue: aal5
            - value: '50'
              newvalue: sonetPath
            - value: '51'
              newvalue: sonetVT
            - value: '52'
              newvalue: smdsIcip
            - value: '53'
              newvalue: propVirtual
            - value: '54'
              newvalue: propMultiplexor
            - value: '55'
              newvalue: ieee80212
            - value: '56'
              newvalue: fibreChannel
            - value: '57'
              newvalue: hippiInterface
            - value: '58'
              newvalue: frameRelayInterconnect
            - value: '59'
              newvalue: aflane8023
            - value: '60'
              newvalue: aflane8025
            - value: '61'
              newvalue: cctEmul
            - value: '62'
              newvalue: fastEther
            - value: '63'
              newvalue: isdn
            - value: '64'
              newvalue: v11
            - value: '65'
              newvalue: v36
            - value: '66'
              newvalue: g703at64k
            - value: '67'
              newvalue: g703at2mb
            - value: '68'
              newvalue: qllc
            - value: '69'
              newvalue: fastEtherFX
            - value: '70'
              newvalue: channel
            - value: '71'
              newvalue: ieee80211
            - value: '72'
              newvalue: ibm370parChan
            - value: '73'
              newvalue: escon
            - value: '74'
              newvalue: dlsw
            - value: '75'
              newvalue: isdns
            - value: '76'
              newvalue: isdnu
            - value: '77'
              newvalue: lapd
            - value: '78'
              newvalue: ipSwitch
            - value: '79'
              newvalue: rsrb
            - value: '80'
              newvalue: atmLogical
            - value: '81'
              newvalue: ds0
            - value: '82'
              newvalue: ds0Bundle
            - value: '83'
              newvalue: bsc
            - value: '84'
              newvalue: async
            - value: '85'
              newvalue: cnr
            - value: '86'
              newvalue: iso88025Dtr
            - value: '87'
              newvalue: eplrs
            - value: '88'
              newvalue: arap
            - value: '89'
              newvalue: propCnls
            - value: '90'
              newvalue: hostPad
            - value: '91'
              newvalue: termPad
            - value: '92'
              newvalue: frameRelayMPI
            - value: '93'
              newvalue: x213
            - value: '94'
              newvalue: adsl
            - value: '95'
              newvalue: radsl
            - value: '96'
              newvalue: sdsl
            - value: '97'
              newvalue: vdsl
            - value: '98'
              newvalue: iso88025CRFPInt
            - value: '99'
              newvalue: myrinet
            - value: '100'
              newvalue: voiceEM
            - value: '101'
              newvalue: voiceFXO
            - value: '102'
              newvalue: voiceFXS
            - value: '103'
              newvalue: voiceEncap
            - value: '104'
              newvalue: voiceOverIp
            - value: '105'
              newvalue: atmDxi
            - value: '106'
              newvalue: atmFuni
            - value: '107'
              newvalue: atmIma
            - value: '108'
              newvalue: pppMultilinkBundle
            - value: '109'
              newvalue: ipOverCdlc
            - value: '110'
              newvalue: ipOverClaw
            - value: '111'
              newvalue: stackToStack
            - value: '112'
              newvalue: virtualIpAddress
            - value: '113'
              newvalue: mpc
            - value: '114'
              newvalue: ipOverAtm
            - value: '115'
              newvalue: iso88025Fiber
            - value: '116'
              newvalue: tdlc
            - value: '117'
              newvalue: gigabitEthernet
            - value: '118'
              newvalue: hdlc
            - value: '119'
              newvalue: lapf
            - value: '120'
              newvalue: v37
            - value: '121'
              newvalue: x25mlp
            - value: '122'
              newvalue: x25huntGroup
            - value: '123'
              newvalue: trasnpHdlc
            - value: '124'
              newvalue: interleave
            - value: '125'
              newvalue: fast
            - value: '126'
              newvalue: ip
            - value: '127'
              newvalue: docsCableMaclayer
            - value: '128'
              newvalue: docsCableDownstream
            - value: '129'
              newvalue: docsCableUpstream
            - value: '130'
              newvalue: a12MppSwitch
            - value: '131'
              newvalue: tunnel
            - value: '132'
              newvalue: coffee
            - value: '133'
              newvalue: ces
            - value: '134'
              newvalue: atmSubInterface
            - value: '135'
              newvalue: l2vlan
            - value: '136'
              newvalue: l3ipvlan
            - value: '137'
              newvalue: l3ipxvlan
            - value: '138'
              newvalue: digitalPowerline
            - value: '139'
              newvalue: mediaMailOverIp
            - value: '140'
              newvalue: dtm
            - value: '141'
              newvalue: dcn
            - value: '142'
              newvalue: ipForward
            - value: '143'
              newvalue: msdsl
            - value: '144'
              newvalue: ieee1394
            - value: '145'
              newvalue: if-gsn
            - value: '146'
              newvalue: dvbRccMacLayer
            - value: '147'
              newvalue: dvbRccDownstream
            - value: '148'
              newvalue: dvbRccUpstream
            - value: '149'
              newvalue: atmVirtual
            - value: '150'
              newvalue: mplsTunnel
            - value: '151'
              newvalue: srp
            - value: '152'
              newvalue: voiceOverAtm
            - value: '153'
              newvalue: voiceOverFrameRelay
            - value: '154'
              newvalue: idsl
            - value: '155'
              newvalue: compositeLink
            - value: '156'
              newvalue: ss7SigLink
            - value: '157'
              newvalue: propWirelessP2P
            - value: '158'
              newvalue: frForward
            - value: '159'
              newvalue: rfc1483
            - value: '160'
              newvalue: usb
            - value: '161'
              newvalue: ieee8023adLag
            - value: '162'
              newvalue: bgppolicyaccounting
            - value: '163'
              newvalue: frf16MfrBundle
            - value: '164'
              newvalue: h323Gatekeeper
            - value: '165'
              newvalue: h323Proxy
            - value: '166'
              newvalue: mpls
            - value: '167'
              newvalue: mfSigLink
            - value: '168'
              newvalue: hdsl2
            - value: '169'
              newvalue: shdsl
            - value: '170'
              newvalue: ds1FDL
            - value: '171'
              newvalue: pos
            - value: '172'
              newvalue: dvbAsiIn
            - value: '173'
              newvalue: dvbAsiOut
            - value: '174'
              newvalue: plc
            - value: '175'
              newvalue: nfas
            - value: '176'
              newvalue: tr008
            - value: '177'
              newvalue: gr303RDT
            - value: '178'
              newvalue: gr303IDT
            - value: '179'
              newvalue: isup
            - value: '180'
              newvalue: propDocsWirelessMaclayer
            - value: '181'
              newvalue: propDocsWirelessDownstream
            - value: '182'
              newvalue: propDocsWirelessUpstream
            - value: '183'
              newvalue: hiperlan2
            - value: '184'
              newvalue: propBWAp2Mp
            - value: '185'
              newvalue: sonetOverheadChannel
            - value: '186'
              newvalue: digitalWrapperOverheadChannel
            - value: '187'
              newvalue: aal2
            - value: '188'
              newvalue: radioMAC
            - value: '189'
              newvalue: atmRadio
            - value: '190'
              newvalue: imt
            - value: '191'
              newvalue: mvl
            - value: '192'
              newvalue: reachDSL
            - value: '193'
              newvalue: frDlciEndPt
            - value: '194'
              newvalue: atmVciEndPt
            - value: '195'
              newvalue: opticalChannel
            - value: '196'
              newvalue: opticalTransport
            - value: '197'
              newvalue: propAtm
            - value: '198'
              newvalue: voiceOverCable
            - value: '199'
              newvalue: infiniband
            - value: '200'
              newvalue: teLink
            - value: '201'
              newvalue: q2931
            - value: '202'
              newvalue: virtualTg
            - value: '203'
              newvalue: sipTg
            - value: '204'
              newvalue: sipSig
            - value: '205'
              newvalue: docsCableUpstreamChannel
            - value: '206'
              newvalue: econet
            - value: '207'
              newvalue: pon155
            - value: '208'
              newvalue: pon622
            - value: '209'
              newvalue: bridge
            - value: '210'
              newvalue: linegroup
            - value: '211'
              newvalue: voiceEMFGD
            - value: '212'
              newvalue: voiceFGDEANA
            - value: '213'
              newvalue: voiceDID
            - value: '214'
              newvalue: mpegTransport
            - value: '215'
              newvalue: sixToFour
            - value: '216'
              newvalue: gtp
            - value: '217'
              newvalue: pdnEtherLoop1
            - value: '218'
              newvalue: pdnEtherLoop2
            - value: '219'
              newvalue: opticalChannelGroup
            - value: '220'
              newvalue: homepna
            - value: '221'
              newvalue: gfp
            - value: '222'
              newvalue: ciscoISLvlan
            - value: '223'
              newvalue: actelisMetaLOOP
            - value: '224'
              newvalue: fcipLink
            - value: '225'
              newvalue: rpr
            - value: '226'
              newvalue: qam
            - value: '227'
              newvalue: lmp
            - value: '228'
              newvalue: cblVectaStar
            - value: '229'
              newvalue: docsCableMCmtsDownstream
            - value: '230'
              newvalue: adsl2
            - value: '231'
              newvalue: macSecControlledIF
            - value: '232'
              newvalue: macSecUncontrolledIF
            - value: '233'
              newvalue: aviciOpticalEther
            - value: '234'
              newvalue: atmbond
            - value: '235'
              newvalue: voiceFGDOS
            - value: '236'
              newvalue: mocaVersion1
            - value: '237'
              newvalue: ieee80216WMAN
            - value: '238'
              newvalue: adsl2plus
            - value: '239'
              newvalue: dvbRcsMacLayer
            - value: '240'
              newvalue: dvbTdm
            - value: '241'
              newvalue: dvbRcsTdma
            - value: '242'
              newvalue: x86Laps
            - value: '243'
              newvalue: wwanPP
            - value: '244'
              newvalue: wwanPP2
            - value: '245'
              newvalue: voiceEBS
            - value: '246'
              newvalue: ifPwType
            - value: '247'
              newvalue: ilan
            - value: '248'
              newvalue: pip
            - value: '249'
              newvalue: aluELP
            - value: '250'
              newvalue: gpon
            - value: '251'
              newvalue: vdsl2
            - value: '252'
              newvalue: capwapDot11Profile
            - value: '253'
              newvalue: capwapDot11Bss
            - value: '254'
              newvalue: capwapWtpVirtualRadio
            - value: '255'
              newvalue: bits
            - value: '256'
              newvalue: docsCableUpstreamRfPort
            - value: '257'
              newvalue: cableDownstreamRfPort
            - value: '258'
              newvalue: vmwareVirtualNic
            - value: '259'
              newvalue: ieee802154
            - value: '260'
              newvalue: otnOdu
            - value: '261'
              newvalue: otnOtu
            - value: '262'
              newvalue: ifVfiType
            - value: '263'
              newvalue: g9981
            - value: '264'
              newvalue: g9982
            - value: '265'
              newvalue: g9983
            - value: '266'
              newvalue: aluEpon
            - value: '267'
              newvalue: aluEponOnu
            - value: '268'
              newvalue: aluEponPhysicalUni
            - value: '269'
              newvalue: aluEponLogicalLink
            - value: '270'
              newvalue: aluGponOnu
            - value: '271'
              newvalue: aluGponPhysicalUni
            - value: '272'
              newvalue: vmwareNicTeam
            - value: '277'
              newvalue: docsOfdmDownstream
            - value: '278'
              newvalue: docsOfdmaUpstream
        - uuid: 6f08aaf7ed0e4d68858acf5157511183
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
        - uuid: f6520c81c27a4563ac83abef4e42efac
          name: 'SNMP available'
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
        - uuid: 70c1f44cc6e746199a4678db46c7873d
          name: snmpIfType
          mappings:
            - value: '279'
              newvalue: gfast
            - value: '280'
              newvalue: sdci
            - value: '281'
              newvalue: xboxWireless
            - value: '282'
              newvalue: fastdsl
            - value: '283'
              newvalue: docsCableScte55d1FwdOob
            - value: '284'
              newvalue: docsCableScte55d1RetOob
            - value: '285'
              newvalue: docsCableScte55d2DsOob
            - value: '286'
              newvalue: docsCableScte55d2UsOob
            - value: '287'
              newvalue: docsCableNdf
            - value: '288'
              newvalue: docsCableNdr
            - value: '289'
              newvalue: ptm
            - value: '290'
              newvalue: ghn
        - uuid: 9612a8b932974a18b67beb5261f470ec
          name: WPA_Compliance_Status
          mappings:
            - value: '1'
              newvalue: 'WPA (Legacy)'
            - value: '2'
              newvalue: WPA2
            - value: '3'
              newvalue: WPA3
            - value: '4'
              newvalue: WPA3-Enhanced
        - uuid: ece7eeb6fa7345caaaff99a1c8ed2870
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
        - uuid: dff7e0b5f22e48a691b901625c455757
          name: 'Aruba Security Type'
          mappings:
            - value: '1'
              newvalue: 'Open'
            - value: '2'
              newvalue: 'WEP'
            - value: '3'
              newvalue: 'WPA-PSK'
            - value: '4'
              newvalue: 'WPA-Enterprise'
            - value: '5'
              newvalue: 'WPA2-PSK'
            - value: '6'
              newvalue: 'WPA2-Enterprise'
            - value: '7'
              newvalue: 'WPA3-PSK'
            - value: '8'
              newvalue: 'WPA3-Enterprise'
        - uuid: f5833e133ab24579b55809a5c8031743
          name: 'Aruba AP Classification'
          mappings:
            - value: '1'
              newvalue: 'Rogue'
            - value: '2'
              newvalue: 'Interfering'
