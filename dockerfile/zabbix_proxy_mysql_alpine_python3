FROM zabbix/zabbix-proxy-mysql:alpine-7.0-latest

# Switch to root to install additional packages
USER root

# Install Python 3, pip, and necessary build dependencies
RUN apk add --no-cache python3 py3-pip

# Install Python libraries
RUN pip3 install --break-system-packages \
    requests \
    urllib3 \
    py-zabbix \
    pycryptodome

# Verify installation
RUN python3 --version && \
    pip3 --version && \
    python3 -m pip show requests && \
    python3 -m pip show urllib3 && \
    python3 -m pip show py-zabbix && \
    python3 -m pip show pycryptodome

# Switch back to the default user
USER zabbix